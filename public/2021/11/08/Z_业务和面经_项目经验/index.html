<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>项目经验 | Hexo</title>
  <meta name="description" content="项目经验搜索github上优秀的javascript 项目 项目可以是商城、SCRM 系统、OA 系统、物流系统、ERP 系统、CMS 系统、HIS 系统、支付系统、IM 聊天、微信公众号、微信小程序等等。 PSP产品选型基于运营商BG（carrier network business group）产品360平台，在地区部代表处运营商不同区域下，按照不同产品线无限数通光划分，对不同产品按照不同维度">
<meta property="og:type" content="article">
<meta property="og:title" content="项目经验">
<meta property="og:url" content="https://fuyunjinglong.github.io/2021/11/08/Z_%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F_%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="项目经验搜索github上优秀的javascript 项目 项目可以是商城、SCRM 系统、OA 系统、物流系统、ERP 系统、CMS 系统、HIS 系统、支付系统、IM 聊天、微信公众号、微信小程序等等。 PSP产品选型基于运营商BG（carrier network business group）产品360平台，在地区部代表处运营商不同区域下，按照不同产品线无限数通光划分，对不同产品按照不同维度">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://fuyunjinglong.github.io/img/image-20230614065329214.png">
<meta property="og:image" content="https://fuyunjinglong.github.io/img/image-20230614065430330.png">
<meta property="article:published_time" content="2021-11-07T22:33:16.000Z">
<meta property="article:modified_time" content="2024-03-06T23:08:28.736Z">
<meta property="article:author" content="Elven">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fuyunjinglong.github.io/img/image-20230614065329214.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://fuyunjinglong.github.io/2021/11/08/Z_%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F_%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 5.4.2"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://fuyunjinglong.github.io/" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Elven</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Web Developer &amp; Designer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Shenzhen, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/fuyunjinglong" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://fuyunjinglong.github.io/" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/null" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AA-%E9%9D%A2%E8%AF%95/">AA_面试</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/A-%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/">A_编码规范</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/B-JS/">B_JS</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-H5%E5%92%8CCSS/">C_H5和CSS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/D-%E6%A1%86%E6%9E%B6%E5%92%8C%E7%B1%BB%E5%BA%93/">D_框架和类库</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/E-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">E_数据结构</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/F-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">F_计算机网络</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/H-%E5%B7%A5%E7%A8%8B%E7%83%AD%E7%82%B9/">H_工程热点</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/I-%E7%A7%BB%E5%8A%A8%E7%AB%AF/">I_移动端</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/J-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">J_设计模式</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Z-%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F/">Z_业务和面经</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


    
      

    
      
    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2099/11/">十一月 2099</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2099/09/">九月 2099</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2099/06/">六月 2099</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2099/05/">五月 2099</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2099/03/">三月 2099</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">五月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/H-%E5%B7%A5%E7%A8%8B%E7%83%AD%E7%82%B9/">H_工程热点</a>
              </p>
              <p class="item-title">
                <a href="/2099/11/06/H_%E5%B7%A5%E7%A8%8B%E7%83%AD%E7%82%B9_0%E5%9F%BA%E7%A1%80/" class="title">0基础_工程热点</a>
              </p>
              <p class="item-date">
                <time datetime="2099-11-05T22:33:16.000Z" itemprop="datePublished">2099-11-06</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/I-%E7%A7%BB%E5%8A%A8%E7%AB%AF/">I_移动端</a>
              </p>
              <p class="item-title">
                <a href="/2099/11/05/I_%E7%A7%BB%E5%8A%A8%E7%AB%AF_0%E5%9F%BA%E7%A1%80/" class="title">0基础_移动端</a>
              </p>
              <p class="item-date">
                <time datetime="2099-11-04T22:33:16.000Z" itemprop="datePublished">2099-11-05</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/F-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">F_计算机网络</a>
              </p>
              <p class="item-title">
                <a href="/2099/11/04/F_%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C_0%E5%9F%BA%E7%A1%80/" class="title">0基础_计算机网络</a>
              </p>
              <p class="item-date">
                <time datetime="2099-11-03T22:33:16.000Z" itemprop="datePublished">2099-11-04</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/E-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">E_数据结构</a>
              </p>
              <p class="item-title">
                <a href="/2099/11/01/E_%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84_0%E5%9F%BA%E7%A1%80/" class="title">0基础_数据结构</a>
              </p>
              <p class="item-date">
                <time datetime="2099-10-31T22:33:16.000Z" itemprop="datePublished">2099-11-01</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/J-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">J_设计模式</a>
              </p>
              <p class="item-title">
                <a href="/2099/11/01/J_%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F_%E5%9F%BA%E7%A1%80/" class="title">0基础_设计模式</a>
              </p>
              <p class="item-date">
                <time datetime="2099-10-31T22:33:16.000Z" itemprop="datePublished">2099-11-01</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C"><span class="toc-number">1.</span> <span class="toc-text">项目经验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PSP%E4%BA%A7%E5%93%81%E9%80%89%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">PSP产品选型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%97%AE%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">项目问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Echarts"><span class="toc-number">2.1.</span> <span class="toc-text">Echarts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ElelemtUI"><span class="toc-number">2.2.</span> <span class="toc-text">ElelemtUI</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%9A%BE%E7%82%B9"><span class="toc-number">3.</span> <span class="toc-text">项目难点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue2%E7%9A%84CSP%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5-202301"><span class="toc-number">3.1.</span> <span class="toc-text">Vue2的CSP安全策略-202301</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%88%E5%88%A9%E6%B5%8B%E7%AE%97%E8%BD%AE%E8%AF%A2%E6%8E%A5%E5%8F%A3%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F-20220506"><span class="toc-number">3.2.</span> <span class="toc-text">盈利测算轮询接口内存泄漏-20220506</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx%E5%AE%89%E5%85%A8%E7%BB%84%E7%AD%96%E7%95%A5%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%BC%95%E8%B5%B7%E7%9A%84%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98-20220108"><span class="toc-number">3.3.</span> <span class="toc-text">nginx安全组策略配置错误引起的性能问题-20220108</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%B8%B2%E6%9F%9310w%E6%95%B0%E6%8D%AE-20230604"><span class="toc-number">3.4.</span> <span class="toc-text">前端渲染10w数据-20230604</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E5%B7%A5%E4%BD%9C"><span class="toc-number">3.4.1.</span> <span class="toc-text">前置工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%881-%E7%9B%B4%E6%8E%A5%E6%B8%B2%E6%9F%93"><span class="toc-number">3.4.2.</span> <span class="toc-text">方案1:直接渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%882-setTimeout%E5%88%86%E9%A1%B5%E6%B8%B2%E6%9F%93"><span class="toc-number">3.4.3.</span> <span class="toc-text">方案2:setTimeout分页渲染</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%883-requestAnimationFrame"><span class="toc-number">3.4.4.</span> <span class="toc-text">方案3:requestAnimationFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%884-fragment%E6%96%87%E6%A1%A3%E7%A2%8E%E7%89%87-requestAnimationFrame"><span class="toc-number">3.4.5.</span> <span class="toc-text">方案4:fragment文档碎片 + requestAnimationFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%885-%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="toc-number">3.4.6.</span> <span class="toc-text">方案5:懒加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%886-%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8"><span class="toc-number">3.4.7.</span> <span class="toc-text">方案6:虚拟列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%887-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-number">3.4.8.</span> <span class="toc-text">方案7:第三方库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A5%E5%8D%95%E9%A1%B9%E7%9B%AE"><span class="toc-number">4.</span> <span class="toc-text">接单项目</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-Z_业务和面经_项目经验" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      项目经验
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/11/08/Z_%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F_%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/" class="article-date">
	  <time datetime="2021-11-07T22:33:16.000Z" itemprop="datePublished">2021-11-08</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/Z-%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F/">Z_业务和面经</a>
  </span>

        

        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/11/08/Z_%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F_%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1 id="项目经验"><a href="#项目经验" class="headerlink" title="项目经验"></a>项目经验</h1><p>搜索github上优秀的javascript 项目</p>
<p>项目可以是商城、SCRM 系统、OA 系统、物流系统、ERP 系统、CMS 系统、HIS 系统、支付系统、IM 聊天、微信公众号、微信小程序等等。</p>
<h2 id="PSP产品选型"><a href="#PSP产品选型" class="headerlink" title="PSP产品选型"></a>PSP产品选型</h2><p>基于运营商BG（carrier network business group）产品360平台，在地区部代表处运营商不同区域下，按照不同产品线无限数通光划分，对不同产品按照不同维度进行量化分析。其中包括射频bbu主控基带天线等购物车功能，以图表结合的形式分析其商务盈利、现网存量，对产品进行规格、特性、策略多维度数据对比展示。</p>
<p><strong>职位描述</strong><br>1.负责组件库与业务页面开发。<br>2.带领团队完成技术产品实现。<br>3.负责大型多应用架构设计。<br>4.利用前端技术与服务端协同完成团队业务目标。</p>
<p><strong>职位要求</strong><br>0.掌握图形学，webgl或熟练使用threejs框架，熟练canvas相关渲染及动画操作的优先。<br>1.熟练掌握JavaScript。<br>2.熟悉常用工程化工具，掌握模块化思想和技术实现方案。<br>3.熟练掌握React前端框架，了解技术底层。同时了解vue以及angular等其他框架者优先。<br>4.熟练掌握react生态常用工具，redux/react-router等。<br>5.熟悉各种Web前端技术，包括HTML/XML/CSS等，有基于Ajax的前端应用开发经验。<br>6.有良好的编码习惯，对前端技术有持续的热情，个性乐观开朗,逻辑性强，善于和各种背景的人合作。<br>7.具有TS/移动设备上前端开发/NodeJS/服务端开发等经验者优先。</p>
<h1 id="项目问题"><a href="#项目问题" class="headerlink" title="项目问题"></a>项目问题</h1><h2 id="Echarts"><a href="#Echarts" class="headerlink" title="Echarts"></a>Echarts</h2><ul>
<li><a target="_blank" rel="noopener" href="https://bbchin.com/archives/echart-cases#%E5%89%8D%E8%A8%80">Echarts常见问题及解决方法</a></li>
</ul>
<p><strong>如何处理大量数据渲染</strong></p>
<p>设置datazoom，类似分页效果</p>
<p><strong>如何动态适配容器宽高</strong></p>
<p>window.resize</p>
<p>window.resizeObserver</p>
<p>echart.resize()</p>
<p><strong>文件超长如何处理</strong></p>
<p>对formatter显示的文字长度做个截断展示，如a.slice(0,5)+’…’</p>
<p><strong>切换图表卡顿</strong></p>
<p>原因：可能内存溢出了</p>
<p>解决：echarts.clear()和echarts.dispose()</p>
<blockquote>
<p><code>echarts.clear()</code>是清空当前实例，会移除实例中所有的组件和图表。类似v-show</p>
<p><code>echarts.dispose()</code>是销毁实例，销毁后实例无法再被使用。类似v-if</p>
</blockquote>
<h2 id="ElelemtUI"><a href="#ElelemtUI" class="headerlink" title="ElelemtUI"></a>ElelemtUI</h2><p><strong>如何实现table组件自定义功能</strong></p>
<p>开启slot插槽功能</p>
<p><strong>如何覆盖组件样式</strong></p>
<p>使用样式穿透,deep</p>
<p><strong>popover组件二次封装</strong></p>
<p>自定义虚拟手动触发</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v-model:visible=&quot;isPop&quot;</span><br></pre></td></tr></table></figure>

<p>是否将内容插入到body</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:teleported=&quot;false&quot; </span><br></pre></td></tr></table></figure>

<p><strong>国际化配置</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import zhCn from &#x27;element-plus/es/locale/lang/zh-cn&#x27;;</span><br><span class="line">import en from &#x27;element-plus/es/locale/lang/en&#x27;;</span><br><span class="line"></span><br><span class="line">&lt;el-config-provider :locale=&quot;locale&quot;&gt; // zhCn : en</span><br><span class="line">    &lt;router-view v-if=&quot;comStore.leaf&quot; /&gt;</span><br><span class="line">     &lt;div v-else class=&quot;noPermit&quot;&gt;</span><br><span class="line">         &lt;span&gt;抱歉，您暂无访问权限！&lt;/span&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">&lt;/el-config-provider&gt;</span><br></pre></td></tr></table></figure>

<h1 id="项目难点"><a href="#项目难点" class="headerlink" title="项目难点"></a>项目难点</h1><h2 id="Vue2的CSP安全策略-202301"><a href="#Vue2的CSP安全策略-202301" class="headerlink" title="Vue2的CSP安全策略-202301"></a>Vue2的CSP安全策略-202301</h2><p><strong>总结</strong>：因为看了Vue3的源码，基于Vue.js 3.0 的编译过程，发现它在离线编译的时候也会把结果编译成带前缀的，核心代码借过来，然后再做一些修改来支持自己特定的一些 feature，这个难题就被我解决了。</p>
<p><strong>背景</strong>：今年1月份，在我们的 Web 项目中开启了 CSP 安全策略，其中把 <code>unsafe-eval</code> 从 <code>script-src</code> 中拿掉了，但是这么操作导致了一个很严重的问题，由于运行在 Web 的项目有一部分组件是通过 Vue.js 开发的，这部分代码全部不能正常工作了。</p>
<p><strong>问题</strong>：目前老项目是直接通过 CDN 的方式引入 Vue.js，并在后端的 Java 模板中写组件的 template，然后用在运行时编译模板。我们知道编译的过程最后是生成一段 code 字符串，然后通过 <code>new Function</code> 的方式转成 render 函数，但是 CSP 安全策略开启后，<code>new Function</code> 和 <code>eval</code> 都被禁用了，导致整个编译后的流程不能进行下去。</p>
<p><strong>解决</strong>：</p>
<ul>
<li>使用 runtime-only 版本的 Vue.js，涉及大量使用vue.js的页面，成本高，短期实现不了</li>
<li>开发一个CSP 兼容版本的 Vue.js，但是到了 Vue.js 2.x 后，官方就不再提供 CSP 兼容版本了，因为从官方的视角看，我都提供了 runtime-only 版本的解决方案了，完全没必要提供 CSP 兼容版本了。</li>
</ul>
<p>现阶段最小成本解决问题的方式就是使用一个 CSP 兼容版本的 Vue.js，所以只能魔改 Vue.js 了。</p>
<p><strong>一、new Function替换为notevil库</strong> </p>
<blockquote>
<p><code>new Function</code> 不能用了，那么生成的 code 字符串如何执行呢？经过调研，我选用了 notevil 这个库。</p>
<p>它其实就是用 JavaScript 去实现 JavsScript 的解析引擎，大致原理是先把源码解析成 AST 树，再去遍历 AST 树，对不同类型的节点做不同的处理，达到最终执行 JavaScript 代码的目的。</p>
<p>但 notevil 的实现还是不够完整，致命的是对 <code>with</code> 的语法不支持。还如一些 ES6 的语法，像箭头函数、数组对象的解构赋值，是不支持的</p>
</blockquote>
<p>Vue.js 2.x 组件模板最终编译的代码，是使用 <code>with</code> 语法做了一层包装：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;  </span><br><span class="line">  &#123;&#123; message &#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">编译后：</span><br><span class="line">with(this)&#123;return _c(&#x27;div&#x27;,[_v(_s(message))])&#125;</span><br></pre></td></tr></table></figure>

<p>Vue.js 为了让用户使用方便，在模板中访问数据不用手动加 <code>this</code>。Vue自己将this定义在组件实例上。</p>
<p>如果不用 <code>with(this)</code> 的话，我们需要生成如下的代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function(_ctx) &#123;</span><br><span class="line">  return _ctx._c(&#x27;div,[_ctx._v(_ctx._s(_ctx.message))])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们定义一个函数，接受一个 <code>_ctx</code> 参数，这个 <code>_ctx</code> 在运行时就是组件传入的实例对象 <code>this</code>。</p>
<p>这个时候，你可能会说，这有何难的，我们给所有的变量和函数的对象前面加上 <code>_ctx</code> 前缀不就可以了吗，但事情并没有你想的那么简单。<strong>尤其对于复杂的表达式。</strong></p>
<p><strong>二、该加this的添加this</strong></p>
<p>Vue.js 2.x 的编译会经过三个过程：template 解析生成 AST ——&gt; AST 优化 ——&gt; AST 生成 code。我的思路是不改变这三个过程，最后追加一个转换生成的 code的过程。</p>
<p>具体思路：先把转换前的代码解析生成 AST，再去遍历这颗 AST，根据语法在相关的位置上加上前缀（修改 AST 的 节点），最后再把修改后的 AST 转换成代码。</p>
<ul>
<li>recast 库完成了code → AST 和 AST → code</li>
<li>estree-walker 库去遍历 AST 的节点，通过一系列判断条件去判断这个节点需不需要加前缀</li>
</ul>
<blockquote>
<p>注意：</p>
<p>1.函数的参数不能加前缀，局部变量不能加前缀，全局内置变量不能加前缀，已经加过前缀的节点不能加前缀等。</p>
<p>2.函数嵌套函数，存在闭包情况。需要设计一个堆栈的数据结构，在函数进入入栈，函数退出出栈，如果是外层函数中定义的变量，内部函数是不能加前缀的。</p>
<p>3.recast、estree-walker 原本都是在 node.js 端跑的，为了让它们在前端运行，我也分别 clone 了它们的代码， 用 rollup 对它们做打包，并删除了内部一些 node only 的代码和一定程度的魔改，最终编译出一份在 web 端跑的代码，放到了 lib 目录。</p>
</blockquote>
<p>为什么 Vue.js 编译生成的代码需要用 <code>with</code> 包一层？</p>
<p>缺点： 在 ECMAScript 5 的严格模式中是被禁用的。优点：利用 <code>with</code> 的特性动去指定的对象中查找即可，完全不用做多余的转换，也不用引入这些 AST 解析库了，因为引入这些库(recast,estree-walker)要让 Vue.js 最终打包的体积大了约四倍。</p>
<p>题外话</p>
<blockquote>
<p>我们平时经常会强调技术选型的能力，其实技术选型的一个标准，就是你选择的第三方依赖，你能不能 hold 住。首先是你知道它的职责边界，知道它能做什么不能做什么，怎么利用它帮助你开发需求；其次是出了错你能不能快速定位到原因，知道是依赖的问题还是自身使用的问题；最后就是当它不能满足你的需求，并且官方不愿意解决或者不维护的情况下，你能不能去 fork 这个库，自己开发解决并实现。那么显然拥有这些能力就需要你对它的源码实现非常了解，所以这也是一些高阶岗位为什么会在面试中考察你对技术原理掌握的一方面原因</p>
</blockquote>
<h2 id="盈利测算轮询接口内存泄漏-20220506"><a href="#盈利测算轮询接口内存泄漏-20220506" class="headerlink" title="盈利测算轮询接口内存泄漏-20220506"></a>盈利测算轮询接口内存泄漏-20220506</h2><p>盈利测算轮询接口，发现有些大数据量场景下，页面出现卡顿，使用chrome memory打印内存快照，发现发起测算后内存使用率比较高。</p>
<p>(1)内存泄露原因<br>JS和DOM垃圾回收是两套机制，增加了回收难度。<br>JS对象使用标记清除；DOM对象使用引用计数。其中DOM的引用计数在循环引用场景下，结合闭包容易造成内存泄露。<br>(2)引发内存泄露<br>(2.1)使用完毕对象后，没有主动销毁<br>(2.2)循环引用<br>DOM对象和Javascript对象循环引用<br>function leakTest(){<br>let x=nee Object();<br>x.obj=document.createElement(‘div’);<br>x.obj.jsobj=x;<br>}<br>(3)分析内存泄露工具<br>chrome的memory内存快照工具</p>
<p>(4)避免内存泄露<br>(4.1)创建dom或大数组后，也要对应删除dom，数组<br>(4.2)事件监听<br>页面组件销毁时，要解绑事件监听，能解决90%的内存泄露<br>(4.3)禁止使用console.log打印大量数据，setInterval启动定时器后必要时销毁，尽量避免使用iframe。</p>
<h2 id="nginx安全组策略配置错误引起的性能问题-20220108"><a href="#nginx安全组策略配置错误引起的性能问题-20220108" class="headerlink" title="nginx安全组策略配置错误引起的性能问题-20220108"></a>nginx安全组策略配置错误引起的性能问题-20220108</h2><p>问题：用户反馈系统时不时出现响应慢的问题，查询产品列表接口，经常出现一次5秒的转圈，影响用户体验<br><strong>定位：</strong></p>
<p>(1)微服务接口分析，f12查看接口比对tomcat后台日志，时间基本吻合，排除微服务本身问题；</p>
<p>(2)nginx路由分析，登录深圳region的两台nginx，打印耗时也只有255ms;</p>
<p>(3)域名服务器，东莞部署的域名服务器，终于找到5s耗时，大胆推测是因为某种机制导致额外耗时，要么流控，要么失败重试。首先排查流控，流量访问量较低，远远没有达到流控的阈值-qps50。5s有可能是重试机制的请求间隔时间。</p>
<p>(4)顺着重试的机制可能性，对比正常日志，分析两者差异，发现有5s间隔时间，本来想找504网关超时，但没找到，后来发现，nginx根本没进去。最后发现另外一台nginx访问不通。后来发现其他域名能正常访问这台ip89结尾的nginx服务器，排除防火墙问题，对比nginx配置，也一样，联想到504日志也没有，请求进入nginx前就被拒了，最后怀疑是云服务的安全组策略问题。ip以89结尾的nginx服务器缺少routerservice-front-sg策略<br><strong>解决与反思：</strong></p>
<p>添加安全组策略。</p>
<p>(1)因为更换了域名，该问题一直以性能问题暴露，没及时处理，主要是历史原因，性能一直不高，潜意识里已经默认接受，没有引起关注(2)从正常思维来考虑，性能问题大多数出现在微服务自身，有可能之前有人发现过，但又不了了之。</p>
<p><strong>改进：</strong></p>
<p>(1)增加系统告警策略，当域名请求异常时，增加短信电话通知关系人(2)动员团队成员学习问题排除流程，加快问题定位。</p>
<h2 id="前端渲染10w数据-20230604"><a href="#前端渲染10w数据-20230604" class="headerlink" title="前端渲染10w数据-20230604"></a>前端渲染10w数据-20230604</h2><h3 id="前置工作"><a href="#前置工作" class="headerlink" title="前置工作"></a>前置工作</h3><p><strong>后端模拟服务</strong></p>
<p>新建一个<code>server.js</code>文件，简单起个服务，并返回给前端<code>10w</code>条数据，并通过<code>nodemon server.js</code>开启服务</p>
<blockquote>
<p>没有安装<code>nodemon</code>的同学可以先全局安装<code>npm i nodemon -g</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// server.js</span><br><span class="line"></span><br><span class="line">const http = require(&#x27;http&#x27;)</span><br><span class="line">const port = 8000;</span><br><span class="line"></span><br><span class="line">http.createServer(function (req, res) &#123;</span><br><span class="line">  // 开启Cors</span><br><span class="line">  res.writeHead(200, &#123;</span><br><span class="line">    //设置允许跨域的域名，也可设置*允许所有域名</span><br><span class="line">    &#x27;Access-Control-Allow-Origin&#x27;: &#x27;*&#x27;,</span><br><span class="line">    //跨域允许的请求方法，也可设置*允许所有方法</span><br><span class="line">    &quot;Access-Control-Allow-Methods&quot;: &quot;DELETE,PUT,POST,GET,OPTIONS&quot;,</span><br><span class="line">    //允许的header类型</span><br><span class="line">    &#x27;Access-Control-Allow-Headers&#x27;: &#x27;Content-Type&#x27;</span><br><span class="line">  &#125;)</span><br><span class="line">  let list = []</span><br><span class="line">  let num = 0</span><br><span class="line"></span><br><span class="line">  // 生成10万条数据的list</span><br><span class="line">  for (let i = 0; i &lt; 100000; i++) &#123;</span><br><span class="line">    num++</span><br><span class="line">    list.push(&#123;</span><br><span class="line">      src: &#x27;https://p3-passport.byteacctimg.com/img/user-avatar/d71c38d1682c543b33f8d716b3b734ca~300x300.image&#x27;,</span><br><span class="line">      text: `我是$&#123;num&#125;号嘉宾林三心`,</span><br><span class="line">      tid: num</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.end(JSON.stringify(list));</span><br><span class="line">&#125;).listen(port, function () &#123;</span><br><span class="line">  console.log(&#x27;server is listening on port &#x27; + port);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>前端页面</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// index.html</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    * &#123;</span><br><span class="line">      padding: 0;</span><br><span class="line">      margin: 0;</span><br><span class="line">    &#125;</span><br><span class="line">    #container &#123;</span><br><span class="line">      height: 100vh;</span><br><span class="line">      overflow: auto;</span><br><span class="line">    &#125;</span><br><span class="line">    .sunshine &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      padding: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">    img &#123;</span><br><span class="line">      width: 150px;</span><br><span class="line">      height: 150px;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line"></span><br><span class="line">// html部分</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id=&quot;container&quot;&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;script src=&quot;./index.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// index.js</span><br><span class="line">// 请求函数</span><br><span class="line">const getList = () =&gt; &#123;</span><br><span class="line">    return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        //步骤一:创建异步对象</span><br><span class="line">        var ajax = new XMLHttpRequest();</span><br><span class="line">        //步骤二:设置请求的url参数,参数一是请求的类型,参数二是请求的url,可以带参数</span><br><span class="line">        ajax.open(&#x27;get&#x27;, &#x27;http://127.0.0.1:8000&#x27;);</span><br><span class="line">        //步骤三:发送请求</span><br><span class="line">        ajax.send();</span><br><span class="line">        //步骤四:注册事件 onreadystatechange 状态改变就会调用</span><br><span class="line">        ajax.onreadystatechange = function () &#123;</span><br><span class="line">            if (ajax.readyState == 4 &amp;&amp; ajax.status == 200) &#123;</span><br><span class="line">                //步骤五 如果能够进到这个判断 说明 数据 完美的回来了,并且请求的页面是存在的</span><br><span class="line">                resolve(JSON.parse(ajax.responseText))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 获取container对象</span><br><span class="line">const container = document.getElementById(&#x27;container&#x27;)</span><br></pre></td></tr></table></figure>

<h3 id="方案1-直接渲染"><a href="#方案1-直接渲染" class="headerlink" title="方案1:直接渲染"></a>方案1:直接渲染</h3><p>一次性渲染出<code>10w</code>个节点,耗时12s。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const renderList = async () =&gt; &#123;</span><br><span class="line">    console.time(&#x27;列表时间&#x27;)</span><br><span class="line">    const list = await getList()</span><br><span class="line">    list.forEach(item =&gt; &#123;</span><br><span class="line">        const div = document.createElement(&#x27;div&#x27;)</span><br><span class="line">        div.className = &#x27;sunshine&#x27;</span><br><span class="line">        div.innerHTML = `&lt;img src=&quot;$&#123;item.src&#125;&quot; /&gt;&lt;span&gt;$&#123;item.text&#125;&lt;/span&gt;`</span><br><span class="line">        container.appendChild(div)</span><br><span class="line">    &#125;)</span><br><span class="line">    console.timeEnd(&#x27;列表时间&#x27;)</span><br><span class="line">&#125;</span><br><span class="line">renderList()</span><br></pre></td></tr></table></figure>

<h3 id="方案2-setTimeout分页渲染"><a href="#方案2-setTimeout分页渲染" class="headerlink" title="方案2:setTimeout分页渲染"></a>方案2:setTimeout分页渲染</h3><p>把<code>10w</code>按照每页数量<code>limit</code>分成总共<code>Math.ceil(total / limit)</code>页，然后利用<code>setTimeout</code>，每次渲染1页数据，这样的话，渲染出首页数据的时间大大缩减了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">const renderList = async () =&gt; &#123;</span><br><span class="line">    console.time(&#x27;列表时间&#x27;)</span><br><span class="line">    const list = await getList()</span><br><span class="line">    console.log(list)</span><br><span class="line">    const total = list.length</span><br><span class="line">    const page = 0</span><br><span class="line">    const limit = 200</span><br><span class="line">    const totalPage = Math.ceil(total / limit)</span><br><span class="line"></span><br><span class="line">    const render = (page) =&gt; &#123;</span><br><span class="line">        if (page &gt;= totalPage) return</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">            for (let i = page * limit; i &lt; page * limit + limit; i++) &#123;</span><br><span class="line">                const item = list[i]</span><br><span class="line">                const div = document.createElement(&#x27;div&#x27;)</span><br><span class="line">                div.className = &#x27;sunshine&#x27;</span><br><span class="line">                div.innerHTML = `&lt;img src=&quot;$&#123;item.src&#125;&quot; /&gt;&lt;span&gt;$&#123;item.text&#125;&lt;/span&gt;`</span><br><span class="line">                container.appendChild(div)</span><br><span class="line">            &#125;</span><br><span class="line">            render(page + 1)</span><br><span class="line">        &#125;, 0)</span><br><span class="line">    &#125;</span><br><span class="line">    render(page)</span><br><span class="line">    console.timeEnd(&#x27;列表时间&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案3-requestAnimationFrame"><a href="#方案3-requestAnimationFrame" class="headerlink" title="方案3:requestAnimationFrame"></a>方案3:requestAnimationFrame</h3><p>使用<code>requestAnimationFrame</code>代替<code>setTimeout</code>，减少了<code>重排</code>的次数，极大提高了性能，建议大家在渲染方面多使用<code>requestAnimationFrame</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const renderList = async () =&gt; &#123;</span><br><span class="line">    console.time(&#x27;列表时间&#x27;)</span><br><span class="line">    const list = await getList()</span><br><span class="line">    console.log(list)</span><br><span class="line">    const total = list.length</span><br><span class="line">    const page = 0</span><br><span class="line">    const limit = 200</span><br><span class="line">    const totalPage = Math.ceil(total / limit)</span><br><span class="line"></span><br><span class="line">    const render = (page) =&gt; &#123;</span><br><span class="line">        if (page &gt;= totalPage) return</span><br><span class="line">        // 使用requestAnimationFrame代替setTimeout</span><br><span class="line">        requestAnimationFrame(() =&gt; &#123;</span><br><span class="line">            for (let i = page * limit; i &lt; page * limit + limit; i++) &#123;</span><br><span class="line">                const item = list[i]</span><br><span class="line">                const div = document.createElement(&#x27;div&#x27;)</span><br><span class="line">                div.className = &#x27;sunshine&#x27;</span><br><span class="line">                div.innerHTML = `&lt;img src=&quot;$&#123;item.src&#125;&quot; /&gt;&lt;span&gt;$&#123;item.text&#125;&lt;/span&gt;`</span><br><span class="line">                container.appendChild(div)</span><br><span class="line">            &#125;</span><br><span class="line">            render(page + 1)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render(page)</span><br><span class="line">    console.timeEnd(&#x27;列表时间&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案4-fragment文档碎片-requestAnimationFrame"><a href="#方案4-fragment文档碎片-requestAnimationFrame" class="headerlink" title="方案4:fragment文档碎片 + requestAnimationFrame"></a>方案4:fragment文档碎片 + requestAnimationFrame</h3><p>优点</p>
<blockquote>
<p>1、之前都是每次创建一个<code>div</code>标签就<code>appendChild</code>一次，但是有了<code>文档碎片</code>可以先把1页的<code>div</code>标签先放进<code>文档碎片</code>中，然后一次性<code>appendChild</code>到<code>container</code>中，这样减少了<code>appendChild</code>的次数，极大提高了性能</p>
<p>2、页面只会渲染<code>文档碎片</code>包裹着的元素，而不会渲染<code>文档碎片</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">const renderList = async () =&gt; &#123;</span><br><span class="line">    console.time(&#x27;列表时间&#x27;)</span><br><span class="line">    const list = await getList()</span><br><span class="line">    console.log(list)</span><br><span class="line">    const total = list.length</span><br><span class="line">    const page = 0</span><br><span class="line">    const limit = 200</span><br><span class="line">    const totalPage = Math.ceil(total / limit)</span><br><span class="line"></span><br><span class="line">    const render = (page) =&gt; &#123;</span><br><span class="line">        if (page &gt;= totalPage) return</span><br><span class="line">        requestAnimationFrame(() =&gt; &#123;</span><br><span class="line">            // 创建一个文档碎片</span><br><span class="line">            const fragment = document.createDocumentFragment()</span><br><span class="line">            for (let i = page * limit; i &lt; page * limit + limit; i++) &#123;</span><br><span class="line">                const item = list[i]</span><br><span class="line">                const div = document.createElement(&#x27;div&#x27;)</span><br><span class="line">                div.className = &#x27;sunshine&#x27;</span><br><span class="line">                div.innerHTML = `&lt;img src=&quot;$&#123;item.src&#125;&quot; /&gt;&lt;span&gt;$&#123;item.text&#125;&lt;/span&gt;`</span><br><span class="line">                // 先塞进文档碎片</span><br><span class="line">                fragment.appendChild(div)</span><br><span class="line">            &#125;</span><br><span class="line">            // 一次性appendChild</span><br><span class="line">            container.appendChild(fragment)</span><br><span class="line">            render(page + 1)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render(page)</span><br><span class="line">    console.timeEnd(&#x27;列表时间&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方案5-懒加载"><a href="#方案5-懒加载" class="headerlink" title="方案5:懒加载"></a>方案5:懒加载</h3><p>原理</p>
<blockquote>
<p>在列表尾部放一个空节点<code>blank</code>，然后先渲染第1页数据，向上滚动，等到<code>blank</code>出现在视图中，就说明到底了，这时候再加载第二页，往后以此类推。</p>
<p>至于怎么判断<code>blank</code>出现在视图上，可以使用<code>getBoundingClientRect</code>方法获取<code>top</code>属性。</p>
<p>其中<code>IntersectionObserver</code> 性能更好，但是我这里就拿<code>getBoundingClientRect</code>来举例</p>
</blockquote>
<img src="/img/image-20230614065329214.png" alt="image-20230614065329214" style="zoom:70%;" />

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; onMounted, ref, computed &#125; from &#x27;vue&#x27;</span><br><span class="line">const getList = () =&gt; &#123;</span><br><span class="line">  // 跟上面一样的代码</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const container = ref&lt;HTMLElement&gt;() // container节点</span><br><span class="line">const blank = ref&lt;HTMLElement&gt;() // blank节点</span><br><span class="line">const list = ref&lt;any&gt;([]) // 列表</span><br><span class="line">const page = ref(1) // 当前页数</span><br><span class="line">const limit = 200 // 一页展示</span><br><span class="line">// 最大页数</span><br><span class="line">const maxPage = computed(() =&gt; Math.ceil(list.value.length / limit))</span><br><span class="line">// 真实展示的列表</span><br><span class="line">const showList = computed(() =&gt; list.value.slice(0, page.value * limit))</span><br><span class="line">const handleScroll = () =&gt; &#123;</span><br><span class="line">  // 当前页数与最大页数的比较</span><br><span class="line">  if (page.value &gt; maxPage.value) return</span><br><span class="line">  const clientHeight = container.value?.clientHeight</span><br><span class="line">  const blankTop = blank.value?.getBoundingClientRect().top</span><br><span class="line">  if (clientHeight === blankTop) &#123;</span><br><span class="line">    // blank出现在视图，则当前页数加1</span><br><span class="line">    page.value++</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(async () =&gt; &#123;</span><br><span class="line">  const res = await getList()</span><br><span class="line">  list.value = res</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;container&quot; @scroll=&quot;handleScroll&quot; ref=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;sunshine&quot; v-for=&quot;(item) in showList&quot; :key=&quot;item.tid&quot;&gt;</span><br><span class="line">      &lt;img :src=&quot;item.src&quot; /&gt;</span><br><span class="line">      &lt;span&gt;&#123;&#123; item.text &#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div ref=&quot;blank&quot;&gt;&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h3 id="方案6-虚拟列表"><a href="#方案6-虚拟列表" class="headerlink" title="方案6:虚拟列表"></a>方案6:虚拟列表</h3><p>参考</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903982742110216#heading-4">「前端进阶」高性能渲染十万条数据(虚拟列表)</a></li>
</ul>
<p>原理</p>
<blockquote>
<p>虚拟滚动，就是根据<code>容器可视区域</code>的<code>列表容积数量</code>，监听用户滑动或滚动事件，动态截取<code>长列表数据</code>中的<code>部分数据</code>渲染到页面上，动态使用空白站位填充容器<code>上下滚动区域内容</code>，模拟实现<code>原生滚动效果</code>。总结一句话：使用绝对定位和滚动监听实现。</p>
</blockquote>
<img src="/img/image-20230614065430330.png" alt="image-20230614065430330" style="zoom:80%;" />

<blockquote>
<ul>
<li>浏览器渲染===康熙选秀：一次性渲染10000个肯定会使浏览器压力大，造成用户体验差</li>
<li>容器可视区域===选秀大殿：10000个排队去渲染，比如一次渲染10个</li>
<li>上方下方区域===左右偏殿：轮不到你渲染，你就乖乖进空白区待着</li>
</ul>
</blockquote>
<p><strong>基本实现过程</strong></p>
<blockquote>
<ul>
<li>步骤1:计算列表总高度listHeight和可视区域高度screenHeight</li>
<li>步骤2:根据可视区域高度计算可显示的列表项数visibleCount</li>
<li>步骤3:在滚动时，重新计算起始索引start和结束索引end，核心滚动偏移量startOffset。</li>
</ul>
</blockquote>
<p><strong>固定高度代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualList :listData=&quot;d&quot; :itemSize=&quot;100&quot; /&gt;</span><br><span class="line">let d = ref([]);</span><br><span class="line">for (let i = 0; i &lt; 1000; i++) &#123;</span><br><span class="line">  d.value.push(&#123; id: i, value: i &#125;);</span><br><span class="line">&#125;</span><br><span class="line">                         </span><br><span class="line">// VirtualList.vue                       </span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div ref=&quot;list&quot; class=&quot;infinite-list-container&quot; @scroll=&quot;scrollEvent($event)&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;infinite-list-phantom&quot; :style=&quot;&#123; height: listHeight + &#x27;px&#x27; &#125;&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;infinite-list&quot; :style=&quot;&#123; transform: getTransform &#125;&quot;&gt;</span><br><span class="line">      &lt;div ref=&quot;items&quot; class=&quot;infinite-list-item&quot; v-for=&quot;item in visibleData&quot; :key=&quot;item.id&quot; :style=&quot;&#123; height: itemSize + &#x27;px&#x27;, lineHeight: itemSize + &#x27;px&#x27; &#125;&quot;&gt;&#123;&#123; item.value &#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;VirtualList&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    //所有列表数据</span><br><span class="line">    listData: &#123;</span><br><span class="line">      type: Array,</span><br><span class="line">      default: () =&gt; [],</span><br><span class="line">    &#125;,</span><br><span class="line">    //每项高度</span><br><span class="line">    itemSize: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 200,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      //可视区域高度</span><br><span class="line">      screenHeight: 0,</span><br><span class="line">      //核心滚动偏移量</span><br><span class="line">      startOffset: 0,</span><br><span class="line">      //起始索引</span><br><span class="line">      start: 0,</span><br><span class="line">      //结束索引</span><br><span class="line">      end: null,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    //列表总高度</span><br><span class="line">    listHeight() &#123;</span><br><span class="line">      return this.listData.length * this.itemSize;</span><br><span class="line">    &#125;,</span><br><span class="line">    //可显示的列表项数</span><br><span class="line">    visibleCount() &#123;</span><br><span class="line">      return Math.ceil(this.screenHeight / this.itemSize);</span><br><span class="line">    &#125;,</span><br><span class="line">    //偏移量对应的style</span><br><span class="line">    getTransform() &#123;</span><br><span class="line">      return `translate3d(0,$&#123;this.startOffset&#125;px,0)`;</span><br><span class="line">    &#125;,</span><br><span class="line">    //获取真实显示列表数据</span><br><span class="line">    visibleData() &#123;</span><br><span class="line">      return this.listData.slice(this.start, Math.min(this.end, this.listData.length));</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.screenHeight = this.$el.clientHeight;</span><br><span class="line">    this.start = 0;</span><br><span class="line">    this.end = this.start + this.visibleCount;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    scrollEvent() &#123;</span><br><span class="line">      //当前滚动位置</span><br><span class="line">      let scrollTop = this.$refs.list.scrollTop;</span><br><span class="line">      //此时的开始索引</span><br><span class="line">      this.start = Math.floor(scrollTop / this.itemSize);</span><br><span class="line">      //此时的结束索引</span><br><span class="line">      this.end = this.start + this.visibleCount;</span><br><span class="line">      //此时的偏移量</span><br><span class="line">      this.startOffset = scrollTop - (scrollTop % this.itemSize);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.infinite-list-container &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">  overflow: auto;</span><br><span class="line">  position: relative;</span><br><span class="line">  -webkit-overflow-scrolling: touch;</span><br><span class="line">&#125;</span><br><span class="line">.infinite-list-phantom &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  z-index: -1;</span><br><span class="line">&#125;</span><br><span class="line">.infinite-list &#123;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  position: absolute;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line">.infinite-list-item &#123;</span><br><span class="line">  padding: 10px;</span><br><span class="line">  color: #555;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  border-bottom: 1px solid #999;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>html元素</p>
<ul>
<li><code>infinite-list-container</code> 为<code>可视区域</code>的容器</li>
<li><code>infinite-list-phantom</code> 为容器内的占位，高度为总列表高度，用于形成滚动条</li>
<li><code>infinite-list</code> 为列表项的<code>渲染区域</code></li>
</ul>
<p>参数</p>
<ul>
<li>假定<code>可视区域</code>高度固定，称之为<code>screenHeight</code></li>
<li>假定<code>列表每项</code>高度固定，称之为<code>itemSize</code></li>
<li>假定<code>列表数据</code>称之为<code>listData</code></li>
<li>假定<code>当前滚动位置</code>称之为<code>scrollTop</code></li>
</ul>
<p>则可推算出：</p>
<ul>
<li>列表总高度<code>listHeight</code> = listData.length * itemSize</li>
<li>可显示的列表项数<code>visibleCount</code> = Math.ceil(screenHeight / itemSize)</li>
<li>数据的起始索引<code>startIndex</code> = Math.floor(scrollTop / itemSize)</li>
<li>数据的结束索引<code>endIndex</code> = startIndex + visibleCount</li>
<li>列表显示数据为<code>visibleData</code> = listData.slice(startIndex,endIndex)</li>
</ul>
<p><strong>重要参数</strong></p>
<p>当滚动后，由于<code>渲染区域</code>相对于<code>可视区域</code>已经发生了偏移，此时我需要获取一个偏移量<code>startOffset</code>，通过样式控制将<code>渲染区域</code>偏移至<code>可视区域</code>中。</p>
<blockquote>
<p>滚动偏移量<code>startOffset</code> = scrollTop - (scrollTop % itemSize);</p>
</blockquote>
<p>为什么不写成this.startOffset = scrollTop？</p>
<blockquote>
<p>通俗理解：如果写成这个，数据都是固定跳变，没有滚动的动画变化效果。</p>
<p>具体解释：</p>
<p>比如说，列表第0项，高度100px，你现在滚动条滚动了50px，期望的效果必然是第0项，一半在屏幕外，一半在屏幕内，此时是没有偏移量的，完全由滚动条来控制页面显示内容。此时又发生了滚动，滚动到了100px，此时我们期望的的：可视区域已经没有第0项了，变成第1项。由于我们是虚拟列表，所以第0项的dom发生了修改变成了第1项的dom，第一项的dom变成了第2项dom，如果没有偏移量，可视区域的第一条内容就变成了第2项，所以我们需要修改偏移量，让列表像下偏移100px，将第1项的dom显示出来。</p>
<p>没有达到换一个item的时候就设置没有偏移量 这个scrollTop - (scrollTop % this.itemSize)就是没达到一个itemSize的时候就是多余的减掉多余的变成o这个内容会被浏览器带着走 就会看到动画 如果你有设置等于scrollTop的话 你浏览器滚动了 那你偏移量和scrollTop一样的话 相当于没有动画 和浏览器同步走了 然后到了换数据item1变成item2的时候就会突然给你换掉 就没有动画了 这样写就让浏览器带着走有动画</p>
</blockquote>
<p><strong>列表项动态高度代码</strong></p>
<p>对于不是固定高度的列表，上述方案就不能解决这个问题。</p>
<p>目前虚拟列表动态高度的解决方案有3种：</p>
<ul>
<li>方案1:包含所有列表项高度的数据，如 [50, 20, 100, 80, …]</li>
<li>方案2:将列表项<code>渲染到屏幕外</code>，对其高度进行测量并缓存，然后再将其渲染至可视区域内。</li>
<li>方案3:以<code>预估高度</code>先行渲染，然后获取真实高度并缓存。</li>
</ul>
<blockquote>
<ul>
<li>方案1虽然灵活，但需要事先知道高度，无法解决列表项高度由内容撑开的情况</li>
<li>方案2:由于预先渲染至屏幕外，再渲染至屏幕内，这导致渲染成本增加一倍，这对于数百万用户在低端移动设备上使用的产品来说是不切实际的。</li>
<li>方案3:可以解决前面2种方案的缺陷</li>
</ul>
</blockquote>
<p>实现过程</p>
<ul>
<li>定义组件属性<code>estimatedItemSize</code>,用于接收<code>预估高度</code></li>
<li>定义<code>positions</code>，用于列表项渲染后存储<code>每一项的高度以及位置</code>信息</li>
<li><code>列表高度</code>实际就等于列表中最后一项的底部距离列表顶部的位置。</li>
</ul>
<p>完整代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualList :listData=&quot;data&quot; :estimatedItemSize=&quot;100&quot; /&gt;</span><br><span class="line">  import faker from &quot;faker&quot;;</span><br><span class="line">let data = [];</span><br><span class="line">for (let id = 0; id &lt; 1000; id++) &#123;</span><br><span class="line">  data.push(&#123;</span><br><span class="line">    id,</span><br><span class="line">    value: faker.lorem.sentences() // 长文本</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">                           </span><br><span class="line">// VirtualList.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div ref=&quot;list&quot; :style=&quot;&#123; height &#125;&quot; class=&quot;infinite-list-container&quot; @scroll=&quot;scrollEvent($event)&quot;&gt;</span><br><span class="line">    &lt;div ref=&quot;phantom&quot; class=&quot;infinite-list-phantom&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;div ref=&quot;content&quot; class=&quot;infinite-list&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;infinite-list-item&quot; ref=&quot;items&quot; :id=&quot;item._index&quot; :key=&quot;item._index&quot; v-for=&quot;item in visibleData&quot;&gt;</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          &lt;span style=&quot;color: red&quot;&gt;&#123;&#123; item.id &#125;&#125;&lt;/span&gt;</span><br><span class="line">          &#123;&#123; item.value &#125;&#125;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    //所有列表数据</span><br><span class="line">    listData: &#123;</span><br><span class="line">      type: Array,</span><br><span class="line">      default: () =&gt; [],</span><br><span class="line">    &#125;,</span><br><span class="line">    //预估高度</span><br><span class="line">    estimatedItemSize: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      required: true,</span><br><span class="line">    &#125;,</span><br><span class="line">    //容器高度 100px or 50vh</span><br><span class="line">    height: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &#x27;100%&#x27;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      //可视区域高度</span><br><span class="line">      screenHeight: 0,</span><br><span class="line">      //起始索引</span><br><span class="line">      start: 0,</span><br><span class="line">      //结束索引</span><br><span class="line">      end: 0,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    _listData() &#123;</span><br><span class="line">      return this.listData.map((item, index) =&gt; &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          _index: `_$&#123;index&#125;`,</span><br><span class="line">          item,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    visibleCount() &#123;</span><br><span class="line">      return Math.ceil(this.screenHeight / this.estimatedItemSize);</span><br><span class="line">    &#125;,</span><br><span class="line">    visibleData() &#123;</span><br><span class="line">      return this._listData.slice(this.start, this.end);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    this.initPositions();</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    this.screenHeight = this.$el.clientHeight;</span><br><span class="line">    this.start = 0;</span><br><span class="line">    this.end = this.start + this.visibleCount;</span><br><span class="line">  &#125;,</span><br><span class="line">  updated() &#123;</span><br><span class="line">    this.$nextTick(function () &#123;</span><br><span class="line">      if (!this.$refs.items || !this.$refs.items.length) &#123;</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">      //获取真实元素大小，修改对应的尺寸缓存</span><br><span class="line">      this.updateItemsSize();</span><br><span class="line">      //更新列表总高度</span><br><span class="line">      let height = this.positions[this.positions.length - 1].bottom;</span><br><span class="line">      this.$refs.phantom.style.height = height + &#x27;px&#x27;;</span><br><span class="line">      //更新真实偏移量</span><br><span class="line">      this.setStartOffset();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    initPositions() &#123;</span><br><span class="line">      this.positions = this.listData.map((d, index) =&gt; (&#123;</span><br><span class="line">        index,</span><br><span class="line">        height: this.estimatedItemSize,</span><br><span class="line">        top: index * this.estimatedItemSize,</span><br><span class="line">        bottom: (index + 1) * this.estimatedItemSize,</span><br><span class="line">      &#125;));</span><br><span class="line">    &#125;,</span><br><span class="line">    //获取列表起始索引</span><br><span class="line">    getStartIndex(scrollTop = 0) &#123;</span><br><span class="line">      //二分法查找</span><br><span class="line">      return this.binarySearch(this.positions, scrollTop);</span><br><span class="line">    &#125;,</span><br><span class="line">    //二分法查找</span><br><span class="line">    binarySearch(list, value) &#123;</span><br><span class="line">      let start = 0;</span><br><span class="line">      let end = list.length - 1;</span><br><span class="line">      let tempIndex = null;</span><br><span class="line">      while (start &lt;= end) &#123;</span><br><span class="line">        let midIndex = parseInt((start + end) / 2);</span><br><span class="line">        let midValue = list[midIndex].bottom;</span><br><span class="line">        if (midValue === value) &#123;</span><br><span class="line">          return midIndex + 1;</span><br><span class="line">        &#125; else if (midValue &lt; value) &#123;</span><br><span class="line">          start = midIndex + 1;</span><br><span class="line">        &#125; else if (midValue &gt; value) &#123;</span><br><span class="line">          if (tempIndex === null || tempIndex &gt; midIndex) &#123;</span><br><span class="line">            tempIndex = midIndex;</span><br><span class="line">          &#125;</span><br><span class="line">          end = end - 1;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      return tempIndex;</span><br><span class="line">    &#125;,</span><br><span class="line">    //获取列表项的当前尺寸</span><br><span class="line">    updateItemsSize() &#123;</span><br><span class="line">      let nodes = this.$refs.items;</span><br><span class="line">      nodes.forEach((node) =&gt; &#123;</span><br><span class="line">        let rect = node.getBoundingClientRect();</span><br><span class="line">        let height = rect.height;</span><br><span class="line">        let index = +node.id.slice(1);</span><br><span class="line">        let oldHeight = this.positions[index].height;</span><br><span class="line">        let dValue = oldHeight - height;</span><br><span class="line">        //存在差值</span><br><span class="line">        if (dValue) &#123;</span><br><span class="line">          this.positions[index].bottom = this.positions[index].bottom - dValue;</span><br><span class="line">          this.positions[index].height = height;</span><br><span class="line"></span><br><span class="line">          for (let k = index + 1; k &lt; this.positions.length; k++) &#123;</span><br><span class="line">            this.positions[k].top = this.positions[k - 1].bottom;</span><br><span class="line">            this.positions[k].bottom = this.positions[k].bottom - dValue;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    //获取当前的偏移量</span><br><span class="line">    setStartOffset() &#123;</span><br><span class="line">      let startOffset = this.start &gt;= 1 ? this.positions[this.start - 1].bottom : 0;</span><br><span class="line">      this.$refs.content.style.transform = `translate3d(0,$&#123;startOffset&#125;px,0)`;</span><br><span class="line">    &#125;,</span><br><span class="line">    //滚动事件</span><br><span class="line">    scrollEvent() &#123;</span><br><span class="line">      //当前滚动位置</span><br><span class="line">      let scrollTop = this.$refs.list.scrollTop;</span><br><span class="line">      //此时的开始索引</span><br><span class="line">      this.start = this.getStartIndex(scrollTop);</span><br><span class="line">      //此时的结束索引</span><br><span class="line">      this.end = this.start + this.visibleCount;</span><br><span class="line">      //此时的偏移量</span><br><span class="line">      this.setStartOffset();</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.infinite-list-container &#123;</span><br><span class="line">  overflow: auto;</span><br><span class="line">  position: relative;</span><br><span class="line">  -webkit-overflow-scrolling: touch;</span><br><span class="line">&#125;</span><br><span class="line">.infinite-list-phantom &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  z-index: -1;</span><br><span class="line">&#125;</span><br><span class="line">.infinite-list &#123;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  top: 0;</span><br><span class="line">  position: absolute;</span><br><span class="line">&#125;</span><br><span class="line">.infinite-list-item &#123;</span><br><span class="line">  padding: 5px;</span><br><span class="line">  color: #555;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  border-bottom: 1px solid #999;</span><br><span class="line">  /* height:200px; */</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>不足与改进</strong></p>
<ul>
<li>监听scroll事件，会频繁触发，重复计算，性能上浪费，可使用<a href="https://link.juejin.cn/?target=https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver">IntersectionObserver</a>替换监听scroll事件</li>
<li>动态高度下的虚拟列表，如果是图片，可能由于网络请求加载时机导致高度不准确，如果我们能监听列表项的大小变化就能获取其真正的高度了。我们可以使用<a href="https://link.juejin.cn/?target=https://developer.mozilla.org/zh-CN/docs/Web/API/ResizeObserver">ResizeObserver</a>来监听列表项内容区域的高度改变，从而实时获取每一列表项的高度。</li>
</ul>
<h3 id="方案7-第三方库"><a href="#方案7-第三方库" class="headerlink" title="方案7:第三方库"></a>方案7:第三方库</h3><ul>
<li><a href="https://link.juejin.cn/?target=https://github.com/Akryum/vue-virtual-scroller">vue-virtual-scroller</a>: 这是一个基于 Vue 3 的虚拟滚动列表组件，可以用于大型数据集的渲染。它支持水平和垂直方向的滚动，并且具有无限滚动、缓存、动态高度等功能。</li>
<li><a href="https://link.juejin.cn/?target=https://github.com/zuolei828/vue3-virtual-scroll-list">vue3-virtual-scroll-list</a>: 这是一个支持垂直方向的无限滚动列表组件，可以用于渲染大量数据。它支持异步加载、滚动到指定位置、动态高度等功能。</li>
<li><a href="https://link.juejin.cn/?target=https://github.com/DevTony101/vue3-infinite-scroll">vue3-infinite-scroll</a>: 这是一个支持无限滚动的 Vue 3 组件，可以用于渲染大量数据。它支持异步加载、滚动到指定位置、动态高度等功能。</li>
<li><a href="https://link.juejin.cn/?target=https://github.com/yeyan1996/vue-lazy-render">vue-lazy-render</a>: 这是一个基于 Vue 3 的懒加载组件，可以用于渲染大量数据。它支持滚动监听、动态高度、动画效果等功能。</li>
</ul>
<h1 id="接单项目"><a href="#接单项目" class="headerlink" title="接单项目"></a><strong>接单项目</strong></h1><p>1.接单网站</p>
<p>猿急送：按需雇佣互联网坐班兼职工程师</p>
<p>外包大师：快速发布外包项目，以高质量为驱动</p>
<p>开源众包：为客户提供解决方案</p>
<p>英选：可信赖的软件外包服务</p>
<p>人人开发：让管理软件更简单</p>
<p>我爱方案网：</p>
<p>智筹：牛人为我所用</p>
<p>开发邦：服务众多客户</p>
<p>码市：互联网软件外包服务平台</p>
<p>自由职客：</p>
<p>解放号：数字化平台</p>
<p>程序员客栈：云端开发团队</p>
<p>任务栈：</p>
<p>猪八戒：</p>
<p>一品威客：</p>
<p>SXSOFT:众包模式</p>
<p>智诚Taskcity:零交易佣金</p>
<p>码易：</p>
<p>yespmp:</p>
<p>云沃克：</p>
<p>实现网：</p>
<p>电鸭社区：</p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://fuyunjinglong.github.io/2021/11/08/Z_%E4%B8%9A%E5%8A%A1%E5%92%8C%E9%9D%A2%E7%BB%8F_%E9%A1%B9%E7%9B%AE%E7%BB%8F%E9%AA%8C/" title="项目经验" target="_blank" rel="external">https://fuyunjinglong.github.io/2021/11/08/Z_业务和面经_项目经验/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://fuyunjinglong.github.io/" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://fuyunjinglong.github.io/" target="_blank"><span class="text-dark">Elven</span><small class="ml-1x">Web Developer &amp; Designer</small></a></h3>
        <div>个人简介。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2022/04/03/D_%E6%A1%86%E6%9E%B6_NodeJS%E5%85%A5%E9%97%A8/" title="NodeJS入门"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/11/06/H_%E5%B7%A5%E7%A8%8B%E7%83%AD%E7%82%B9_%E5%8D%9A%E5%AE%A2_Hexo/" title="博客_Hexo"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">    <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/fuyunjinglong" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://fuyunjinglong.github.io/" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/null" target="_blank" title="Twitter" data-toggle=tooltip data-placement=top><i class="icon icon-twitter"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
  <!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> -->
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: '',
    appKey: '',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>