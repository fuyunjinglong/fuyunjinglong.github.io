# CSS

## canvas ä¸ svg çš„åŒºåˆ« ï¼Ÿ

Canvasæ˜¯ä½¿ç”¨JavaScriptç¨‹åºç»˜å›¾(åŠ¨æ€ç”Ÿæˆ)ï¼ŒSVGæ˜¯ä½¿ç”¨XMLæ–‡æ¡£æè¿°æ¥ç»˜å›¾ã€‚

SVGæ˜¯åŸºäºçŸ¢é‡çš„ï¼Œæ‰€æœ‰å®ƒèƒ½å¤Ÿå¾ˆå¥½çš„å¤„ç†å›¾å½¢å¤§å°çš„æ”¹å˜ã€‚Canvasæ˜¯åŸºäºä½å›¾çš„å›¾åƒï¼Œå®ƒä¸èƒ½å¤Ÿæ”¹å˜å¤§å°ï¼Œåªèƒ½ç¼©æ”¾æ˜¾ç¤ºï¼›

å†å²å¯¹æ¯”

|      |            canvas             |              svg               |
| :--: | :---------------------------: | :----------------------------: |
| å†å² | è¾ƒæ–°ï¼Œç”±Appleç§æœ‰æŠ€æœ¯å‘å±•è€Œæ¥ |   å†å²æ‚ ä¹…,2003å¹´æˆä¸ºW3Cæ ‡å‡†   |
| åŠŸèƒ½ |      åŠŸèƒ½ç®€å•ï¼Œ2Dç»˜å›¾API      | åŠŸèƒ½ä¸°å¯Œï¼Œå„ç§å›¾å½¢ã€æ»¤é•œã€åŠ¨ç”» |
| ç‰¹ç‚¹ |       åƒç´ ,åªèƒ½è„šæœ¬é©±åŠ¨       |     çŸ¢é‡ï¼ŒXML,CSS,å…ƒç´ æ“ä½œ     |
| æ”¯æŒ |       ä¸»æµæµè§ˆå™¨ï¼ŒIE9+        | ä¸»æµæµè§ˆå™¨ï¼ŒIE9+,å…¶ä»–svgé˜…è¯»å™¨ |

æ€§èƒ½å¯¹æ¯”

|          |          canvas          |             svg              |
| :------: | :----------------------: | :--------------------------: |
| æ“ä½œå¯¹è±¡ |   åŸºäºåƒç´ (åŠ¨æ€ç‚¹é˜µå›¾)   |         åŸºäºå›¾å½¢å…ƒç´          |
|   å…ƒç´    |       å•ä¸ªHTMLå…ƒç´        | å¤šç§å›¾å½¢å…ƒç´ (Rect,Path,Line) |
|   é©±åŠ¨   |       åªèƒ½è„šæœ¬é©±åŠ¨       |        æ”¯æŒè„šæœ¬å’ŒCSS         |
| äº‹ä»¶äº¤äº’ |    äº¤äº’åˆ°åƒç´ ç‚¹(x,y)     |  äº¤äº’åˆ°å›¾å½¢å…ƒç´ (rect,path)   |
|   æ€§èƒ½   | é€‚åˆå°é¢ç§¯ï¼Œå¤§æ•°é‡çš„åœºæ™¯ |   é€‚åˆå¤§é¢ç§¯ï¼Œå°æ•°é‡çš„åœºæ™¯   |



## é‡è®¾æ ·å¼

ä½¿ç”¨çš„æ˜¯Yahoo(YUI) çš„reset.css

```
body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre, 
form,fieldset,input,textarea,p,blockquote,th,td { 
    padding: 0; 
    margin: 0; 
} 
table { 
    border-collapse: collapse; 
    border-spacing: 0; 
} 
fieldset,img { 
    border: 0; 
} 
address,caption,cite,code,dfn,em,strong,th,var { 
    font-weight: normal; 
    font-style: normal; 
} 
ol,ul { 
    list-style: none; 
} 
caption,th { 
    text-align: left; 
} 
h1,h2,h3,h4,h5,h6 { 
    font-weight: normal; 
    font-size: 100%; 
} 
q:before,q:after { 
    content:â€; 
} 
abbr,acronym { 
    border: 0; 
}
```



# Htmlè¯­ä¹‰åŒ–

å‚è€ƒ

- [å¼€å¯å‰ç«¯ä¹‹è·¯â€”â€”HTML æ ‡ç­¾](https://powerdong.github.io/myBlog/2019/04/25/HTML-%E6%A0%87%E7%AD%BE/)

## ä»€ä¹ˆæ˜¯è¯­ä¹‰åŒ–

è¯­ä¹‰åŒ–æ˜¯æŒ‡æ ¹æ®å†…å®¹çš„ç»“æ„åŒ–(å†…å®¹è¯­ä¹‰åŒ–),é€‰æ‹©åˆé€‚çš„æ ‡ç­¾(ä»£ç è¯­ä¹‰åŒ–),ä¾¿äºå¼€å‘è€…é˜…è¯»å’Œå†™å‡ºæ›´ä¼˜é›…çš„ä»£ç çš„åŒæ—¶,è®©æµè§ˆå™¨çš„çˆ¬è™«å’Œæœºå™¨å¾ˆå¥½åœ°è§£æã€‚

## ä¸ºä»€ä¹ˆè¦è¯­ä¹‰åŒ–?

- æœ‰åˆ©äº **SEO(æœç´¢å¼•æ“ä¼˜åŒ–(Search Engine Optimization))**,æœ‰åŠ©äºçˆ¬è™«çˆ¬å–æ›´å¤šæœ‰æ•ˆçš„ä¿¡æ¯,çˆ¬è™«æ˜¯ä¾èµ–äºæ ‡ç­¾æ¥ç¡®å®šä¸Šä¸‹æ–‡å’Œå„ä¸ªå…³é”®å­—çš„æƒé‡
- **è¯­ä¹‰åŒ–çš„ HTML åœ¨æ²¡æœ‰ CSS çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å‘ˆç°è¾ƒå¥½çš„å†…å®¹ç»“æ„å’Œä»£ç ç»“æ„**
- æ–¹ä¾¿å…¶ä»–è®¾å¤‡çš„è§£æ
- ä¾¿äºå›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤

## æ˜“æ··æ·†çš„HTMLæ ‡ç­¾

- i æ ‡ç­¾

*i æ ‡ç­¾æ•ˆæœ*,i æ ‡ç­¾é€šå¸¸è¡¨ç¤ºå› ä¸ºæŸç§åŸå› å’Œæ­£å¸¸æ–‡æœ¬ä¸åŒçš„æ–‡æœ¬,ä¾‹å¦‚ä¸“ä¸šæœ¯è¯­,å¤–è¯­çŸ­è¯­æˆ–æ’ç‰ˆç”¨çš„æ–‡å­—ã€‚é€šå¸¸è¡¨ç°ä¸ºæ–œä½“ã€‚

- em æ ‡ç­¾

*em æ ‡ç­¾æ•ˆæœ*,em è¡¨ç¤ºå¼ºè°ƒçš„æ–‡æœ¬,è§†è§‰ä¸Šä¹Ÿæ˜¯æ–œä½“æ•ˆæœã€‚

- strong æ ‡ç­¾

**strong æ•ˆæœ**,ä»¥åŠ ç²—çš„å½¢å¼å±•ç°ã€‚è¡¨ç¤ºè¿™ä¸ªæ–‡æœ¬çš„é‡è¦æ€§,åœ¨ HTMl4 ä¸­è¡¨ç¤ºç‰¹åˆ«å¼ºè°ƒ,HTML5 ä¸­æè¿°ä¸ºâ€œstrong importance for its contentsâ€ã€‚

- b æ ‡ç­¾

**b æ ‡ç­¾æ•ˆæœ**,è¡¨ç¤ºçš„é£æ ¼ä¸åŒäºæ­£å¸¸çš„æ–‡æœ¬,æ²¡æœ‰è¡¨è¾¾ä»»ä½•ç‰¹æ®Šçš„é‡è¦æ€§å’Œç›¸å…³æ€§ã€‚é€šå¸¸ç”¨äºå…³é”®å›é¡¾,å›é¡¾ä¸­çš„äº§å“åç§°,æˆ–è€…æ˜¯å…¶ä»–éœ€è¦è¡¨ç°ä¸ºç²—ä½“çš„æ–‡æœ¬ã€‚å¦ä¸€ä¸ªä¾‹å­å°±æ˜¯æ ‡å¿—æ¯ä¸ªæ®µè½çš„ lead sentenceã€‚

- mark æ ‡ç­¾

mark æ ‡ç­¾æ•ˆæœ,è¡¨ç°ä¸ºé«˜äº®æ–‡æœ¬ã€‚ä¾‹å¦‚æˆ‘ä»¬åœ¨ç½‘é¡µæŸ¥æ‰¾å…³é”®å­—æ—¶,æ‰¾åˆ°çš„ç»“æœå°±ä¼šä»¥é«˜äº®çš„å½¢å¼å±•ç°ã€‚
mark å…ƒç´ é€šå¸¸æ˜¯è¡¨ç°è·¨è¶Šä¸åŒçš„ä¸Šä¸‹æ–‡ç§çš„ç›¸å…³æ–‡æœ¬ã€‚

## å¸¸è§çš„è¡Œ/å—çº§å…ƒç´ 

- inline è¡Œçº§å…ƒç´ 
  - å†…å®¹å†³å®šå…ƒç´ æ‰€å ä½ç½®
  - ä¸å¯ä»¥é€šè¿‡ Css æ”¹å˜å®½é«˜
  - éƒ½æœ‰æ–‡å­—ç‰¹æ€§
    - `<span>`ã€`<strong>`ã€`<em>`ã€`<a>`ã€`<del>`ã€`<i>`
- block å—çº§å…ƒç´ 
  - ç‹¬å ä¸€è¡Œ
  - å¯ä»¥é€šè¿‡ Css æ”¹å˜å®½é«˜
    - `<div>`ã€`<p>`ã€`<ul>`ã€`<li>`ã€`<ol>`ã€`<form>`
- inline-block è¡Œå—çº§å…ƒç´ 
  - å†…å®¹å†³å®šå¤§å°
  - å¯ä»¥æ”¹å˜å®½é«˜
    - `<img>`

## å†™ HTML ä»£ç æ³¨æ„ä»€ä¹ˆ

- å°½å¯èƒ½å°‘çš„ä½¿ç”¨æ— è¯­ä¹‰çš„æ ‡ç­¾ `<div>` å’Œ `<span>`
- åœ¨è¯­ä¹‰ä¸æ˜æ˜¾æ—¶æ—¢å¯ä»¥ä½¿ç”¨ `<div>` æˆ–è€… `<p>` æ—¶,å°½é‡ä½¿ç”¨ `<p>`,å› ä¸º `<p>` åœ¨é»˜è®¤æƒ…å†µä¸‹æœ‰ä¸Šä¸‹é—´è·,å¯¹å…¼å®¹ç‰¹æ®Šç»ˆç«¯æœ‰åˆ©
- ä¸è¦ä½¿ç”¨çº¯æ ·å¼æ ‡ç­¾,æ”¹ç”¨ css è®¾ç½®
- éœ€è¦å¼ºè°ƒçš„æ–‡æœ¬,å¯ä»¥åŒ…å«åœ¨ `<strong>` æˆ–è€… `<em>` æ ‡ç­¾ä¸­(æµè§ˆå™¨é¢„è®¾æ ·å¼,èƒ½ç”¨ css æŒ‡å®šå°±ä¸ç”¨ä»–ä»¬),`<strong>` é»˜è®¤æ ·å¼æ˜¯åŠ ç²—(ä¸è¦ç”¨ `<b>`),`<em>` æ˜¯æ–œä½“(ä¸ç”¨ `<i>`)
- ä½¿ç”¨è¡¨æ ¼æ—¶,æ ‡é¢˜è¦ç”¨ `caption`,è¡¨å¤´ç”¨ `<thead>`,ä¸»ä½“éƒ¨åˆ†ç”¨ `<tbody>` åŒ…å›´,å°¾éƒ¨ç”¨ `<tfoot>` åŒ…å›´ã€‚è¡¨å¤´å’Œä¸€èˆ¬å•å…ƒæ ¼è¦åŒºåˆ†å¼€,è¡¨å¤´ç”¨ `<th>`,å•å…ƒæ ¼ç”¨ `<td>`
- è¡¨å•åŸŸè¦ç”¨ `<fieldset>` æ ‡ç­¾åŒ…èµ·æ¥,å¹¶ç”¨ `<legend>` æ ‡ç­¾è¯´æ˜è¡¨å•çš„ç”¨é€”
- æ¯ä¸ª `<input>` æ ‡ç­¾å¯¹åº”çš„è¯´æ˜æ–‡æœ¬éƒ½éœ€è¦ä½¿ç”¨ `label` æ ‡ç­¾,å¹¶ä¸”é€šè¿‡ `<input>` æ ‡ç­¾è®¾ç½® id å±æ€§,åœ¨ `label` æ ‡ç­¾ä¸­è®¾ç½® for æ¥è®©è¯´æ˜æ–‡æœ¬å’Œç›¸å¯¹åº”çš„ `<input>` å…³è”èµ·æ¥ã€‚

# åå°ç»™ä½ 10wæ•°æ®

## å‰ç½®å·¥ä½œ

**åç«¯æ¨¡æ‹ŸæœåŠ¡**

æ–°å»ºä¸€ä¸ª`server.js`æ–‡ä»¶ï¼Œç®€å•èµ·ä¸ªæœåŠ¡ï¼Œå¹¶è¿”å›ç»™å‰ç«¯`10w`æ¡æ•°æ®ï¼Œå¹¶é€šè¿‡`nodemon server.js`å¼€å¯æœåŠ¡

> æ²¡æœ‰å®‰è£…`nodemon`çš„åŒå­¦å¯ä»¥å…ˆå…¨å±€å®‰è£…`npm i nodemon -g`

```
// server.js

const http = require('http')
const port = 8000;

http.createServer(function (req, res) {
  // å¼€å¯Cors
  res.writeHead(200, {
    //è®¾ç½®å…è®¸è·¨åŸŸçš„åŸŸåï¼Œä¹Ÿå¯è®¾ç½®*å…è®¸æ‰€æœ‰åŸŸå
    'Access-Control-Allow-Origin': '*',
    //è·¨åŸŸå…è®¸çš„è¯·æ±‚æ–¹æ³•ï¼Œä¹Ÿå¯è®¾ç½®*å…è®¸æ‰€æœ‰æ–¹æ³•
    "Access-Control-Allow-Methods": "DELETE,PUT,POST,GET,OPTIONS",
    //å…è®¸çš„headerç±»å‹
    'Access-Control-Allow-Headers': 'Content-Type'
  })
  let list = []
  let num = 0

  // ç”Ÿæˆ10ä¸‡æ¡æ•°æ®çš„list
  for (let i = 0; i < 100000; i++) {
    num++
    list.push({
      src: 'https://p3-passport.byteacctimg.com/img/user-avatar/d71c38d1682c543b33f8d716b3b734ca~300x300.image',
      text: `æˆ‘æ˜¯${num}å·å˜‰å®¾æ—ä¸‰å¿ƒ`,
      tid: num
    })
  }
  res.end(JSON.stringify(list));
}).listen(port, function () {
  console.log('server is listening on port ' + port);
})
```

**å‰ç«¯é¡µé¢**

```
// index.html
<style>
    * {
      padding: 0;
      margin: 0;
    }
    #container {
      height: 100vh;
      overflow: auto;
    }
    .sunshine {
      display: flex;
      padding: 10px;
    }
    img {
      width: 150px;
      height: 150px;
    }
  </style>

// htmléƒ¨åˆ†
<body>
  <div id="container">
  </div>
  <script src="./index.js"></script>
</body>
```

```
// index.js
// è¯·æ±‚å‡½æ•°
const getList = () => {
    return new Promise((resolve, reject) => {
        //æ­¥éª¤ä¸€:åˆ›å»ºå¼‚æ­¥å¯¹è±¡
        var ajax = new XMLHttpRequest();
        //æ­¥éª¤äºŒ:è®¾ç½®è¯·æ±‚çš„urlå‚æ•°,å‚æ•°ä¸€æ˜¯è¯·æ±‚çš„ç±»å‹,å‚æ•°äºŒæ˜¯è¯·æ±‚çš„url,å¯ä»¥å¸¦å‚æ•°
        ajax.open('get', 'http://127.0.0.1:8000');
        //æ­¥éª¤ä¸‰:å‘é€è¯·æ±‚
        ajax.send();
        //æ­¥éª¤å››:æ³¨å†Œäº‹ä»¶ onreadystatechange çŠ¶æ€æ”¹å˜å°±ä¼šè°ƒç”¨
        ajax.onreadystatechange = function () {
            if (ajax.readyState == 4 && ajax.status == 200) {
                //æ­¥éª¤äº” å¦‚æœèƒ½å¤Ÿè¿›åˆ°è¿™ä¸ªåˆ¤æ–­ è¯´æ˜ æ•°æ® å®Œç¾çš„å›æ¥äº†,å¹¶ä¸”è¯·æ±‚çš„é¡µé¢æ˜¯å­˜åœ¨çš„
                resolve(JSON.parse(ajax.responseText))
            }
        }
    })
}

// è·å–containerå¯¹è±¡
const container = document.getElementById('container')
```

## æ–¹æ¡ˆ1:ç›´æ¥æ¸²æŸ“

ä¸€æ¬¡æ€§æ¸²æŸ“å‡º`10w`ä¸ªèŠ‚ç‚¹,è€—æ—¶12sã€‚

```
const renderList = async () => {
    console.time('åˆ—è¡¨æ—¶é—´')
    const list = await getList()
    list.forEach(item => {
        const div = document.createElement('div')
        div.className = 'sunshine'
        div.innerHTML = `<img src="${item.src}" /><span>${item.text}</span>`
        container.appendChild(div)
    })
    console.timeEnd('åˆ—è¡¨æ—¶é—´')
}
renderList()
```

## æ–¹æ¡ˆ2:setTimeoutåˆ†é¡µæ¸²æŸ“

æŠŠ`10w`æŒ‰ç…§æ¯é¡µæ•°é‡`limit`åˆ†æˆæ€»å…±`Math.ceil(total / limit)`é¡µï¼Œç„¶ååˆ©ç”¨`setTimeout`ï¼Œæ¯æ¬¡æ¸²æŸ“1é¡µæ•°æ®ï¼Œè¿™æ ·çš„è¯ï¼Œæ¸²æŸ“å‡ºé¦–é¡µæ•°æ®çš„æ—¶é—´å¤§å¤§ç¼©å‡äº†ã€‚

```
const renderList = async () => {
    console.time('åˆ—è¡¨æ—¶é—´')
    const list = await getList()
    console.log(list)
    const total = list.length
    const page = 0
    const limit = 200
    const totalPage = Math.ceil(total / limit)

    const render = (page) => {
        if (page >= totalPage) return
        setTimeout(() => {
            for (let i = page * limit; i < page * limit + limit; i++) {
                const item = list[i]
                const div = document.createElement('div')
                div.className = 'sunshine'
                div.innerHTML = `<img src="${item.src}" /><span>${item.text}</span>`
                container.appendChild(div)
            }
            render(page + 1)
        }, 0)
    }
    render(page)
    console.timeEnd('åˆ—è¡¨æ—¶é—´')
}
```

## æ–¹æ¡ˆ3:requestAnimationFrame

ä½¿ç”¨`requestAnimationFrame`ä»£æ›¿`setTimeout`ï¼Œå‡å°‘äº†`é‡æ’`çš„æ¬¡æ•°ï¼Œæå¤§æé«˜äº†æ€§èƒ½ï¼Œå»ºè®®å¤§å®¶åœ¨æ¸²æŸ“æ–¹é¢å¤šä½¿ç”¨`requestAnimationFrame`ã€‚

```
const renderList = async () => {
    console.time('åˆ—è¡¨æ—¶é—´')
    const list = await getList()
    console.log(list)
    const total = list.length
    const page = 0
    const limit = 200
    const totalPage = Math.ceil(total / limit)

    const render = (page) => {
        if (page >= totalPage) return
        // ä½¿ç”¨requestAnimationFrameä»£æ›¿setTimeout
        requestAnimationFrame(() => {
            for (let i = page * limit; i < page * limit + limit; i++) {
                const item = list[i]
                const div = document.createElement('div')
                div.className = 'sunshine'
                div.innerHTML = `<img src="${item.src}" /><span>${item.text}</span>`
                container.appendChild(div)
            }
            render(page + 1)
        })
    }
    render(page)
    console.timeEnd('åˆ—è¡¨æ—¶é—´')
}
```

## æ–¹æ¡ˆ4:fragmentæ–‡æ¡£ç¢ç‰‡ + requestAnimationFrame

ä¼˜ç‚¹

> 1ã€ä¹‹å‰éƒ½æ˜¯æ¯æ¬¡åˆ›å»ºä¸€ä¸ª`div`æ ‡ç­¾å°±`appendChild`ä¸€æ¬¡ï¼Œä½†æ˜¯æœ‰äº†`æ–‡æ¡£ç¢ç‰‡`å¯ä»¥å…ˆæŠŠ1é¡µçš„`div`æ ‡ç­¾å…ˆæ”¾è¿›`æ–‡æ¡£ç¢ç‰‡`ä¸­ï¼Œç„¶åä¸€æ¬¡æ€§`appendChild`åˆ°`container`ä¸­ï¼Œè¿™æ ·å‡å°‘äº†`appendChild`çš„æ¬¡æ•°ï¼Œæå¤§æé«˜äº†æ€§èƒ½
>
> 2ã€é¡µé¢åªä¼šæ¸²æŸ“`æ–‡æ¡£ç¢ç‰‡`åŒ…è£¹ç€çš„å…ƒç´ ï¼Œè€Œä¸ä¼šæ¸²æŸ“`æ–‡æ¡£ç¢ç‰‡`

```
const renderList = async () => {
    console.time('åˆ—è¡¨æ—¶é—´')
    const list = await getList()
    console.log(list)
    const total = list.length
    const page = 0
    const limit = 200
    const totalPage = Math.ceil(total / limit)

    const render = (page) => {
        if (page >= totalPage) return
        requestAnimationFrame(() => {
            // åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ç¢ç‰‡
            const fragment = document.createDocumentFragment()
            for (let i = page * limit; i < page * limit + limit; i++) {
                const item = list[i]
                const div = document.createElement('div')
                div.className = 'sunshine'
                div.innerHTML = `<img src="${item.src}" /><span>${item.text}</span>`
                // å…ˆå¡è¿›æ–‡æ¡£ç¢ç‰‡
                fragment.appendChild(div)
            }
            // ä¸€æ¬¡æ€§appendChild
            container.appendChild(fragment)
            render(page + 1)
        })
    }
    render(page)
    console.timeEnd('åˆ—è¡¨æ—¶é—´')
}
```

## æ–¹æ¡ˆ5:æ‡’åŠ è½½

åŸç†

> åœ¨åˆ—è¡¨å°¾éƒ¨æ”¾ä¸€ä¸ªç©ºèŠ‚ç‚¹`blank`ï¼Œç„¶åå…ˆæ¸²æŸ“ç¬¬1é¡µæ•°æ®ï¼Œå‘ä¸Šæ»šåŠ¨ï¼Œç­‰åˆ°`blank`å‡ºç°åœ¨è§†å›¾ä¸­ï¼Œå°±è¯´æ˜åˆ°åº•äº†ï¼Œè¿™æ—¶å€™å†åŠ è½½ç¬¬äºŒé¡µï¼Œå¾€åä»¥æ­¤ç±»æ¨ã€‚
>
> è‡³äºæ€ä¹ˆåˆ¤æ–­`blank`å‡ºç°åœ¨è§†å›¾ä¸Šï¼Œå¯ä»¥ä½¿ç”¨`getBoundingClientRect`æ–¹æ³•è·å–`top`å±æ€§ã€‚
>
> å…¶ä¸­`IntersectionObserver` æ€§èƒ½æ›´å¥½ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œå°±æ‹¿`getBoundingClientRect`æ¥ä¸¾ä¾‹

æˆªå›¾ï¼šhttps://juejin.cn/post/7031923575044964389#heading-1

```vue
<script setup lang="ts">
import { onMounted, ref, computed } from 'vue'
const getList = () => {
  // è·Ÿä¸Šé¢ä¸€æ ·çš„ä»£ç 
}

const container = ref<HTMLElement>() // containerèŠ‚ç‚¹
const blank = ref<HTMLElement>() // blankèŠ‚ç‚¹
const list = ref<any>([]) // åˆ—è¡¨
const page = ref(1) // å½“å‰é¡µæ•°
const limit = 200 // ä¸€é¡µå±•ç¤º
// æœ€å¤§é¡µæ•°
const maxPage = computed(() => Math.ceil(list.value.length / limit))
// çœŸå®å±•ç¤ºçš„åˆ—è¡¨
const showList = computed(() => list.value.slice(0, page.value * limit))
const handleScroll = () => {
  // å½“å‰é¡µæ•°ä¸æœ€å¤§é¡µæ•°çš„æ¯”è¾ƒ
  if (page.value > maxPage.value) return
  const clientHeight = container.value?.clientHeight
  const blankTop = blank.value?.getBoundingClientRect().top
  if (clientHeight === blankTop) {
    // blankå‡ºç°åœ¨è§†å›¾ï¼Œåˆ™å½“å‰é¡µæ•°åŠ 1
    page.value++
  }
}

onMounted(async () => {
  const res = await getList()
  list.value = res
})
</script>

<template>
  <div id="container" @scroll="handleScroll" ref="container">
    <div class="sunshine" v-for="(item) in showList" :key="item.tid">
      <img :src="item.src" />
      <span>{{ item.text }}</span>
    </div>
    <div ref="blank"></div>
  </div>
</template>
```

## æ–¹æ¡ˆ6:è™šæ‹Ÿåˆ—è¡¨

å‚è€ƒ

- [ã€Œå‰ç«¯è¿›é˜¶ã€é«˜æ€§èƒ½æ¸²æŸ“åä¸‡æ¡æ•°æ®(è™šæ‹Ÿåˆ—è¡¨)](https://juejin.cn/post/6844903982742110216#heading-4)

åŸç†

> è™šæ‹Ÿæ»šåŠ¨ï¼Œå°±æ˜¯æ ¹æ®`å®¹å™¨å¯è§†åŒºåŸŸ`çš„`åˆ—è¡¨å®¹ç§¯æ•°é‡`ï¼Œç›‘å¬ç”¨æˆ·æ»‘åŠ¨æˆ–æ»šåŠ¨äº‹ä»¶ï¼ŒåŠ¨æ€æˆªå–`é•¿åˆ—è¡¨æ•°æ®`ä¸­çš„`éƒ¨åˆ†æ•°æ®`æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼ŒåŠ¨æ€ä½¿ç”¨ç©ºç™½ç«™ä½å¡«å……å®¹å™¨`ä¸Šä¸‹æ»šåŠ¨åŒºåŸŸå†…å®¹`ï¼Œæ¨¡æ‹Ÿå®ç°`åŸç”Ÿæ»šåŠ¨æ•ˆæœ`ã€‚æ€»ç»“ä¸€å¥è¯ï¼šä½¿ç”¨ç»å¯¹å®šä½å’Œæ»šåŠ¨ç›‘å¬å®ç°ã€‚

æˆªå›¾ï¼šhttps://juejin.cn/post/6966179727329460232

> - æµè§ˆå™¨æ¸²æŸ“===åº·ç†™é€‰ç§€ï¼šä¸€æ¬¡æ€§æ¸²æŸ“10000ä¸ªè‚¯å®šä¼šä½¿æµè§ˆå™¨å‹åŠ›å¤§ï¼Œé€ æˆç”¨æˆ·ä½“éªŒå·®
> - å®¹å™¨å¯è§†åŒºåŸŸ===é€‰ç§€å¤§æ®¿ï¼š10000ä¸ªæ’é˜Ÿå»æ¸²æŸ“ï¼Œæ¯”å¦‚ä¸€æ¬¡æ¸²æŸ“10ä¸ª
> - ä¸Šæ–¹ä¸‹æ–¹åŒºåŸŸ===å·¦å³åæ®¿ï¼šè½®ä¸åˆ°ä½ æ¸²æŸ“ï¼Œä½ å°±ä¹–ä¹–è¿›ç©ºç™½åŒºå¾…ç€

### åŸºæœ¬å®ç°è¿‡ç¨‹

> - æ­¥éª¤1:è®¡ç®—åˆ—è¡¨æ€»é«˜åº¦listHeightå’Œå¯è§†åŒºåŸŸé«˜åº¦screenHeight
> - æ­¥éª¤2:æ ¹æ®å¯è§†åŒºåŸŸé«˜åº¦è®¡ç®—å¯æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹æ•°visibleCount
> - æ­¥éª¤3:åœ¨æ»šåŠ¨æ—¶ï¼Œé‡æ–°è®¡ç®—èµ·å§‹ç´¢å¼•startå’Œç»“æŸç´¢å¼•endï¼Œæ ¸å¿ƒæ»šåŠ¨åç§»é‡startOffsetã€‚

### å›ºå®šé«˜åº¦ä»£ç 

```vue
<VirtualList :listData="d" :itemSize="100" />
let d = ref([]);
for (let i = 0; i < 1000; i++) {
  d.value.push({ id: i, value: i });
}
                         
// VirtualList.vue                       
<template>
  <div ref="list" class="infinite-list-container" @scroll="scrollEvent($event)">
    <div class="infinite-list-phantom" :style="{ height: listHeight + 'px' }"></div>
    <div class="infinite-list" :style="{ transform: getTransform }">
      <div ref="items" class="infinite-list-item" v-for="item in visibleData" :key="item.id" :style="{ height: itemSize + 'px', lineHeight: itemSize + 'px' }">{{ item.value }}</div>
    </div>
  </div>
</template>
<script>
export default {
  name: 'VirtualList',
  props: {
    //æ‰€æœ‰åˆ—è¡¨æ•°æ®
    listData: {
      type: Array,
      default: () => [],
    },
    //æ¯é¡¹é«˜åº¦
    itemSize: {
      type: Number,
      default: 200,
    },
  },
  data() {
    return {
      //å¯è§†åŒºåŸŸé«˜åº¦
      screenHeight: 0,
      //æ ¸å¿ƒæ»šåŠ¨åç§»é‡
      startOffset: 0,
      //èµ·å§‹ç´¢å¼•
      start: 0,
      //ç»“æŸç´¢å¼•
      end: null,
    };
  },
  computed: {
    //åˆ—è¡¨æ€»é«˜åº¦
    listHeight() {
      return this.listData.length * this.itemSize;
    },
    //å¯æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹æ•°
    visibleCount() {
      return Math.ceil(this.screenHeight / this.itemSize);
    },
    //åç§»é‡å¯¹åº”çš„style
    getTransform() {
      return `translate3d(0,${this.startOffset}px,0)`;
    },
    //è·å–çœŸå®æ˜¾ç¤ºåˆ—è¡¨æ•°æ®
    visibleData() {
      return this.listData.slice(this.start, Math.min(this.end, this.listData.length));
    },
  },
  mounted() {
    this.screenHeight = this.$el.clientHeight;
    this.start = 0;
    this.end = this.start + this.visibleCount;
  },
  methods: {
    scrollEvent() {
      //å½“å‰æ»šåŠ¨ä½ç½®
      let scrollTop = this.$refs.list.scrollTop;
      //æ­¤æ—¶çš„å¼€å§‹ç´¢å¼•
      this.start = Math.floor(scrollTop / this.itemSize);
      //æ­¤æ—¶çš„ç»“æŸç´¢å¼•
      this.end = this.start + this.visibleCount;
      //æ­¤æ—¶çš„åç§»é‡
      this.startOffset = scrollTop - (scrollTop % this.itemSize);
    },
  },
};
</script>
<style scoped>
.infinite-list-container {
  height: 100%;
  overflow: auto;
  position: relative;
  -webkit-overflow-scrolling: touch;
}
.infinite-list-phantom {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  z-index: -1;
}
.infinite-list {
  left: 0;
  right: 0;
  top: 0;
  position: absolute;
  text-align: center;
}
.infinite-list-item {
  padding: 10px;
  color: #555;
  box-sizing: border-box;
  border-bottom: 1px solid #999;
}
</style>
```

htmlå…ƒç´ 

- `infinite-list-container` ä¸º`å¯è§†åŒºåŸŸ`çš„å®¹å™¨
- `infinite-list-phantom` ä¸ºå®¹å™¨å†…çš„å ä½ï¼Œé«˜åº¦ä¸ºæ€»åˆ—è¡¨é«˜åº¦ï¼Œç”¨äºå½¢æˆæ»šåŠ¨æ¡
- `infinite-list` ä¸ºåˆ—è¡¨é¡¹çš„`æ¸²æŸ“åŒºåŸŸ`

å‚æ•°

- å‡å®š`å¯è§†åŒºåŸŸ`é«˜åº¦å›ºå®šï¼Œç§°ä¹‹ä¸º`screenHeight`
- å‡å®š`åˆ—è¡¨æ¯é¡¹`é«˜åº¦å›ºå®šï¼Œç§°ä¹‹ä¸º`itemSize`
- å‡å®š`åˆ—è¡¨æ•°æ®`ç§°ä¹‹ä¸º`listData`
- å‡å®š`å½“å‰æ»šåŠ¨ä½ç½®`ç§°ä¹‹ä¸º`scrollTop`

åˆ™å¯æ¨ç®—å‡ºï¼š

- åˆ—è¡¨æ€»é«˜åº¦`listHeight` = listData.length * itemSize
- å¯æ˜¾ç¤ºçš„åˆ—è¡¨é¡¹æ•°`visibleCount` = Math.ceil(screenHeight / itemSize)
- æ•°æ®çš„èµ·å§‹ç´¢å¼•`startIndex` = Math.floor(scrollTop / itemSize)
- æ•°æ®çš„ç»“æŸç´¢å¼•`endIndex` = startIndex + visibleCount
- åˆ—è¡¨æ˜¾ç¤ºæ•°æ®ä¸º`visibleData` = listData.slice(startIndex,endIndex)

**é‡è¦å‚æ•°**

å½“æ»šåŠ¨åï¼Œç”±äº`æ¸²æŸ“åŒºåŸŸ`ç›¸å¯¹äº`å¯è§†åŒºåŸŸ`å·²ç»å‘ç”Ÿäº†åç§»ï¼Œæ­¤æ—¶æˆ‘éœ€è¦è·å–ä¸€ä¸ªåç§»é‡`startOffset`ï¼Œé€šè¿‡æ ·å¼æ§åˆ¶å°†`æ¸²æŸ“åŒºåŸŸ`åç§»è‡³`å¯è§†åŒºåŸŸ`ä¸­ã€‚

> æ»šåŠ¨åç§»é‡`startOffset` = scrollTop - (scrollTop % itemSize);

ä¸ºä»€ä¹ˆä¸å†™æˆthis.startOffset = scrollTopï¼Ÿ

> é€šä¿—ç†è§£ï¼šå¦‚æœå†™æˆè¿™ä¸ªï¼Œæ•°æ®éƒ½æ˜¯å›ºå®šè·³å˜ï¼Œæ²¡æœ‰æ»šåŠ¨çš„åŠ¨ç”»å˜åŒ–æ•ˆæœã€‚
>
> å…·ä½“è§£é‡Šï¼š
>
> æ¯”å¦‚è¯´ï¼Œåˆ—è¡¨ç¬¬0é¡¹ï¼Œé«˜åº¦100pxï¼Œä½ ç°åœ¨æ»šåŠ¨æ¡æ»šåŠ¨äº†50pxï¼ŒæœŸæœ›çš„æ•ˆæœå¿…ç„¶æ˜¯ç¬¬0é¡¹ï¼Œä¸€åŠåœ¨å±å¹•å¤–ï¼Œä¸€åŠåœ¨å±å¹•å†…ï¼Œæ­¤æ—¶æ˜¯æ²¡æœ‰åç§»é‡çš„ï¼Œå®Œå…¨ç”±æ»šåŠ¨æ¡æ¥æ§åˆ¶é¡µé¢æ˜¾ç¤ºå†…å®¹ã€‚æ­¤æ—¶åˆå‘ç”Ÿäº†æ»šåŠ¨ï¼Œæ»šåŠ¨åˆ°äº†100pxï¼Œæ­¤æ—¶æˆ‘ä»¬æœŸæœ›çš„çš„ï¼šå¯è§†åŒºåŸŸå·²ç»æ²¡æœ‰ç¬¬0é¡¹äº†ï¼Œå˜æˆç¬¬1é¡¹ã€‚ç”±äºæˆ‘ä»¬æ˜¯è™šæ‹Ÿåˆ—è¡¨ï¼Œæ‰€ä»¥ç¬¬0é¡¹çš„domå‘ç”Ÿäº†ä¿®æ”¹å˜æˆäº†ç¬¬1é¡¹çš„domï¼Œç¬¬ä¸€é¡¹çš„domå˜æˆäº†ç¬¬2é¡¹domï¼Œå¦‚æœæ²¡æœ‰åç§»é‡ï¼Œå¯è§†åŒºåŸŸçš„ç¬¬ä¸€æ¡å†…å®¹å°±å˜æˆäº†ç¬¬2é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹åç§»é‡ï¼Œè®©åˆ—è¡¨åƒä¸‹åç§»100pxï¼Œå°†ç¬¬1é¡¹çš„domæ˜¾ç¤ºå‡ºæ¥ã€‚
>
> æ²¡æœ‰è¾¾åˆ°æ¢ä¸€ä¸ªitemçš„æ—¶å€™å°±è®¾ç½®æ²¡æœ‰åç§»é‡ è¿™ä¸ªscrollTop - (scrollTop % this.itemSize)å°±æ˜¯æ²¡è¾¾åˆ°ä¸€ä¸ªitemSizeçš„æ—¶å€™å°±æ˜¯å¤šä½™çš„å‡æ‰å¤šä½™çš„å˜æˆoè¿™ä¸ªå†…å®¹ä¼šè¢«æµè§ˆå™¨å¸¦ç€èµ° å°±ä¼šçœ‹åˆ°åŠ¨ç”» å¦‚æœä½ æœ‰è®¾ç½®ç­‰äºscrollTopçš„è¯ ä½ æµè§ˆå™¨æ»šåŠ¨äº† é‚£ä½ åç§»é‡å’ŒscrollTopä¸€æ ·çš„è¯ ç›¸å½“äºæ²¡æœ‰åŠ¨ç”» å’Œæµè§ˆå™¨åŒæ­¥èµ°äº† ç„¶ååˆ°äº†æ¢æ•°æ®item1å˜æˆitem2çš„æ—¶å€™å°±ä¼šçªç„¶ç»™ä½ æ¢æ‰ å°±æ²¡æœ‰åŠ¨ç”»äº† è¿™æ ·å†™å°±è®©æµè§ˆå™¨å¸¦ç€èµ°æœ‰åŠ¨ç”»

### åˆ—è¡¨é¡¹åŠ¨æ€é«˜åº¦ä»£ç 

å¯¹äºä¸æ˜¯å›ºå®šé«˜åº¦çš„åˆ—è¡¨ï¼Œä¸Šè¿°æ–¹æ¡ˆå°±ä¸èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

ç›®å‰è™šæ‹Ÿåˆ—è¡¨åŠ¨æ€é«˜åº¦çš„è§£å†³æ–¹æ¡ˆæœ‰3ç§ï¼š

- æ–¹æ¡ˆ1:åŒ…å«æ‰€æœ‰åˆ—è¡¨é¡¹é«˜åº¦çš„æ•°æ®ï¼Œå¦‚ [50, 20, 100, 80, ...]
- æ–¹æ¡ˆ2:å°†åˆ—è¡¨é¡¹`æ¸²æŸ“åˆ°å±å¹•å¤–`ï¼Œå¯¹å…¶é«˜åº¦è¿›è¡Œæµ‹é‡å¹¶ç¼“å­˜ï¼Œç„¶åå†å°†å…¶æ¸²æŸ“è‡³å¯è§†åŒºåŸŸå†…ã€‚
- æ–¹æ¡ˆ3:ä»¥`é¢„ä¼°é«˜åº¦`å…ˆè¡Œæ¸²æŸ“ï¼Œç„¶åè·å–çœŸå®é«˜åº¦å¹¶ç¼“å­˜ã€‚

> - æ–¹æ¡ˆ1è™½ç„¶çµæ´»ï¼Œä½†éœ€è¦äº‹å…ˆçŸ¥é“é«˜åº¦ï¼Œæ— æ³•è§£å†³åˆ—è¡¨é¡¹é«˜åº¦ç”±å†…å®¹æ’‘å¼€çš„æƒ…å†µ
> - æ–¹æ¡ˆ2:ç”±äºé¢„å…ˆæ¸²æŸ“è‡³å±å¹•å¤–ï¼Œå†æ¸²æŸ“è‡³å±å¹•å†…ï¼Œè¿™å¯¼è‡´æ¸²æŸ“æˆæœ¬å¢åŠ ä¸€å€ï¼Œè¿™å¯¹äºæ•°ç™¾ä¸‡ç”¨æˆ·åœ¨ä½ç«¯ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨çš„äº§å“æ¥è¯´æ˜¯ä¸åˆ‡å®é™…çš„ã€‚
> - æ–¹æ¡ˆ3:å¯ä»¥è§£å†³å‰é¢2ç§æ–¹æ¡ˆçš„ç¼ºé™·

å®ç°è¿‡ç¨‹

- å®šä¹‰ç»„ä»¶å±æ€§`estimatedItemSize`,ç”¨äºæ¥æ”¶`é¢„ä¼°é«˜åº¦`
- å®šä¹‰`positions`ï¼Œç”¨äºåˆ—è¡¨é¡¹æ¸²æŸ“åå­˜å‚¨`æ¯ä¸€é¡¹çš„é«˜åº¦ä»¥åŠä½ç½®`ä¿¡æ¯
- `åˆ—è¡¨é«˜åº¦`å®é™…å°±ç­‰äºåˆ—è¡¨ä¸­æœ€åä¸€é¡¹çš„åº•éƒ¨è·ç¦»åˆ—è¡¨é¡¶éƒ¨çš„ä½ç½®ã€‚

å®Œæ•´ä»£ç 

```vue
<VirtualList :listData="data" :estimatedItemSize="100" />
  import faker from "faker";
let data = [];
for (let id = 0; id < 1000; id++) {
  data.push({
    id,
    value: faker.lorem.sentences() // é•¿æ–‡æœ¬
  });
}
                           
// VirtualList.vue
<template>
  <div ref="list" :style="{ height }" class="infinite-list-container" @scroll="scrollEvent($event)">
    <div ref="phantom" class="infinite-list-phantom"></div>
    <div ref="content" class="infinite-list">
      <div class="infinite-list-item" ref="items" :id="item._index" :key="item._index" v-for="item in visibleData">
        <p>
          <span style="color: red">{{ item.id }}</span>
          {{ item.value }}
        </p>
      </div>
    </div>
  </div>
</template>
<script>
export default {
  props: {
    //æ‰€æœ‰åˆ—è¡¨æ•°æ®
    listData: {
      type: Array,
      default: () => [],
    },
    //é¢„ä¼°é«˜åº¦
    estimatedItemSize: {
      type: Number,
      required: true,
    },
    //å®¹å™¨é«˜åº¦ 100px or 50vh
    height: {
      type: String,
      default: '100%',
    },
  },
  data() {
    return {
      //å¯è§†åŒºåŸŸé«˜åº¦
      screenHeight: 0,
      //èµ·å§‹ç´¢å¼•
      start: 0,
      //ç»“æŸç´¢å¼•
      end: 0,
    };
  },
  computed: {
    _listData() {
      return this.listData.map((item, index) => {
        return {
          _index: `_${index}`,
          item,
        };
      });
    },
    visibleCount() {
      return Math.ceil(this.screenHeight / this.estimatedItemSize);
    },
    visibleData() {
      return this._listData.slice(this.start, this.end);
    },
  },
  created() {
    this.initPositions();
  },
  mounted() {
    this.screenHeight = this.$el.clientHeight;
    this.start = 0;
    this.end = this.start + this.visibleCount;
  },
  updated() {
    this.$nextTick(function () {
      if (!this.$refs.items || !this.$refs.items.length) {
        return;
      }
      //è·å–çœŸå®å…ƒç´ å¤§å°ï¼Œä¿®æ”¹å¯¹åº”çš„å°ºå¯¸ç¼“å­˜
      this.updateItemsSize();
      //æ›´æ–°åˆ—è¡¨æ€»é«˜åº¦
      let height = this.positions[this.positions.length - 1].bottom;
      this.$refs.phantom.style.height = height + 'px';
      //æ›´æ–°çœŸå®åç§»é‡
      this.setStartOffset();
    });
  },
  methods: {
    initPositions() {
      this.positions = this.listData.map((d, index) => ({
        index,
        height: this.estimatedItemSize,
        top: index * this.estimatedItemSize,
        bottom: (index + 1) * this.estimatedItemSize,
      }));
    },
    //è·å–åˆ—è¡¨èµ·å§‹ç´¢å¼•
    getStartIndex(scrollTop = 0) {
      //äºŒåˆ†æ³•æŸ¥æ‰¾
      return this.binarySearch(this.positions, scrollTop);
    },
    //äºŒåˆ†æ³•æŸ¥æ‰¾
    binarySearch(list, value) {
      let start = 0;
      let end = list.length - 1;
      let tempIndex = null;
      while (start <= end) {
        let midIndex = parseInt((start + end) / 2);
        let midValue = list[midIndex].bottom;
        if (midValue === value) {
          return midIndex + 1;
        } else if (midValue < value) {
          start = midIndex + 1;
        } else if (midValue > value) {
          if (tempIndex === null || tempIndex > midIndex) {
            tempIndex = midIndex;
          }
          end = end - 1;
        }
      }
      return tempIndex;
    },
    //è·å–åˆ—è¡¨é¡¹çš„å½“å‰å°ºå¯¸
    updateItemsSize() {
      let nodes = this.$refs.items;
      nodes.forEach((node) => {
        let rect = node.getBoundingClientRect();
        let height = rect.height;
        let index = +node.id.slice(1);
        let oldHeight = this.positions[index].height;
        let dValue = oldHeight - height;
        //å­˜åœ¨å·®å€¼
        if (dValue) {
          this.positions[index].bottom = this.positions[index].bottom - dValue;
          this.positions[index].height = height;

          for (let k = index + 1; k < this.positions.length; k++) {
            this.positions[k].top = this.positions[k - 1].bottom;
            this.positions[k].bottom = this.positions[k].bottom - dValue;
          }
        }
      });
    },
    //è·å–å½“å‰çš„åç§»é‡
    setStartOffset() {
      let startOffset = this.start >= 1 ? this.positions[this.start - 1].bottom : 0;
      this.$refs.content.style.transform = `translate3d(0,${startOffset}px,0)`;
    },
    //æ»šåŠ¨äº‹ä»¶
    scrollEvent() {
      //å½“å‰æ»šåŠ¨ä½ç½®
      let scrollTop = this.$refs.list.scrollTop;
      //æ­¤æ—¶çš„å¼€å§‹ç´¢å¼•
      this.start = this.getStartIndex(scrollTop);
      //æ­¤æ—¶çš„ç»“æŸç´¢å¼•
      this.end = this.start + this.visibleCount;
      //æ­¤æ—¶çš„åç§»é‡
      this.setStartOffset();
    },
  },
};
</script>
<style scoped>
.infinite-list-container {
  overflow: auto;
  position: relative;
  -webkit-overflow-scrolling: touch;
}
.infinite-list-phantom {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  z-index: -1;
}
.infinite-list {
  left: 0;
  right: 0;
  top: 0;
  position: absolute;
}
.infinite-list-item {
  padding: 5px;
  color: #555;
  box-sizing: border-box;
  border-bottom: 1px solid #999;
  /* height:200px; */
}
</style>
```

### ä¸è¶³ä¸æ”¹è¿›

- ç›‘å¬scrolläº‹ä»¶ï¼Œä¼šé¢‘ç¹è§¦å‘ï¼Œé‡å¤è®¡ç®—ï¼Œæ€§èƒ½ä¸Šæµªè´¹ï¼Œå¯ä½¿ç”¨[IntersectionObserver](https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FIntersectionObserver)æ›¿æ¢ç›‘å¬scrolläº‹ä»¶
- åŠ¨æ€é«˜åº¦ä¸‹çš„è™šæ‹Ÿåˆ—è¡¨ï¼Œå¦‚æœæ˜¯å›¾ç‰‡ï¼Œå¯èƒ½ç”±äºç½‘ç»œè¯·æ±‚åŠ è½½æ—¶æœºå¯¼è‡´é«˜åº¦ä¸å‡†ç¡®ï¼Œå¦‚æœæˆ‘ä»¬èƒ½ç›‘å¬åˆ—è¡¨é¡¹çš„å¤§å°å˜åŒ–å°±èƒ½è·å–å…¶çœŸæ­£çš„é«˜åº¦äº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[ResizeObserver](https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FResizeObserver)æ¥ç›‘å¬åˆ—è¡¨é¡¹å†…å®¹åŒºåŸŸçš„é«˜åº¦æ”¹å˜ï¼Œä»è€Œå®æ—¶è·å–æ¯ä¸€åˆ—è¡¨é¡¹çš„é«˜åº¦ã€‚

## æ–¹æ¡ˆ7:ç¬¬ä¸‰æ–¹åº“

- [vue-virtual-scroller](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAkryum%2Fvue-virtual-scroller): è¿™æ˜¯ä¸€ä¸ªåŸºäº Vue 3 çš„è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨ç»„ä»¶ï¼Œå¯ä»¥ç”¨äºå¤§å‹æ•°æ®é›†çš„æ¸²æŸ“ã€‚å®ƒæ”¯æŒæ°´å¹³å’Œå‚ç›´æ–¹å‘çš„æ»šåŠ¨ï¼Œå¹¶ä¸”å…·æœ‰æ— é™æ»šåŠ¨ã€ç¼“å­˜ã€åŠ¨æ€é«˜åº¦ç­‰åŠŸèƒ½ã€‚
- [vue3-virtual-scroll-list](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzuolei828%2Fvue3-virtual-scroll-list): è¿™æ˜¯ä¸€ä¸ªæ”¯æŒå‚ç›´æ–¹å‘çš„æ— é™æ»šåŠ¨åˆ—è¡¨ç»„ä»¶ï¼Œå¯ä»¥ç”¨äºæ¸²æŸ“å¤§é‡æ•°æ®ã€‚å®ƒæ”¯æŒå¼‚æ­¥åŠ è½½ã€æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ã€åŠ¨æ€é«˜åº¦ç­‰åŠŸèƒ½ã€‚
- [vue3-infinite-scroll](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDevTony101%2Fvue3-infinite-scroll): è¿™æ˜¯ä¸€ä¸ªæ”¯æŒæ— é™æ»šåŠ¨çš„ Vue 3 ç»„ä»¶ï¼Œå¯ä»¥ç”¨äºæ¸²æŸ“å¤§é‡æ•°æ®ã€‚å®ƒæ”¯æŒå¼‚æ­¥åŠ è½½ã€æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ã€åŠ¨æ€é«˜åº¦ç­‰åŠŸèƒ½ã€‚
- [vue-lazy-render](https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyeyan1996%2Fvue-lazy-render): è¿™æ˜¯ä¸€ä¸ªåŸºäº Vue 3 çš„æ‡’åŠ è½½ç»„ä»¶ï¼Œå¯ä»¥ç”¨äºæ¸²æŸ“å¤§é‡æ•°æ®ã€‚å®ƒæ”¯æŒæ»šåŠ¨ç›‘å¬ã€åŠ¨æ€é«˜åº¦ã€åŠ¨ç”»æ•ˆæœç­‰åŠŸèƒ½ã€‚

# å‰ç«¯æ¨¡å—åŒ–

å‚è€ƒ

- [å‰ç«¯æ¨¡å—åŒ–è¯¦è§£(å®Œæ•´ç‰ˆ)](https://juejin.cn/post/6844903744518389768#heading-2)

## æ¨¡å—åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ

- æŒ‰ç…§ä¸€å®šçš„è§„åˆ™(è§„èŒƒ)å°è£…æˆå‡ ä¸ªå—(æ–‡ä»¶), å¹¶è‡ªç”±ç»„åˆåœ¨ä¸€èµ·
- å¯¹å†…æ•°æ®å°è£…ï¼Œå¯¹å¤–æš´éœ²æ¥å£

## æ¨¡å—åŒ–è¿›åŒ–è¿‡ç¨‹

**å…¨å±€functionæ¨¡å¼** 

 å°†ä¸åŒçš„åŠŸèƒ½å°è£…æˆä¸åŒçš„å…¨å±€å‡½æ•°

- ç¼–ç : å°†ä¸åŒçš„åŠŸèƒ½å°è£…æˆä¸åŒçš„å…¨å±€å‡½æ•°
- é—®é¢˜: æ±¡æŸ“å…¨å±€å‘½åç©ºé—´, å®¹æ˜“å¼•èµ·å‘½åå†²çªæˆ–æ•°æ®ä¸å®‰å…¨ï¼Œè€Œä¸”æ¨¡å—æˆå‘˜ä¹‹é—´çœ‹ä¸å‡ºç›´æ¥å…³ç³»

**namespaceæ¨¡å¼** 

ç®€å•å¯¹è±¡å°è£…

- ä½œç”¨: å‡å°‘äº†å…¨å±€å˜é‡ï¼Œè§£å†³å‘½åå†²çª
- é—®é¢˜: æ•°æ®ä¸å®‰å…¨(å¤–éƒ¨å¯ä»¥ç›´æ¥ä¿®æ”¹æ¨¡å—å†…éƒ¨çš„æ•°æ®)

```
let myModule = {
  data: 'www.baidu.com',
  foo() {
    console.log(`foo() ${this.data}`)
  },
  bar() {
    console.log(`bar() ${this.data}`)
  }
}
myModule.data = 'other data' //èƒ½ç›´æ¥ä¿®æ”¹æ¨¡å—å†…éƒ¨çš„æ•°æ®
myModule.foo() // foo() other data
```

**IIFEæ¨¡å¼**

åŒ¿åå‡½æ•°è‡ªè°ƒç”¨(é—­åŒ…)

- ä½œç”¨: æ•°æ®æ˜¯ç§æœ‰çš„, å¤–éƒ¨åªèƒ½é€šè¿‡æš´éœ²çš„æ–¹æ³•æ“ä½œ
- ç¼–ç : å°†æ•°æ®å’Œè¡Œä¸ºå°è£…åˆ°ä¸€ä¸ªå‡½æ•°å†…éƒ¨, é€šè¿‡ç»™windowæ·»åŠ å±æ€§æ¥å‘å¤–æš´éœ²æ¥å£
- é—®é¢˜: å¦‚æœå½“å‰è¿™ä¸ªæ¨¡å—ä¾èµ–å¦ä¸€ä¸ªæ¨¡å—æ€ä¹ˆåŠ?

```
// index.htmlæ–‡ä»¶
<script type="text/javascript" src="module.js"></script>
<script type="text/javascript">
    myModule.data = 'xxxx' //ä¸æ˜¯ä¿®æ”¹çš„æ¨¡å—å†…éƒ¨çš„data
    myModule.foo() //æ²¡æœ‰æ”¹å˜
</script>

// module.jsæ–‡ä»¶
(function(window) {
  let data = 'www.baidu.com'
  //æ“ä½œæ•°æ®çš„å‡½æ•°
  function foo() {
    //ç”¨äºæš´éœ²æœ‰å‡½æ•°
    console.log(`foo() ${data}`)
  }
  function bar() {
    //ç”¨äºæš´éœ²æœ‰å‡½æ•°
    console.log(`bar() ${data}`)
    otherFun() //å†…éƒ¨è°ƒç”¨
  }
  function otherFun() {
    //å†…éƒ¨ç§æœ‰çš„å‡½æ•°
    console.log('otherFun()')
  }
  //æš´éœ²è¡Œä¸º
  window.myModule = { foo, bar } //ES6å†™æ³•
})(window)
```

**IIFEæ¨¡å¼å¢å¼º** 

 å¼•å…¥ä¾èµ–,è¿™å°±æ˜¯ç°ä»£æ¨¡å—å®ç°çš„åŸºçŸ³ã€‚**è¿™æ ·åšé™¤äº†ä¿è¯æ¨¡å—çš„ç‹¬ç«‹æ€§ï¼Œè¿˜ä½¿å¾—æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å˜å¾—æ˜æ˜¾**ã€‚

```
// module.jsæ–‡ä»¶
(function(window, $) {
  let data = 'www.baidu.com'
  //æ“ä½œæ•°æ®çš„å‡½æ•°
  function foo() {
    //ç”¨äºæš´éœ²æœ‰å‡½æ•°
    console.log(`foo() ${data}`)
    $('body').css('background', 'red')
  }
  function bar() {
    //ç”¨äºæš´éœ²æœ‰å‡½æ•°
    console.log(`bar() ${data}`)
    otherFun() //å†…éƒ¨è°ƒç”¨
  }
  function otherFun() {
    //å†…éƒ¨ç§æœ‰çš„å‡½æ•°
    console.log('otherFun()')
  }
  //æš´éœ²è¡Œä¸º
  window.myModule = { foo, bar }
})(window, jQuery)
```



# ES6

## newä¸€ä¸ªå¯¹è±¡å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

å››ä»¶äº‹ï¼š

1.åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡

2.æŠŠè¯¥å¯¹è±¡çš„`__proto__`å±æ€§æŒ‡å‘`Sub.prototype`

3.è®©æ„é€ å‡½æ•°é‡Œçš„`this`æŒ‡å‘æ–°å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œæ„é€ å‡½æ•°ï¼Œ

4.è¿”å›è¯¥å¯¹è±¡

## ES5å’ŒES6ä¹‹ç»§æ‰¿çš„åŒºåˆ« ï¼Ÿ

- ES5çš„ç»§æ‰¿é€šè¿‡å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ¥å®ç°ã€‚`ES5 çš„ç»§æ‰¿å®è´¨ä¸Šæ˜¯å…ˆåˆ›å»ºå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°thisä¸Šï¼ˆParent.apply(this)ï¼‰`ã€‚
- `ES6 çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨ä¸Šæ˜¯å…ˆåˆ›å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„ super()æ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹ this`ã€‚

**ES5 å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿**

ES5çš„ç»§æ‰¿ï¼Œå®è´¨ä¸Šæ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°å­ç±»ï¼ˆthisï¼‰ä¸Šé¢ã€‚

æ‰€ä»¥ï¼Œ

> **es5çš„å†™æ³•ä¸èƒ½ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°**ï¼ˆæ¯”å¦‚Arrayã€Numberç­‰ï¼‰ å› ä¸ºes5çš„ç»§æ‰¿æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œå†å°†çˆ¶ç±»åŸå‹çš„å±æ€§å’Œæ–¹æ³•é‡å†™åˆ°å­ç±»ä¸Šï¼Œå› ä¸ºæ²¡æ³•è®¿é—®çˆ¶ç±»çš„å†…éƒ¨å±æ€§ï¼Œå¯¼è‡´**es5çš„ç»§æ‰¿æ–¹å¼æ— æ³•ç»§åŸç”Ÿçš„æ„é€ å‡½æ•°**ã€‚

æˆªå›¾ï¼šhttps://cloud.tencent.com/developer/article/1865384

**ES6 extendç»§æ‰¿**

å‚è€ƒ

- [å»–é›ªå³°çš„åŸå‹ç»§æ‰¿](https://www.liaoxuefeng.com/wiki/1022910821149312/1023021997355072)
- [ES6ç±»ä»¥åŠç»§æ‰¿çš„å®ç°åŸç†](https://segmentfault.com/a/1190000014798678)
- [ES6ä¸‹babelå¦‚ä½•ç¼–è¯‘Class](https://www.aligoogle.net/pages/25e63f/#%E4%BA%94-babel-%E7%BC%96%E8%AF%91)

ES6çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨ä¸Šæ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œå¹¶å°†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•æ”¾åˆ°thisä¸Šï¼ˆå‰ææ˜¯é€šè¿‡superå‡½æ•°è°ƒç”¨ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹thisã€‚

æ‰€ä»¥ï¼Œ

>  es6å…è®¸ç»§æ‰¿æ„é€ å‡½æ•°ç”Ÿæˆå­ç±»ã€‚å› ä¸ºes6æ˜¯å…ˆåˆ›å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®é¥°ï¼Œæ‰€ä»¥å­ç±»å°±å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚å› æ­¤**classå¯ä»¥ç»§æ‰¿å¹¶è‡ªå®šä¹‰åŸç”Ÿæ„é€ å‡½æ•°çš„å­ç±»**ã€‚extendsä¸ä»…å¯ä»¥ç”¨æ¥ç»§æ‰¿ç±»ï¼Œè¿˜èƒ½ç”¨æ¥ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°ï¼Œå› æ­¤ä¹Ÿå°±å¯ä»¥åœ¨åŸç”Ÿæ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œæ„é€ è‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ã€‚

æˆªå›¾ï¼šhttps://cloud.tencent.com/developer/article/1865384

**ES6ç»§æ‰¿æ ¸å¿ƒæºç **

bableç¼–è¯‘Classæ–‡ä»¶åçš„ä»£ç ï¼š

```
var Child = function(_Parent) {
    _inherits(Child, _Parent);// æ ¸å¿ƒ
    function Child(name, age) {
        _classCallCheck(this, Child);
        // è°ƒç”¨çˆ¶ç±»çš„ constructor(name)
        var _this = _possibleConstructorReturn(this, (Child.__proto__ || Object.getPrototypeOf(Child)).call(this, name));
        _this.age = age;
        return _this;
    }

    return Child;
}(Parent);
```

å…¶ä¸­æ ¸å¿ƒæ˜¯_inheritsï¼š

```
function _inherits(subClass, superClass) {
    // extend çš„ç»§æ‰¿ç›®æ ‡å¿…é¡»æ˜¯å‡½æ•°æˆ–è€…æ˜¯ null
    if (typeof superClass !== "function" && superClass !== null) {
        throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
    }
    // ä»£ç 1ï¼Œç±»ä¼¼äº ES5 çš„å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œä½¿ç”¨ Object.createï¼Œè®¾ç½®å­ç±» prototype å±æ€§çš„ __proto__ å±æ€§æŒ‡å‘çˆ¶ç±»çš„ prototype å±æ€§
    subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });

    // ä»£ç 2ï¼Œè®¾ç½®å­ç±»çš„ __proto__ å±æ€§æŒ‡å‘çˆ¶ç±»
    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
}
```

_inheritsé€šä¿—ç†è§£ï¼š

- ä»£ç 1ï¼šä¿è¯äº†`c instanceof Parent`æ˜¯true,Childçš„å®ä¾‹å¯ä»¥è®¿é—®åˆ°çˆ¶ç±»çš„å±æ€§ï¼ŒåŒ…æ‹¬å†…éƒ¨å±æ€§ï¼Œä»¥åŠåŸå‹å±æ€§ã€‚æˆªå›¾ï¼šhttps://segmentfault.com/a/1190000014798678
- ä»£ç 2ï¼šå­ç±»èƒ½è®¿é—®åˆ°çˆ¶ç±»çš„é™æ€æ–¹æ³•

```
// ä»£ç 1ç¿»è¯‘ä¸‹å°±æ˜¯
function F(){}
F.prototype = superClass.prototype
subClass.prototype = new F()
subClass.prototype.constructor = subClass
ç®€å†™ä¸ºä¸€è¡Œä»£ç æ˜¯ï¼šsubClass.prototype.__proto__ = superClass.prototype

// ä»£ç 2ç¿»è¯‘ä¸‹å°±æ˜¯ï¼š
function A(){}
var a = new A()
a.__proto__ = A.prototype
// aæ˜¯ä¸€ä¸ªå®ä¾‹ï¼ŒA.prototypeæ˜¯æ„é€ æ–¹æ³•çš„åŸå‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œé‚£ä¹ˆaå°±å¯ä»¥è®¿é—®A.prototypeä¸Šé¢çš„æ–¹æ³•ã€‚
// é‚£æŠŠ subClassç±»æ¯”æˆ aï¼ŒsuperClassç±»æ¯”æˆA.prototypeï¼Œé‚£æ˜¯ä¸æ˜¯subClasså¯ä»¥ç›´æ¥è®¿é—® superClassçš„é™æ€å±æ€§ï¼Œé™æ€æ–¹æ³•äº†ã€‚
```



# JS

## å¸¸ç”¨å‡½æ•°

### æ•°ç»„å»é‡

```
const uniqueArr = (arr) => [...new Set(arr)];
```

### ä»urlè·å–å‚æ•°

```
    const getParameters = () => {
      const url = window.location.href;
      return JSON.parse(`{"${decodeURI(url.split('?')[1]).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g, '":"')}"}`);
    };
```

### æ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸ºç©º

```
const isEmpty = obj => Reflect.ownKeys(obj).length === 0 && obj.constructor === Object;
```

### åè½¬å­—ç¬¦ä¸²

```
const reverse = str => str.split('').reverse().join('');
```

### ç”Ÿæˆéšæœºåå…­è¿›åˆ¶é¢œè‰²

```
const randomHexColor = () => `#${Math.floor(Math.random() * 0xffffff).toString(16).padEnd(6, "0")}`
```

### æ£€æŸ¥è®¾å¤‡ç±»å‹

```
const judgeDeviceType =
      () => /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|OperaMini/i.test(navigator.userAgent) ? 'Mobile' : 'PC';
```

### æ–‡å­—å¤åˆ¶åˆ°å‰ªè´´æ¿

```
const copyText = async (text) => await navigator.clipboard.writeText(text)
```

## å˜é‡å¯¹è±¡

**å‚è€ƒ**

- [JavaScriptæ·±å…¥ä¹‹å˜é‡å¯¹è±¡](https://github.com/mqyqingfeng/Blog/issues/5#top)

å¯¹äºæ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œéƒ½æœ‰ä¸‰ä¸ªé‡è¦å±æ€§ï¼š

- å˜é‡å¯¹è±¡( variable object ï¼ŒVO)
- ä½œç”¨åŸŸé“¾( scope chain)
- this

**å˜é‡å¯¹è±¡**

å˜é‡å¯¹è±¡æ˜¯ä¸æ‰§è¡Œä¸Šä¸‹æ–‡ç›¸å…³çš„æ•°æ®ä½œç”¨åŸŸï¼Œå­˜å‚¨äº†åœ¨ä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„å˜é‡å’Œå‡½æ•°å£°æ˜ã€‚

æ¥ä¸‹æ¥æ˜¯ï¼šå…¨å±€ä¸Šä¸‹æ–‡ä¸‹çš„å˜é‡å¯¹è±¡å’Œå‡½æ•°ä¸Šä¸‹æ–‡ä¸‹çš„å˜é‡å¯¹è±¡ã€‚

**å…¨å±€ä¸Šä¸‹æ–‡**

å…¨å±€å¯¹è±¡ã€‚åœ¨ [W3School](http://www.w3school.com.cn/jsref/jsref_obj_global.asp) ä¸­ä¹Ÿæœ‰ä»‹ç»ï¼š

> å…¨å±€å¯¹è±¡æ˜¯é¢„å®šä¹‰çš„å¯¹è±¡ï¼Œä½œä¸º JavaScript çš„å…¨å±€å‡½æ•°å’Œå…¨å±€å±æ€§çš„å ä½ç¬¦ã€‚é€šè¿‡ä½¿ç”¨å…¨å±€å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®æ‰€æœ‰å…¶ä»–æ‰€æœ‰é¢„å®šä¹‰çš„å¯¹è±¡ã€å‡½æ•°å’Œå±æ€§ã€‚

> åœ¨é¡¶å±‚ JavaScript ä»£ç ä¸­ï¼Œå¯ä»¥ç”¨å…³é”®å­— this å¼•ç”¨å…¨å±€å¯¹è±¡ã€‚å› ä¸ºå…¨å±€å¯¹è±¡æ˜¯ä½œç”¨åŸŸé“¾çš„å¤´ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰éé™å®šæ€§çš„å˜é‡å’Œå‡½æ•°åéƒ½ä¼šä½œä¸ºè¯¥å¯¹è±¡çš„å±æ€§æ¥æŸ¥è¯¢ã€‚

> ä¾‹å¦‚ï¼Œå½“JavaScript ä»£ç å¼•ç”¨ parseInt() å‡½æ•°æ—¶ï¼Œå®ƒå¼•ç”¨çš„æ˜¯å…¨å±€å¯¹è±¡çš„ parseInt å±æ€§ã€‚å…¨å±€å¯¹è±¡æ˜¯ä½œç”¨åŸŸé“¾çš„å¤´ï¼Œè¿˜æ„å‘³ç€åœ¨é¡¶å±‚ JavaScript ä»£ç ä¸­å£°æ˜çš„æ‰€æœ‰å˜é‡éƒ½å°†æˆä¸ºå…¨å±€å¯¹è±¡çš„å±æ€§ã€‚

```
// å…¨å±€å¯¹è±¡å°±æ˜¯ Window å¯¹è±¡
console.log(this);
console.log(this instanceof Object);
// éƒ½èƒ½ç”Ÿæ•ˆ
console.log(Math.random());
console.log(this.Math.random());
var a = 1;
// ä½œä¸ºå…¨å±€å˜é‡çš„å®¿ä¸»
console.log(this.a);
// å…¨å±€å¯¹è±¡æœ‰ window å±æ€§æŒ‡å‘è‡ªèº«
console.log(window.a);

this.window.b = 2;
console.log(this.b);
```

**å‡½æ•°ä¸Šä¸‹æ–‡**

åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬ç”¨æ´»åŠ¨å¯¹è±¡(activation object , AO)æ¥è¡¨ç¤ºå˜é‡å¯¹è±¡ã€‚

**æ‰§è¡Œè¿‡ç¨‹**

æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä»£ç ä¼šåˆ†æˆä¸¤ä¸ªé˜¶æ®µè¿›è¡Œå¤„ç†ï¼šåˆ†æå’Œæ‰§è¡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å«åšï¼š

1. è¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡
2. ä»£ç æ‰§è¡Œ

## å½»åº•ææ‡‚this

## ä¸åŒä½¿ç”¨åœºæ™¯çš„thiså–å€¼

JavaScriptå‡½æ•°ä¸­thiså–å€¼ä¸»è¦åŒºåˆ†ä»¥ä¸‹å‡ ä¸ªæƒ…å†µï¼š

1. é»˜è®¤ç»‘å®š(å‡½æ•°çš„æ™®é€šè°ƒç”¨)
2. éšå¼ç»‘å®š(å‡½æ•°ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨)
3. newç»‘å®š(å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨)
4. æ˜¾ç¤ºç»‘å®š(å‡½æ•°é€šè¿‡`call`ã€`apply`ã€`bind`é—´æ¥è°ƒç”¨)
5. ES6ç»‘å®š(ç®­å¤´å‡½æ•°çš„è°ƒç”¨)

æµ‹è¯•ç»ƒä¹ 

```
var name = 'window'

const person1 = {
  name: 'person1',
  show1: function () {
    console.log(this.name)
  },
  show2: () => console.log(this.name),
  show3: function () {
    return function () {
      console.log(this.name)
    }
  },
  show4: function () {
    return () => console.log(this.name)
  }
}
const person2 = { name: 'person2' }

person1.show1()                     // person1 å‡½æ•°ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼ŒthisæŒ‡å‘å¯¹è±¡
person1.show1.call(person2)         // person2 ä½¿ç”¨callé—´æ¥è°ƒç”¨å‡½æ•°ï¼ŒthisæŒ‡å‘ä¼ å…¥çš„person2

person1.show2()                     // window  ç®­å¤´å‡½æ•°æ— thisç»‘å®šï¼Œåœ¨å…¨å±€ç¯å¢ƒæ‰¾åˆ°thisï¼ŒæŒ‡å‘window
person1.show2.call(person2)         // window  é—´æ¥è°ƒç”¨æ”¹å˜thisæŒ‡å‘å¯¹ç®­å¤´å‡½æ•°æ— æ•ˆ

person1.show3()()                   // window  person1.show3()è¿”å›æ™®é€šå‡½æ•°ï¼Œç›¸å½“äºæ™®é€šå‡½æ•°è°ƒç”¨ï¼ŒthisæŒ‡å‘window
person1.show3().call(person2)       // person2 ä½¿ç”¨callé—´æ¥è°ƒç”¨å‡½æ•°ï¼ŒthisæŒ‡å‘ä¼ å…¥çš„person2
person1.show3.call(person2)()       // window  person1.show3.call(person2)ä»ç„¶è¿”å›æ™®é€šå‡½æ•°

person1.show4()()                   // person1 person1.show4è°ƒç”¨å¯¹è±¡æ–¹æ³•ï¼ŒthisæŒ‡å‘person1ï¼Œè¿”å›ç®­å¤´å‡½æ•°ï¼Œthisåœ¨person1.show4è°ƒç”¨æ—¶çš„è¯æ³•ç¯å¢ƒä¸­æ‰¾åˆ°ï¼ŒæŒ‡å‘person1
person1.show4().call(person2)       // person1  é—´æ¥è°ƒç”¨æ”¹å˜thisæŒ‡å‘å¯¹ç®­å¤´å‡½æ•°æ— æ•ˆ
person1.show4.call(person2)()       // person2  æ”¹å˜äº†person1.show4è°ƒç”¨æ—¶thisçš„æŒ‡å‘ï¼Œæ‰€ä»¥è¿”å›çš„ç®­å¤´å‡½æ•°çš„å†…thisè§£ææ”¹å˜
```



## ä½œç”¨åŸŸ

**å‚è€ƒ**

- [JavaScriptæ·±å…¥ä¹‹è¯æ³•ä½œç”¨åŸŸå’ŒåŠ¨æ€ä½œç”¨åŸŸ](https://github.com/mqyqingfeng/blog/issues/3)
- [JavaScriptæ·±å…¥ä¹‹æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ](https://github.com/mqyqingfeng/Blog/issues/4)

ä½œç”¨åŸŸæ˜¯æŒ‡ç¨‹åºæºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸã€‚

JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸ(lexical scoping)ï¼Œä¹Ÿå°±æ˜¯é™æ€ä½œç”¨åŸŸã€‚

**é™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ä½œç”¨åŸŸ**

å› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å†³å®šäº†ã€‚

è€Œä¸è¯æ³•ä½œç”¨åŸŸç›¸å¯¹çš„æ˜¯åŠ¨æ€ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸæ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰å†³å®šçš„ã€‚

```
var value = 1;
function foo() {
    console.log(value);
}
function bar() {
    var value = 2;
    foo();
}
bar();
// ç»“æœæ˜¯ ???
```

å‡è®¾JavaScripté‡‡ç”¨é™æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š

æ‰§è¡Œ foo å‡½æ•°ï¼Œå…ˆä» foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ value (ä»·å€¼) ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ ¹æ®ä¹¦å†™çš„ä½ç½®ï¼ŒæŸ¥æ‰¾ä¸Šé¢ä¸€å±‚çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ value (ä»·å€¼) ç­‰äº 1ï¼Œæ‰€ä»¥ç»“æœä¼šæ‰“å° 1ã€‚

å‡è®¾JavaScripté‡‡ç”¨åŠ¨æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š

æ‰§è¡Œ foo å‡½æ•°ï¼Œä¾ç„¶æ˜¯ä» foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ value (ä»·å€¼) ã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±ä»è°ƒç”¨å‡½æ•°çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯ bar å‡½æ•°å†…éƒ¨æŸ¥æ‰¾ value (ä»·å€¼) å˜é‡ï¼Œæ‰€ä»¥ç»“æœä¼šæ‰“å° 2ã€‚

å‰é¢æˆ‘ä»¬å·²ç»è¯´äº†ï¼ŒJavaScripté‡‡ç”¨çš„æ˜¯é™æ€ä½œç”¨åŸŸï¼Œæ‰€ä»¥è¿™ä¸ªä¾‹å­çš„ç»“æœæ˜¯ 1ã€‚

æ¥è‡ªã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹ä¸­çš„ä¾‹å­ï¼š

```
var scope = "global scope";
function checkscope(){
    var scope = "local scope";
    function f(){
        return scope;
    }
    return f();
}
checkscope();
```

```
var scope = "global scope";
function checkscope(){
    var scope = "local scope";
    function f(){
        return scope;
    }
    return f;
}
checkscope()();
```

ä¸¤æ®µä»£ç éƒ½ä¼šæ‰“å°ï¼š`local scope`ã€‚å› ä¸ºJavaScripté‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåŸºäºå‡½æ•°åˆ›å»ºçš„ä½ç½®ã€‚

> å¼•ç”¨ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹çš„å›ç­”å°±æ˜¯ï¼š
>
> JavaScript å‡½æ•°çš„æ‰§è¡Œç”¨åˆ°äº†ä½œç”¨åŸŸé“¾ï¼Œè¿™ä¸ªä½œç”¨åŸŸé“¾æ˜¯åœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„ã€‚åµŒå¥—çš„å‡½æ•° f() å®šä¹‰åœ¨è¿™ä¸ªä½œç”¨åŸŸé“¾é‡Œï¼Œå…¶ä¸­çš„å˜é‡ scope (èŒƒå›´) ä¸€å®šæ˜¯å±€éƒ¨å˜é‡ï¼Œä¸ç®¡ä½•æ—¶ä½•åœ°æ‰§è¡Œå‡½æ•° f()ï¼Œè¿™ç§ç»‘å®šåœ¨æ‰§è¡Œ f() æ—¶ä¾ç„¶æœ‰æ•ˆã€‚

## instanceOfæ‰‹å†™

**å®ç°æ€è·¯ï¼š**

> 1. é¦–å…ˆ instanceof å·¦ä¾§å¿…é¡»æ˜¯å¯¹è±¡, æ‰èƒ½æ‰¾åˆ°å®ƒçš„åŸå‹é“¾
> 2. instanceof å³ä¾§å¿…é¡»æ˜¯å‡½æ•°, å‡½æ•°æ‰ä¼šprototypeå±æ€§
> 3. è¿­ä»£ , å·¦ä¾§å¯¹è±¡çš„åŸå‹ä¸ç­‰äºå³ä¾§çš„ prototypeæ—¶, æ²¿ç€åŸå‹é“¾é‡æ–°èµ‹å€¼å·¦ä¾§

```
// æ‰‹å†™instanceOf-é€’å½’ç‰ˆæœ¬
function instanceOfMe(obj, Constructor) { // obj è¡¨ç¤ºå·¦è¾¹çš„å¯¹è±¡ï¼ŒConstructorè¡¨ç¤ºå³è¾¹çš„æ„é€ å‡½æ•°
  let leftP = obj.__proto__ // å–å¯¹è±¡éšå¼åŸå‹
    let rightP = Constructor.prototype // å–æ„é€ å‡½æ•°æ˜¾ç¤ºåŸå‹
    // åˆ°è¾¾åŸå‹é“¾é¡¶å±‚è¿˜æœªæ‰¾åˆ°åˆ™è¿”å›false
    if (leftP === null) {
        return false
    }
    // å¯¹è±¡å®ä¾‹çš„éšå¼åŸå‹ç­‰äºæ„é€ å‡½æ•°æ˜¾ç¤ºåŸå‹åˆ™è¿”å›true
    if (leftP === rightP) {
        return true
    }
    // æŸ¥æ‰¾åŸå‹é“¾ä¸Šä¸€å±‚
    return instanceOfMe(obj.__proto__, Constructor)
}
// æ‰‹å†™instanceOf-éé€’å½’ç‰ˆæœ¬
function instanceOfMe(L, R) { // L è¡¨ç¤ºå·¦è¾¹çš„å¯¹è±¡ï¼ŒRè¡¨ç¤ºå³è¾¹çš„æ„é€ å‡½æ•°
    // éªŒè¯å¦‚æœä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œå°±ç›´æ¥è¿”å›false
    const baseType = ['string', 'number','boolean','undefined','symbol']
    if(baseType.includes(typeof(L))) { return false }
    
    let RP  = R.prototype;  //å– R çš„æ˜¾ç¤ºåŸå‹
    L = L.__proto__;       //å– L çš„éšå¼åŸå‹
    while(true){           // æ— çº¿å¾ªç¯çš„å†™æ³•ï¼ˆä¹Ÿå¯ä»¥ä½¿ for(;;) ï¼‰
        if(L === null){    //æ‰¾åˆ°æœ€é¡¶å±‚
            return false;
        }
        if(L === RP){       //ä¸¥æ ¼ç›¸ç­‰
            return true;
        }
        L = L.__proto__;  //æ²¡æ‰¾åˆ°ç»§ç»­å‘ä¸Šä¸€å±‚åŸå‹é“¾æŸ¥æ‰¾
    }
}
```



# ç¨‹åºå‘˜å‰¯ä¸š

## å‰¯ä¸šæ–¹å‘

**1ã€æœ‰æŠ€æœ¯çš„ç¨‹åºå‘˜**

æœ‰çš„ä¸­å°å…¬å¸ä¼šæ‰¾ä¸šå†…çš„æŠ€æœ¯ä¸“å®¶ï¼Œè§£å†³æŸä¸ªæŠ€æœ¯é—®é¢˜ï¼Œåˆæˆ–è®¸æ˜¯é’ˆå¯¹å¼€å‘éœ€æ±‚ç»„ç»‡çš„å›¢é˜Ÿå†…è®­ï¼ŒåŒ…æ‹¬ä¸€äº›ç¨‹åºå‘˜åŸ¹è®­æœºæ„ï¼Œä¹Ÿä¼šé‚€è¯·æŠ€æœ¯ä¸“å®¶å‚ä¸è¯¾ç¨‹ç ”å‘ï¼Œéƒ½æ˜¯ä¸ºä½ çš„æŠ€èƒ½ä»˜è´¹ã€‚

å¹¶ä¸”åšå¾—å¥½è¿˜å¯ä»¥æ‰“é€ ä¸ªäººIPï¼ŒæŠŠè‡ªå·±è¶Šå–è¶Šè´µï¼Œç›´æ¥ä¸Šå‡Nä¸ªæ¡£æ¬¡ã€‚

**2ã€æœ‰èµ„æºçš„ç¨‹åºå‘˜**

æœ‰æœºä¼šæœ‰èƒ½åŠ›æ¥é¡¹ç›®æ¥åšï¼Œä¸€æ–¹é¢åœ¨å·¥ä½œä¸­ç§¯ç´¯äº†äººè„‰å’Œèµ„æºï¼Œå¦ä¸€æ–¹é¢è‡ªå·±å¯ä»¥ç»„ç»‡æˆ–æ•´åˆä¸€ä¸ªå…¼èŒçš„å°å›¢é˜Ÿã€‚

æ‰€ä»¥å–„å¾…èº«è¾¹çš„äººï¼Œè¯´ä¸å®šä¸‹ä¸ªå•å­å°±æ˜¯ä»–å¼€ç»™ä½ çš„ï¼

**3ã€æœ‰ä¸ªäººè§è§£çš„ç¨‹åºå‘˜**

å†™æŠ€æœ¯åšå®¢ï¼Œåšè‡ªåª’ä½“ï¼ŒåšçŸ­è§†é¢‘ï¼Œåˆ†äº«å·¥ä½œç»éªŒï¼Œæ‹†è§£æŠ€èƒ½â€¦â€¦èµ°è‡ªåª’ä½“è·¯çº¿ï¼Œæœ‰ç‹¬ç‰¹ä¸ªæ€§çš„äººä¼šæ›´åƒé¦™ï¼Œæ›´æœ‰ç”šè€…å¯ä»¥å–è¯¾ã€å–ä¹¦ï¼Œåƒæµé‡ï¼Œèµšç¨¿è´¹ã€‚

## å‰¯ä¸šå¹³å°

è®°ä½ï¼š

> - ä¸ªäººçš„ï¼Œåˆ«æƒ³ç€åœ¨è¿™ç§çº¿ä¸Šå¹³å°æ¥å•èµšé’±ï¼Œçº¿ä¸Šå¹³å°èƒ½æ¥åˆ°å•èµšé’±çš„ï¼Œéƒ½æ˜¯ä¸“é—¨æˆç«‹äº†å¤–åŒ…å°å…¬å¸çš„å›¢é˜Ÿã€‚
> - çº¿ä¸Šæ¥å•æˆ‘5å¹´å‰å°±ä¸ç©äº†ï¼Œå½“æ—¶çŒªå…«æˆ’å¾ˆç«ï¼Œå¾ˆå¤šç¨‹åºå‘˜ä¸Šé¢æ¥å•ï¼Œä½†æ˜¯å‘ç°ä»˜å‡ºä¸æ”¶è·ä¸æˆæ­£æ¯”ï¼Œ ä½œä¸ºç¨‹åºå‘˜çº¿ä¸Šæ¥å•ä¸æ˜¯å¥½è·¯å­ï¼Œæœ€å¥½æ˜¯è‡ªå·±å¼€å‘ä¸€ä¸ªäº§å“(æ¯”å¦‚å°ç¨‹åº)ï¼Œé äº§å“èµšé’±ï¼Œè¿™ä¸ªé’±èµšçš„åˆèˆ’æœåˆé”»ç‚¼è‡ªå·±æˆä¸ºè€æ¿
> - åšè§†é¢‘èšåˆèµ„æºappï¼Œä¸€ä¸ªæœˆ1wæ²¡é—®é¢˜ï¼Œçº¯èµšï¼Œå®¹æ˜“è¿›å±€å­ï¼Œç‰ˆæƒé—®é¢˜
> - çº¿ä¸Šæ¥å•è¿™ç§æŒ£å¾—æ¯”è¾ƒå°‘ï¼Œä»·æ ¼é€æ˜ï¼Œç«äº‰å¤§ã€‚æœ€å¥½çš„æ˜¯å–„å¾…å‘¨å›´çš„äººï¼Œæ‰©å¤§äº¤é™…åœˆï¼Œè¯´ä¸å®šå“ªå¤©ç»™ä½ ä»‹ç»ä¸€å•ï¼Œè·¨è¡Œä¸šçš„å®¹æ˜“æŒ£ä¿¡æ¯ä¸å¯¹ç§°çš„ğŸ’°ï¼Œåˆ©æ¶¦å¤§ã€‚

**1ã€ç¨‹åºå‘˜å®¢æ ˆ**

å›½å†…é¢†å…ˆçš„ç¨‹åºå‘˜è‡ªç”±è¿œç¨‹å·¥ä½œå¹³å°ï¼Œè¿™è¡Œçš„åº”è¯¥éƒ½çŸ¥é“å§ã€‚çµæ´»åº¦é«˜ï¼Œæ¯”è¾ƒè‡ªç”±ï¼Œå•å­æ¯”è¾ƒå¤šï¼Œä¸ªäººæ¨èï¼

**2ã€è‹±é€‰**

å¹³å°ä»¥å®šåˆ¶å¼€å‘å¤–åŒ…æœåŠ¡ä¸ºä¸»ï¼Œä¹Ÿæ˜¯å¤–åŒ…é¡¹ç›®å¹³å°ã€‚å®ƒçš„é¡¹ç›®ç®¡ç†æ–¹é¢æ˜¯ç‰¹è‰²ï¼Œé˜¶æ®µç¡®è®¤å’ŒåŠæ—¶åé¦ˆè¾ƒå¥½ã€‚

**3ã€Devnors**

å›½å¤–çš„ä¸€ä¸ªäº’è”ç½‘è½¯ä»¶å®šåˆ¶å¼€å‘ä¸è½¯ä»¶å¤–åŒ…å¼€å‘æœåŠ¡å¹³å°ï¼Œè‹±è¯­å¥½çš„æœ‹å‹å¯ä»¥çœ‹çœ‹ï¼Œå®ƒæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯å¹³å°ç”¨çš„æ˜¯åŒºå—é“¾æŠ€æœ¯æ”¯ä»˜ã€‚è¦æ˜¯èƒ½æ¥ä¸Šå›½å¤–çš„å•ï¼Œé‚£è¿˜æ˜¯é¦™çš„ï¼

**4ã€å¼€æºä¼—åŒ…**

ä¸Šé¢çš„é¡¹ç›®ä»¥ä¼—åŒ…ä¸ºä¸»ã€‚æ¥åŒ…æ–¹è´¨é‡è¾ƒå¥½ï¼Œå®ƒçš„ååŠ©å¼€å‘å·¥å…·æ¯”è¾ƒå®Œå–„ã€‚ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªç½‘ç«™ã€‚

# Vue3å…¥é—¨

## Hooks

æ–¹å¼ä¸‰ï¼šå‚è€ƒå¤§å´”å“¥çš„æ–°å†™æ³•(ç›´æ¥èµ‹å€¼å¼•ç”¨)--å¼ºçƒˆæ¨è

```
// Task.vue
<script setup lang="ts">
import { ref,onBeforeMount } from 'vue';
import { initListTag } from '@/service/task'

let listTags =reactive([])
onBeforeMount(async () => {
   initListTag()
})
</script>
<template>
<div v-for="(listTag,i) in listTags" :key="'listTags'+i">{{ listTag.label }}</div>
</template>

// @/service/task.ts
import { ref } from 'vue';
import * as myapi from '@/service/myapi';

let listTags =[]

 export async function initListTag(
  listTagsReactive
) {
  // 0.åˆå§‹åŒ–
  declareListTag(listTagsReactive)
  await loadTags()
}

 function declareListTag(
  listTagsReactive
) {
  // 1.åˆå§‹åŒ–-å˜é‡
  listTags = listTagsReactive
}

export async function loadTags() {
  // 2.åˆå§‹åŒ–-å¡«å……tags
  const tab={}
  listTags.push(createListTag(tag.name, tag.color, tag.parentTagId || undefined, tag.id))
}

export function createListTag(name, color?, parentTagId?, id = 0){
  // 3.åˆå§‹åŒ–-åˆ›å»ºtag
  return {
    id,
    name,
    color: color || '',
    parentTagId: parentTagId || null,
    loadTasks: () => {
      return myapi.getTasksByTagId(id)
    },
  }
}

export async function addListTag(tag) {
  // æ·»åŠ tagç­‰å…¶ä»–é€»è¾‘å¤„ç†,æ­¤å¤„å¯ä»¥æ‹¿åˆ°listTagså˜é‡
  const pIndex = await myapi.addTag(tag.name, tag.parentTagId, tag.color)
  if (pIndex)
    tag.id = pIndex
  listTags.push(tag)
}
```

æ–¹å¼å››ï¼šå‚è€ƒå¤§å´”å“¥çš„æ–°å†™æ³•(è¿”å›å€¼å¼•ç”¨)

```
// User.vue
<template>
    <!-- è§†å›¾éƒ¨åˆ†çœç•¥ï¼Œåœ¨å¯¹åº”btnå¤„å¼•ç”¨onChangePasswordå’ŒonChangeUserInfoå³å¯ -->
   <div @click="onChangePassword"> {{userInfo}}</div>
</template>
<script setup>
import useUserControl from './useUserControl';
const { userInfo, onChangeUserInfo,onChangePassword } = useUserControl();
<script>

// @/service/useUserControl.ts
import useUser from './useUser';
const useUserControl = () => {
    // ç»„åˆç”¨æˆ·hook
    const { userInfo, getUserInfo, changeUserInfo } = useUser();
    // æ•°æ®æŸ¥è¯¢loadingçŠ¶æ€
    const loading = ref(false);
    // åˆå§‹åŒ–æ•°æ®
    const initData = () => {
        getUserInfo();
    }
    // ä¿®æ”¹å¯†ç 
     const onChangePassword = () => {
    }
    onMounted(initData);
    return {
        // ç”¨æˆ·æ•°æ®
        userInfo,
        // ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯
        onChangeUserInfo: changeUserInfo,
        onChangePassword:onChangePassword
    }
}

// @/service/useUser.ts
const useUser = () => {
    // vueç‰ˆæœ¬çš„ç”¨æˆ·çŠ¶æ€
    const userInfo = ref({});
    // è·å–ç”¨æˆ·çŠ¶æ€
    const getUserInfo = () => {}
    // ä¿®æ”¹ç”¨æˆ·çŠ¶æ€
    const changeUserInfo = () => {};
    return {
        userInfo,
        getUserInfo,
        changeUserInfo
    }
}
```



# ç»„ä»¶åº“å°è£…

## é«˜è´¨é‡ç»„ä»¶ç¼–å†™

- ç»„ä»¶ä½•æ—¶æ‹†åˆ†
- æ‹†åˆ†å‡ºç»„ä»¶æ–‡ä»¶
- ç”¨hooksæŠ½ç¦»ç»„ä»¶é€»è¾‘

**ç»„ä»¶ä½•æ—¶æ‹†åˆ†**

> æ‹†åˆ†çš„ç»„ä»¶è¦ä¿æŒåŠŸèƒ½å•ä¸€ã€‚å³ç»„ä»¶å†…éƒ¨ä»£ç çš„ä»£ç éƒ½åªè·Ÿè¿™ä¸ªåŠŸèƒ½ç›¸å…³ï¼›
>
> ç»„ä»¶è¦ä¿æŒè¾ƒä½çš„è€¦åˆåº¦ï¼Œä¸è¦ä¸ç»„ä»¶å¤–éƒ¨äº§ç”Ÿè¿‡å¤šçš„äº¤äº’ã€‚å¦‚ç»„ä»¶å†…éƒ¨ä¸è¦ä¾èµ–è¿‡å¤šçš„å¤–éƒ¨å˜é‡ï¼Œçˆ¶å­ç»„ä»¶çš„äº¤äº’ä¸è¦æå¾—å¤ªå¤æ‚ç­‰ç­‰ã€‚
>
> ç”¨ç»„ä»¶åå‡†ç¡®æè¿°è¿™ä¸ªç»„ä»¶çš„åŠŸèƒ½ã€‚å°±åƒå‡½æ•°é‚£æ ·ï¼Œå¯ä»¥è®©äººä¸ç”¨å…³å¿ƒç»„ä»¶ç»†èŠ‚ï¼Œå°±å¤§æ¦‚çŸ¥é“è¿™ä¸ªç»„ä»¶æ˜¯å¹²å˜›çš„ã€‚å¦‚æœèµ·åæ¯”è¾ƒå›°éš¾ï¼Œè€ƒè™‘ä¸‹æ˜¯ä¸æ˜¯è¿™ä¸ªç»„ä»¶çš„åŠŸèƒ½å¹¶ä¸å•ä¸€ã€‚

**æ‹†åˆ†å‡ºç»„ä»¶æ–‡ä»¶**

æœ¬äººæ›´æ¨èç»Ÿä¸€æ”¾å…¥åˆ°componentæ–‡ä»¶å¤¹ä¸‹ã€‚

> 1. å¦‚æœåªæ˜¯è¢«é¡µé¢å†…çš„ç»„ä»¶å¤ç”¨ï¼Œå°±æ”¾åˆ°é¡µé¢æ–‡ä»¶å¤¹ä¸‹ã€‚
> 2. å¦‚æœåªæ˜¯åœ¨å½“å‰ä¸šåŠ¡åœºæ™¯ä¸‹çš„ä¸åŒé¡µé¢å¤ç”¨ï¼Œå°±æ”¾åˆ°å½“å‰ä¸šåŠ¡æ¨¡å—çš„æ–‡ä»¶å¤¹ä¸‹ã€‚
> 3. å¦‚æœå¯ä»¥åœ¨ä¸åŒä¸šåŠ¡åœºæ™¯é—´é€šç”¨ï¼Œå°±æ”¾åˆ°æœ€é¡¶å±‚çš„å…¬å…±æ–‡ä»¶å¤¹ï¼Œæˆ–è€…è€ƒè™‘åšæˆç»„ä»¶åº“ã€‚

```
homePage // å­˜æ”¾å½“å‰é¡µé¢çš„æ–‡ä»¶å¤¹
    |-- components // å­˜æ”¾å½“å‰é¡µé¢ç»„ä»¶çš„æ–‡ä»¶å¤¹
        |-- componentA // å­˜æ”¾å½“å‰é¡µé¢çš„ç»„æˆéƒ¨åˆ†Açš„æ–‡ä»¶å¤¹
            |-- index.(vue|tsx) // ç»„ä»¶A
            |-- AChild1.(vue|tsx) // ç»„ä»¶açš„ç»„æˆéƒ¨åˆ†1
            |-- AChild2.(vue|tsx) // ç»„ä»¶açš„ç»„æˆéƒ¨åˆ†2
            |-- ACommon.(vue|tsx) // åªåœ¨componentAå†…éƒ¨å¤ç”¨çš„ç»„ä»¶
        |-- ComponentB.(vue|tsx) // å½“å‰é¡µé¢çš„ç»„æˆéƒ¨åˆ†B
        |-- Common.(vue|tsx) // ç»„ä»¶Aå’Œç»„ä»¶Bé‡Œå¤ç”¨çš„ç»„ä»¶
    |-- index.(vue|tsx) // å½“å‰é¡µé¢
```

**ç”¨hooksæŠ½ç¦»ç»„ä»¶é€»è¾‘**

- æ–¹å¼ä¸‰ï¼šå‚è€ƒå¤§å´”å“¥çš„æ–°å†™æ³•(ç›´æ¥èµ‹å€¼å¼•ç”¨)--å¼ºçƒˆæ¨è
- æ–¹å¼å››ï¼šå‚è€ƒå¤§å´”å“¥çš„æ–°å†™æ³•(è¿”å›å€¼å¼•ç”¨)

# ä¹¦å•

- [awesome-book](https://github.com/fuyunjinglong/awesome-books/)

# Reactå…¥é—¨

- [å½“å…¬å¸è¦æ±‚ä½ å¿…é¡»ä¼š Reactï¼ŒVueer ä¸å¾—ä¸å­¦](https://juejin.cn/post/7173953093158060039#heading-3)

# JSå‘å¸ƒè®¢é˜…-æç®€

```
class SyncHook {
  constructor() {
    this.taps = [];
  }

  //æ³¨å†Œç›‘å¬å‡½æ•°ï¼Œè¿™é‡Œçš„nameå…¶å®æ²¡å•¥ç”¨
  tap(name, fn) {
    this.taps.push({ name, fn });
  }

  //æ‰§è¡Œå‡½æ•°
  call(...args) {
    this.taps.forEach((tap) => tap.fn(...args));
  }
}
```

# webpackçš„Loaderæœºåˆ¶

- [ã€ä¸‡å­—é•¿æ–‡ï½œè¶£å‘³å›¾è§£ã€‘å½»åº•å¼„æ‡‚Webpackä¸­çš„Loaderæœºåˆ¶](https://juejin.cn/post/7157739406835580965#heading-16)

**Loaderæœ¬è´¨**

Loader æœ¬è´¨ä¸Šæ˜¯å¯¼å‡ºä¸ºå‡½æ•°çš„ JavaScript æ¨¡å—ã€‚`å®ƒæ¥æ”¶èµ„æºæ–‡ä»¶æˆ–è€…ä¸Šä¸€ä¸ª Loader äº§ç”Ÿçš„ç»“æœä½œä¸ºå…¥å‚ï¼Œä¹Ÿå¯ä»¥ç”¨å¤šä¸ª Loader å‡½æ•°ç»„æˆ loader chainï¼ˆé“¾ï¼‰ï¼Œæœ€ç»ˆè¾“å‡ºè½¬æ¢åçš„ç»“æœ`ã€‚

**Loaderçš„å››ç§ç±»å‹**

åˆ†ä¸ºï¼š[å‰ç½®(pre)](https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fmodule%2F%23ruleenforce)ã€[æ™®é€š(normal)](https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fmodule%2F%23ruleenforce)ã€[è¡Œå†…(inline)](https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fmodule%2F%23ruleenforce)ã€[åç½®(post)](https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fmodule%2F%23ruleenforce)ã€‚

```
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          "style-loader", //å°†csså†…å®¹å˜æˆstyleæ ‡ç­¾æ’å…¥åˆ°htmlä¸­å»
          "css-loader", //è§£æcssæ–‡ä»¶çš„è·¯å¾„ç­‰
          "less-loader", //å°†less=>css
        ],
        enforce: "pre", //è¿™é‡Œä¹Ÿå¯ä»¥æ˜¯postï¼Œé»˜è®¤ä¸å†™å°±æ˜¯normal
      },
    ],
  },
```

**Loaderæ‰§è¡Œé¡ºåº**

ç®€å•è¯´ï¼šLoader çš„æ‰§è¡Œé¡ºåºæ˜¯ç”±å³å‘å·¦ï¼Œæˆ–è€…ç”±ä¸‹åˆ°ä¸Šæ‰§è¡Œã€‚

å®˜æ–¹è¯´æ³•ï¼š**Pitching** é˜¶æ®µå’Œ**Normal** é˜¶æ®µ

æ‰€æœ‰ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿›å…¥çš„ Loaderï¼Œéƒ½æœ‰ä¸¤ä¸ªé˜¶æ®µï¼š

1. **Pitching** é˜¶æ®µ: Loader ä¸Šçš„ pitch æ–¹æ³•ï¼ŒæŒ‰ç…§ `åç½®(post)ã€è¡Œå†…(inline)ã€æ™®é€š(normal)ã€å‰ç½®(pre)` çš„é¡ºåºè°ƒç”¨ã€‚
2. **Normal** é˜¶æ®µ: Loader ä¸Šçš„ å¸¸è§„æ–¹æ³•ï¼ŒæŒ‰ç…§ `å‰ç½®(pre)ã€æ™®é€š(normal)ã€è¡Œå†…(inline)ã€åç½®(post)` çš„é¡ºåºè°ƒç”¨ã€‚æ¨¡å—æºç çš„è½¬æ¢ï¼Œ å‘ç”Ÿåœ¨è¿™ä¸ªé˜¶æ®µã€‚
3. åŒç­‰ç±»å‹ä¸‹çš„ Loader æ‰§è¡Œé¡ºåºæ‰æ˜¯ç”±å³å‘å·¦ï¼Œæˆ–è€…ç”±ä¸‹åˆ°ä¸Šæ‰§è¡Œã€‚

# Vueæ¨¡æ¿ç¼–è¯‘æµç¨‹(ç¼–è¯‘å™¨åŸç†)

ä¸€ä¸ªç¼–è¯‘å™¨å®Œæ•´æ‰§è¡Œè¿‡ç¨‹ï¼š

**Parsing(è§£æè¿‡ç¨‹)**ï¼šè¿™ä¸ªè¿‡ç¨‹è¦ç»`è¯æ³•åˆ†æ`ã€`è¯­æ³•åˆ†æ`ã€`æ„å»ºASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰`ä¸€ç³»åˆ—æ“ä½œï¼›

**Transformationï¼ˆè½¬åŒ–è¿‡ç¨‹**ï¼‰ï¼šè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å°†ä¸Šä¸€æ­¥è§£æåçš„å†…å®¹ï¼ŒæŒ‰ç…§ç¼–è¯‘å™¨æŒ‡å®šçš„è§„åˆ™è¿›è¡Œå¤„ç†ï¼Œ`å½¢æˆä¸€ä¸ªæ–°çš„è¡¨ç°å½¢å¼`ï¼›

**Code Generationï¼ˆä»£ç ç”Ÿæˆ**ï¼‰ï¼šå°†ä¸Šä¸€æ­¥å¤„ç†å¥½çš„å†…å®¹`è½¬åŒ–ä¸ºæ–°çš„ä»£ç `ï¼›

æˆªå›¾ï¼šhttps://juejin.cn/post/7155151377013047304#heading-4



# ES6çš„å¯¼å…¥å¯¼å‡º

- [ã€Œä¸‡å­—è¿›é˜¶ã€æ·±å…¥æµ…å‡º Commonjs å’Œ Es Module](https://juejin.cn/post/6994224541312483336)
- [æ·±å…¥ CommonJs ä¸ ES6 Module](https://link.juejin.cn/?target=https%3A%2F%2Fsegmentfault.com%2Fa%2F1190000017878394)
- [ã€ŒNode.jsç³»åˆ—ã€æ·±å…¥æµ…å‡ºNodeæ¨¡å—åŒ–å¼€å‘â€”â€”CommonJSè§„èŒƒ](https://juejin.cn/post/6892786383249735687)

```
/**
 * å¯¼å‡º
 */
export * from 'module'; //é‡å®šå‘å¯¼å‡º ä¸åŒ…æ‹¬ moduleå†…çš„default
export { name1, name2, ..., nameN } from 'module'; // é‡å®šå‘å‘½åå¯¼å‡º
export { import1 as name1, import2 as name2, ..., nameN } from 'module'; // é‡å®šå‘é‡å‘½åå¯¼å‡º
export { name1, name2, â€¦, nameN }; // ä¸ä¹‹å‰å£°æ˜çš„å˜é‡åç»‘å®š å‘½åå¯¼å‡º
export { variable1 as name1, variable2 as name2, â€¦, nameN }; // é‡å‘½åå¯¼å‡º
export let name1 = 'name1'; // å£°æ˜å‘½åå¯¼å‡º æˆ–è€… var, constï¼Œfunctionï¼Œ function*, class
export default expression; // é»˜è®¤å¯¼å‡º
export default function () { ... } // æˆ–è€… function*, class
export default function name1() { ... } // æˆ–è€… function*, class

/**
 * å¯¼å…¥
 */
import defaultExport from "module"; // é»˜è®¤å¯¼å…¥
import { a, b, c } from "module"; //è§£æ„å¯¼å…¥
import defaultExport, { a, b, c as newC } from "module"; //æ··åˆå¯¼å…¥
import * as name from "module"; //æ··åˆå¯¼å…¥
var promise = import("module"); //åŠ¨æ€å¯¼å…¥(å¼‚æ­¥å¯¼å…¥)
```



# axioså–æ¶ˆè¯·æ±‚

**æ–¹å¼1ï¼šAbortController**

ä» `v0.22.0` å¼€å§‹ï¼ŒAxios æ”¯æŒä»¥ fetch API æ–¹å¼â€”â€” [`AbortController`](https://developer.mozilla.org/en-US/docs/Web/API/AbortController) å–æ¶ˆè¯·æ±‚ï¼š

```js
const controller = new AbortController();
// å–æ¶ˆé‡å¤è¯·æ±‚
controller.signal && controller.abort();
axios.get('/foo/bar', {
   signal: controller.signal
}).then(function(response) {
   //...
});
```

**æ–¹å¼2ï¼šCancelToken** 

é€šè¿‡ä¼ é€’ä¸€ä¸ª executor å‡½æ•°åˆ° `CancelToken` çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ª cancel tokenï¼šã€‚

æ­¤ API ä» `v0.22.0` å¼€å§‹å·²è¢«å¼ƒç”¨ï¼Œä¸åº”åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚

```js
const CancelToken = axios.CancelToken;
let cancel;
// å–æ¶ˆé‡å¤è¯·æ±‚
cancel && cancel();
axios.get('/user/12345', {
  cancelToken: new CancelToken(function executor(c) {
    // executor å‡½æ•°æ¥æ”¶ä¸€ä¸ª cancel å‡½æ•°ä½œä¸ºå‚æ•°
    cancel = c;
  })
});
```



# äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·

DOMäº‹ä»¶æµï¼ˆevent flow ï¼‰å­˜åœ¨ä¸‰ä¸ªé˜¶æ®µï¼š**äº‹ä»¶æ•è·é˜¶æ®µã€å¤„äºç›®æ ‡é˜¶æ®µã€äº‹ä»¶å†’æ³¡é˜¶æ®µã€‚**

**äº‹ä»¶æ•è·ï¼š**é€šä¿—çš„ç†è§£å°±æ˜¯ï¼Œå½“é¼ æ ‡ç‚¹å‡»æˆ–è€…è§¦å‘domäº‹ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹**ç”±å¤–åˆ°å†…**è¿›è¡Œäº‹ä»¶ä¼ æ’­ã€‚

**äº‹ä»¶å†’æ³¡**ï¼šä¸äº‹ä»¶æ•è·æ°æ°ç›¸åï¼Œäº‹ä»¶å†’æ³¡é¡ºåºæ˜¯ç”±å†…åˆ°å¤–è¿›è¡Œäº‹ä»¶ä¼ æ’­ï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹ã€‚

æˆªå›¾ï¼šhttps://juejin.cn/post/6844903834075021326



# äººç”Ÿè§„åˆ’å’ŒèŒä¸šå‘å±•

**é—®é¢˜1ï¼šæ­¦æ±‰æ˜¯ä¸€ä¸ªå¤§åŸå¸‚ï¼Œç›¸æ¯”ä¸€èˆ¬å°å¿åŸï¼Œæœ‰ä»¥ä¸‹ä¼˜åŠ¿å’ŒåŠ£åŠ¿ï¼š**

> ä¼˜åŠ¿ï¼š
>
> 1. ç»æµå‘å±•æ°´å¹³é«˜ï¼šæ­¦æ±‰æ˜¯æ¹–åŒ—çœçš„çœä¼šï¼Œä¹Ÿæ˜¯ä¸­éƒ¨åœ°åŒºçš„é‡è¦åŸå¸‚ï¼Œæ‹¥æœ‰è¾ƒä¸ºå®Œå–„çš„äº§ä¸šä½“ç³»å’Œå‘è¾¾çš„ç»æµã€‚ç›¸æ¯”å°å¿åŸï¼Œæ­¦æ±‰çš„ç»æµå‘å±•æ°´å¹³æ›´é«˜ï¼Œå°±ä¸šæœºä¼šæ›´å¤šã€‚
> 2. æ–‡åŒ–æ°›å›´æµ“åšï¼šæ­¦æ±‰æ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…çš„åŸå¸‚ï¼Œæœ‰ç€ä¸°å¯Œçš„æ–‡åŒ–åº•è•´å’Œç‹¬ç‰¹çš„æ–‡åŒ–æ°›å›´ã€‚æ­¦æ±‰æœ‰è®¸å¤šè‘—åçš„æ–‡åŒ–æ™¯ç‚¹å’Œå†å²é—è¿¹ï¼Œå¦‚é»„é¹¤æ¥¼ã€å¤ç´å°ã€æ±‰å£æ±Ÿæ»©ç­‰ï¼Œè¿™äº›éƒ½æ˜¯å°å¿åŸæ‰€æ²¡æœ‰çš„ã€‚
> 3. ç”Ÿæ´»ä¾¿åˆ©ï¼šæ­¦æ±‰æ˜¯ä¸€ä¸ªå¤§åŸå¸‚ï¼Œæ‹¥æœ‰å®Œå–„çš„åŸºç¡€è®¾æ–½å’Œä¾¿åˆ©çš„ç”Ÿæ´»æœåŠ¡ã€‚ç›¸æ¯”å°å¿åŸï¼Œæ­¦æ±‰çš„åŒ»ç–—ã€æ•™è‚²ã€äº¤é€šç­‰æ–¹é¢æ›´åŠ å‘è¾¾ï¼Œå±…æ°‘çš„ç”Ÿæ´»è´¨é‡æ›´é«˜ã€‚
>
> åŠ£åŠ¿ï¼š
>
> 1. äº¤é€šæ‹¥å µï¼šæ­¦æ±‰æ˜¯ä¸€ä¸ªå¤§åŸå¸‚ï¼Œäº¤é€šå‹åŠ›è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯é«˜å³°æœŸï¼Œäº¤é€šæ‹¥å µç°è±¡æ¯”è¾ƒä¸¥é‡ã€‚ç›¸æ¯”å°å¿åŸï¼Œæ­¦æ±‰çš„äº¤é€šçŠ¶å†µæ›´ä¸ºå¤æ‚ï¼Œéœ€è¦èŠ±è´¹æ›´å¤šçš„æ—¶é—´å’Œç²¾åŠ›ã€‚
> 2. ç©ºæ°”è´¨é‡å·®ï¼šç”±äºæ­¦æ±‰æ˜¯ä¸€ä¸ªå·¥ä¸šåŸå¸‚ï¼Œç©ºæ°”è´¨é‡ç›¸å¯¹è¾ƒå·®ï¼Œå°¤å…¶æ˜¯å†¬å­£å’Œé›¾éœ¾å¤©æ°”ï¼Œç©ºæ°”æ±¡æŸ“é—®é¢˜æ¯”è¾ƒä¸¥é‡ã€‚ç›¸æ¯”å°å¿åŸï¼Œæ­¦æ±‰çš„ç¯å¢ƒè´¨é‡æ›´å·®ã€‚
> 3. ç”Ÿæ´»æˆæœ¬é«˜ï¼šæ­¦æ±‰æ˜¯ä¸€ä¸ªå¤§åŸå¸‚ï¼Œç”Ÿæ´»æˆæœ¬ç›¸å¯¹è¾ƒé«˜ï¼Œå°¤å…¶æ˜¯æˆ¿ä»·å’Œç‰©ä»·æ–¹é¢ã€‚ç›¸æ¯”å°å¿åŸï¼Œæ­¦æ±‰çš„ç”Ÿæ´»æˆæœ¬æ›´é«˜ï¼Œéœ€è¦èŠ±è´¹æ›´å¤šçš„é’±ã€‚

**é—®é¢˜2ï¼šçˆ¶æ¯å…¬åŠ¡å‘˜å¯¹å­©å­çš„å½±å“ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š**

> 1. æ•™è‚²ç¯å¢ƒï¼šå…¬åŠ¡å‘˜å®¶åº­é€šå¸¸æ³¨é‡æ•™è‚²ï¼Œé‡è§†å­©å­çš„å­¦ä¹ å’Œæˆé•¿ï¼Œæä¾›æ›´å¥½çš„æ•™è‚²ç¯å¢ƒå’Œèµ„æºï¼Œè¿™å¯¹å­©å­çš„æˆé•¿æœ‰ç§¯æçš„å½±å“ã€‚
>
> 2. ç¤¾ä¼šå…³ç³»ï¼šå…¬åŠ¡å‘˜å®¶åº­é€šå¸¸æœ‰æ›´å¹¿æ³›çš„ç¤¾ä¼šå…³ç³»ï¼Œè¿™å¯¹å­©å­çš„äººé™…äº¤å¾€å’Œç¤¾äº¤èƒ½åŠ›çš„åŸ¹å…»æœ‰ä¸€å®šçš„å¸®åŠ©ã€‚
>
> 3. å®‰å…¨ç¨³å®šï¼šå…¬åŠ¡å‘˜å®¶åº­é€šå¸¸æœ‰è¾ƒä¸ºç¨³å®šçš„æ”¶å…¥å’ŒèŒä¸šï¼Œè¿™å¯¹å­©å­çš„æˆé•¿ç¯å¢ƒå’Œç”Ÿæ´»æ¡ä»¶éƒ½æœ‰ä¸€å®šçš„ä¿éšœã€‚
>
> 4. å‹åŠ›å’ŒæœŸæœ›ï¼šå…¬åŠ¡å‘˜å®¶åº­é€šå¸¸å¯¹å­©å­çš„æœŸæœ›è¾ƒé«˜ï¼Œå¸Œæœ›å­©å­èƒ½å¤Ÿç»§æ‰¿çˆ¶æ¯çš„ä¼˜ç§€å“è´¨å’Œæˆå°±ï¼Œè¿™å¯èƒ½ä¼šç»™å­©å­å¸¦æ¥ä¸€å®šçš„å‹åŠ›ã€‚
>
> æ€»çš„æ¥è¯´ï¼Œçˆ¶æ¯å…¬åŠ¡å‘˜å¯¹å­©å­çš„å½±å“æ˜¯å¤šæ–¹é¢çš„ï¼Œæ—¢æœ‰ç§¯æçš„æ–¹é¢ï¼Œä¹Ÿæœ‰ä¸€äº›æ½œåœ¨çš„è´Ÿé¢å½±å“ã€‚ä½†æ˜¯ï¼Œè¿™äº›å½±å“å¹¶ä¸æ˜¯ç»å¯¹çš„ï¼Œè¿˜è¦è€ƒè™‘å…·ä½“çš„å®¶åº­æƒ…å†µå’Œå­©å­çš„ä¸ªæ€§ç‰¹ç‚¹ã€‚

**é—®é¢˜3ï¼šä¸­å›½å…¬åŠ¡å‘˜çš„å¾…é‡**

> 1. è–ªèµ„å¾…é‡ï¼šå…¬åŠ¡å‘˜çš„è–ªèµ„å¾…é‡ç›¸å¯¹è¾ƒé«˜ï¼Œä¸€èˆ¬æ¯”åŒç­‰å­¦å†çš„ä¼ä¸šå‘˜å·¥è¦é«˜ã€‚
>
> 2. ç¦åˆ©å¾…é‡ï¼šå…¬åŠ¡å‘˜äº«æœ‰è¾ƒå¥½çš„ç¦åˆ©å¾…é‡ï¼ŒåŒ…æ‹¬åŒ»ç–—ä¿é™©ã€å…»è€ä¿é™©ã€ä½æˆ¿å…¬ç§¯é‡‘ç­‰ã€‚
>
> 3. å·¥ä½œç¨³å®šæ€§ï¼šå…¬åŠ¡å‘˜çš„å·¥ä½œç›¸å¯¹ç¨³å®šï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç°è£å‘˜ç­‰æƒ…å†µã€‚
>
> 4. èŒä¸šå‘å±•ï¼šå…¬åŠ¡å‘˜çš„èŒä¸šå‘å±•ç©ºé—´ç›¸å¯¹è¾ƒå¤§ï¼Œå¯ä»¥é€šè¿‡è€ƒè¯•æ™‹å‡åˆ°æ›´é«˜çº§åˆ«çš„èŒä½ã€‚
>
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…¬åŠ¡å‘˜çš„å·¥ä½œå‹åŠ›è¾ƒå¤§ï¼Œå·¥ä½œæ—¶é—´ä¹Ÿç›¸å¯¹è¾ƒé•¿ï¼ŒåŒæ—¶éœ€è¦æ‰¿æ‹…ä¸€å®šçš„è´£ä»»å’Œä¹‰åŠ¡ã€‚
>
> ä¸€èˆ¬æ¥è¯´ï¼Œå…¬åŠ¡å‘˜æ™‹å‡çš„å¹´é¾„é™åˆ¶å¦‚ä¸‹ï¼š
>
> 1. åˆæ¬¡å½•ç”¨çš„å…¬åŠ¡å‘˜ï¼Œä¸€èˆ¬è¦æ±‚å¹´é¾„åœ¨35å‘¨å²ä»¥ä¸‹ï¼›
> 2. æ™®é€šå…¬åŠ¡å‘˜æ™‹å‡ä¸ºå‰¯ç§‘çº§å¹²éƒ¨ï¼Œä¸€èˆ¬è¦æ±‚å¹´é¾„åœ¨45å‘¨å²ä»¥ä¸‹ï¼›
> 3. å‰¯ç§‘çº§å¹²éƒ¨æ™‹å‡ä¸ºæ­£ç§‘çº§å¹²éƒ¨ï¼Œä¸€èˆ¬è¦æ±‚å¹´é¾„åœ¨50å‘¨å²ä»¥ä¸‹ï¼›
> 4. æ­£ç§‘çº§å¹²éƒ¨æ™‹å‡ä¸ºå‰¯å¿çº§å¹²éƒ¨ï¼Œä¸€èˆ¬è¦æ±‚å¹´é¾„åœ¨55å‘¨å²ä»¥ä¸‹ï¼›
> 5. å‰¯å¿çº§å¹²éƒ¨æ™‹å‡ä¸ºæ­£å¿çº§å¹²éƒ¨ï¼Œä¸€èˆ¬è¦æ±‚å¹´é¾„åœ¨60å‘¨å²ä»¥ä¸‹ã€‚
>
> å…¬åŠ¡å‘˜çš„ç¼ºé™·å’ŒåŠ£åŠ¿å¯èƒ½åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š
>
> 1. è–ªèµ„ç›¸å¯¹è¾ƒä½ï¼šå…¬åŠ¡å‘˜çš„è–ªèµ„ç›¸å¯¹äºåŒç­‰å­¦å†å’Œå·¥ä½œç»éªŒçš„æ°‘è¥ä¼ä¸šå‘˜å·¥æ¥è¯´è¾ƒä½ï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›å‘å±•è¾ƒå¿«çš„è¡Œä¸šå’Œåœ°åŒºã€‚
>
> 2. æ™‹å‡æœºä¼šè¾ƒå°‘ï¼šå…¬åŠ¡å‘˜çš„æ™‹å‡æœºä¼šç›¸å¯¹è¾ƒå°‘ï¼Œæ™‹å‡çš„é€Ÿåº¦ä¹Ÿæ¯”è¾ƒæ…¢ï¼Œè¿™å¯èƒ½ä¼šå½±å“åˆ°ä¸ªäººçš„èŒä¸šå‘å±•ã€‚
>
> 3. å·¥ä½œå‹åŠ›å¤§ï¼šå…¬åŠ¡å‘˜çš„å·¥ä½œå‹åŠ›ä¹Ÿæ¯”è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯åœ¨ä¸€äº›é‡è¦çš„å²—ä½ä¸Šï¼Œéœ€è¦æ‰¿æ‹…è¾ƒå¤§çš„è´£ä»»å’Œå‹åŠ›ã€‚
>
> 4. å·¥ä½œç¯å¢ƒç›¸å¯¹å•ä¸€ï¼šå…¬åŠ¡å‘˜çš„å·¥ä½œç¯å¢ƒç›¸å¯¹è¾ƒä¸ºå•ä¸€ï¼Œç¼ºä¹å¤šæ ·æ€§å’ŒæŒ‘æˆ˜æ€§ï¼Œå¯èƒ½ä¼šå¯¼è‡´å·¥ä½œçš„å•è°ƒæ€§å’Œä¹å‘³æ€§ã€‚
>
> 5. å·¥ä½œç¨³å®šæ€§è¾ƒé«˜ï¼šè™½ç„¶å…¬åŠ¡å‘˜çš„è–ªèµ„ç›¸å¯¹è¾ƒä½ï¼Œä½†æ˜¯å·¥ä½œç¨³å®šæ€§è¾ƒé«˜ï¼Œç›¸å¯¹äºæ°‘è¥ä¼ä¸šæ¥è¯´æ›´åŠ ç¨³å®šå’Œå®‰å…¨ã€‚
>
> æ€»çš„æ¥è¯´ï¼Œå…¬åŠ¡å‘˜çš„ç¼ºé™·å’ŒåŠ£åŠ¿ä¸ä¸ªäººçš„èŒä¸šå‘å±•å’Œä»·å€¼è§‚æœ‰å…³ï¼Œéœ€è¦æ ¹æ®è‡ªèº«æƒ…å†µè¿›è¡Œæƒè¡¡å’Œé€‰æ‹©ã€‚

**é—®é¢˜4ï¼šæ”¾å¼ƒç¨‹åºå‘˜é«˜è–ªï¼Œä¸“èŒå»è€ƒå–å›½å®¶å…¬åŠ¡å‘˜ï¼Œåˆé€‚å—**

> è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå–å†³äºä½ çš„ä¸ªäººæƒ…å†µå’Œç›®æ ‡ã€‚å¦‚æœä½ å¯¹å…¬åŠ¡å‘˜èŒä¸šæœ‰æµ“åšçš„å…´è¶£ï¼Œå¹¶ä¸”ç›¸ä¿¡è¿™æ˜¯ä½ å®ç°è‡ªå·±èŒä¸šå’Œä¸ªäººç›®æ ‡çš„æœ€ä½³é€”å¾„ï¼Œé‚£ä¹ˆè¿™ä¸ªå†³å®šå°±æ˜¯åˆé€‚çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åªæ˜¯å› ä¸ºæ”¾å¼ƒç¨‹åºå‘˜é«˜è–ªè€Œè€ƒè™‘å…¬åŠ¡å‘˜èŒä¸šï¼Œé‚£ä¹ˆè¿™ä¸ªå†³å®šå¯èƒ½ä¸æ˜¯æœ€æ˜æ™ºçš„é€‰æ‹©ã€‚
>
> åœ¨åšå‡ºè¿™ä¸ªå†³å®šä¹‹å‰ï¼Œä½ éœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªå› ç´ ï¼š
>
> 1. è–ªèµ„ï¼šä¸€èˆ¬æ¥è¯´ï¼Œç¨‹åºå‘˜çš„è–ªèµ„æ¯”å›½å®¶å…¬åŠ¡å‘˜é«˜ã€‚å¦‚æœä½ æ›´çœ‹é‡è–ªèµ„ï¼Œé‚£ä¹ˆé€‰æ‹©ç¨‹åºå‘˜å·¥ä½œå¯èƒ½æ›´é€‚åˆä½ ã€‚
>
> 2. å·¥ä½œå†…å®¹ï¼šç¨‹åºå‘˜å·¥ä½œéœ€è¦å…·å¤‡ä¸€å®šçš„æŠ€æœ¯èƒ½åŠ›å’Œåˆ›é€ åŠ›ï¼Œéœ€è¦ä¸æ–­å­¦ä¹ å’Œæ›´æ–°çŸ¥è¯†ã€‚è€Œå›½å®¶å…¬åŠ¡å‘˜çš„å·¥ä½œå†…å®¹ç›¸å¯¹ç¨³å®šï¼Œéœ€è¦å…·å¤‡ä¸€å®šçš„ç»„ç»‡åè°ƒå’Œç®¡ç†èƒ½åŠ›ã€‚å¦‚æœä½ æ›´å–œæ¬¢æŒ‘æˆ˜å’Œåˆ›é€ ï¼Œé‚£ä¹ˆé€‰æ‹©ç¨‹åºå‘˜å·¥ä½œå¯èƒ½æ›´é€‚åˆä½ ã€‚
>
> 3. å·¥ä½œç¯å¢ƒï¼šç¨‹åºå‘˜å·¥ä½œä¸€èˆ¬åœ¨ITå…¬å¸æˆ–ç§‘æŠ€ä¼ä¸šä¸­ï¼Œå·¥ä½œç¯å¢ƒæ¯”è¾ƒè‡ªç”±ï¼Œæ³¨é‡åˆ›æ–°å’Œå›¢é˜Ÿåˆä½œã€‚è€Œå›½å®¶å…¬åŠ¡å‘˜çš„å·¥ä½œç¯å¢ƒç›¸å¯¹ç¨³å®šï¼Œæ³¨é‡è§„èŒƒå’Œçºªå¾‹ã€‚å¦‚æœä½ æ›´å–œæ¬¢è‡ªç”±å’Œåˆ›æ–°ï¼Œé‚£ä¹ˆé€‰æ‹©ç¨‹åºå‘˜å·¥ä½œå¯èƒ½æ›´é€‚åˆä½ ã€‚
>
> 4. èŒä¸šå‘å±•ï¼šç¨‹åºå‘˜å·¥ä½œæœ‰å¾ˆå¤šä¸åŒçš„èŒä¸šå‘å±•è·¯å¾„ï¼Œå¯ä»¥æˆä¸ºæŠ€æœ¯ä¸“å®¶ã€é¡¹ç›®ç»ç†ã€åˆ›ä¸šè€…ç­‰ã€‚è€Œå›½å®¶å…¬åŠ¡å‘˜çš„èŒä¸šå‘å±•è·¯å¾„ç›¸å¯¹å•ä¸€ï¼Œä¸»è¦æ˜¯æ™‹å‡åˆ°æ›´é«˜çº§åˆ«çš„å…¬åŠ¡å‘˜ã€‚å¦‚æœä½ æ›´çœ‹é‡èŒä¸šå‘å±•å’Œå¤šå…ƒåŒ–é€‰æ‹©ï¼Œé‚£ä¹ˆé€‰æ‹©ç¨‹åºå‘˜å·¥ä½œå¯èƒ½æ›´é€‚åˆä½ ã€‚
>
> ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœä½ è®¤ä¸ºå…¬åŠ¡å‘˜èŒä¸šæ˜¯ç¬¦åˆè‡ªå·±èŒä¸šå’Œä¸ªäººç›®æ ‡çš„æœ€ä½³é€”å¾„ï¼Œé‚£ä¹ˆè¿™ä¸ªå†³å®šå°±æ˜¯åˆé€‚çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åªæ˜¯å› ä¸ºæ”¾å¼ƒç¨‹åºå‘˜é«˜è–ªè€Œè€ƒè™‘å…¬åŠ¡å‘˜èŒä¸šï¼Œé‚£ä¹ˆè¿™ä¸ªå†³å®šå¯èƒ½ä¸æ˜¯æœ€æ˜æ™ºçš„é€‰æ‹©ã€‚
>
> è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå–å†³äºä¸ªäººçš„ä»·å€¼è§‚å’ŒèŒä¸šè§„åˆ’ã€‚å¦‚æœä½ è®¤ä¸ºæˆä¸ºå›½å®¶å…¬åŠ¡å‘˜æ˜¯å®ç°ä¸ªäººä»·å€¼å’ŒèŒä¸šè§„åˆ’çš„æœ€ä½³é€”å¾„ï¼Œé‚£ä¹ˆè¿™ä¸ªå†³å®šå°±æ˜¯åˆé€‚çš„ã€‚ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ”¾å¼ƒé«˜è–ªçš„ç¨‹åºå‘˜èŒä¸šï¼Œè½¬è€Œæˆä¸ºå›½å®¶å…¬åŠ¡å‘˜ï¼Œå¯èƒ½ä¼šå¯¹ä¸ªäººçš„ç»æµçŠ¶å†µäº§ç”Ÿå½±å“ã€‚å› æ­¤ï¼Œåœ¨åšå‡ºè¿™ä¸ªå†³å®šä¹‹å‰ï¼Œéœ€è¦ä»”ç»†è€ƒè™‘è‡ªå·±çš„èŒä¸šè§„åˆ’å’Œç”Ÿæ´»éœ€æ±‚ï¼Œå¹¶åšå¥½å……åˆ†çš„å‡†å¤‡ã€‚
>
> è¿™æ˜¯ä¸€ä¸ªéå¸¸æ£˜æ‰‹çš„é—®é¢˜ï¼Œéœ€è¦ä½ è‡ªå·±æƒè¡¡åˆ©å¼Šå¹¶åšå‡ºå†³å®šã€‚é¦–å…ˆï¼Œä½ éœ€è¦è€ƒè™‘è‡ªå·±çš„èŒä¸šå…´è¶£å’Œå‘å±•æ–¹å‘ï¼Œå¦‚æœä½ å¯¹å…¬åŠ¡å‘˜è¿™ä¸ªèŒä¸šæ²¡æœ‰å…´è¶£ï¼Œé‚£ä¹ˆè½¬è¡Œå¯èƒ½ä¼šè®©ä½ æ„Ÿåˆ°ä¸æ»¡å’Œå¤±è½ã€‚å…¶æ¬¡ï¼Œä½ éœ€è¦è€ƒè™‘ä½ å’Œå¥³æœ‹å‹çš„å…³ç³»ï¼Œå¦‚æœä½ ä»¬çš„æ„Ÿæƒ…å¾ˆæ·±ï¼Œä½ å¯ä»¥è€ƒè™‘å¦¥åï¼Œä½†æ˜¯å¦‚æœä½ ä»¬çš„æ„Ÿæƒ…å¹¶ä¸ç‰¢å›ºï¼Œä½ éœ€è¦å¥½å¥½è€ƒè™‘æ˜¯å¦å€¼å¾—ä¸ºäº†å¥¹çš„è¦æ±‚è€Œæ”¾å¼ƒè‡ªå·±çš„èŒä¸šå‘å±•ã€‚æœ€åï¼Œä½ éœ€è¦è€ƒè™‘ä½ ä»¬æœªæ¥å­©å­çš„æ•™è‚²å’Œæˆé•¿ï¼Œå…¬åŠ¡å‘˜è¿™ä¸ªèŒä¸šç›¸å¯¹ç¨³å®šï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œä½ éœ€è¦å¥½å¥½æƒè¡¡ã€‚ æ€»ä¹‹ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦ä½ è‡ªå·±åšå‡ºå†³å®šçš„é—®é¢˜ï¼Œä½ éœ€è¦è€ƒè™‘è‡ªå·±çš„èŒä¸šå…´è¶£ã€ä¸ªäººå‘å±•ã€æ„Ÿæƒ…å…³ç³»å’Œæœªæ¥å­©å­çš„æ•™è‚²ç­‰å¤šä¸ªæ–¹é¢ï¼Œåšå‡ºæœ€åˆé€‚çš„å†³å®šã€‚

# vueä¸reactæ¯”è¾ƒ

## Hooks

- [æµ…è°ˆï¼šä¸ºå•¥vueå’Œreactéƒ½é€‰æ‹©äº†Hooks](https://juejin.cn/post/7066951709678895141#heading-1)

**å®šä¹‰**

"hooks" ç›´è¯‘æ˜¯ â€œé’©å­â€ï¼Œå®ƒå¹¶ä¸ä»…æ˜¯ `react`ï¼Œç”šè‡³ä¸ä»…æ˜¯å‰ç«¯ç•Œçš„ä¸“ç”¨æœ¯è¯­ï¼Œè€Œæ˜¯æ•´ä¸ªè¡Œä¸šæ‰€ç†ŸçŸ¥çš„ç”¨è¯­ã€‚é€šå¸¸æŒ‡ï¼š

> ç³»ç»Ÿè¿è¡Œåˆ°æŸä¸€æ—¶æœŸæ—¶ï¼Œä¼šè°ƒç”¨è¢«æ³¨å†Œåˆ°è¯¥æ—¶æœºçš„å›è°ƒå‡½æ•°ã€‚

ä»¥ `react` ä¸ºä¾‹ï¼Œ`hooks` æ˜¯ï¼š

> ä¸€ç³»åˆ—ä»¥ `â€œuseâ€` ä½œä¸ºå¼€å¤´çš„æ–¹æ³•ï¼Œå®ƒä»¬æä¾›äº†è®©ä½ å¯ä»¥å®Œå…¨é¿å¼€ `classå¼å†™æ³•`ï¼Œåœ¨å‡½æ•°å¼ç»„ä»¶ä¸­å®Œæˆç”Ÿå‘½å‘¨æœŸã€çŠ¶æ€ç®¡ç†ã€é€»è¾‘å¤ç”¨ç­‰å‡ ä¹å…¨éƒ¨ç»„ä»¶å¼€å‘å·¥ä½œçš„èƒ½åŠ›ã€‚

è€Œåœ¨ `vue` ä¸­ï¼Œ `hooks` çš„å®šä¹‰å¯èƒ½æ›´æ¨¡ç³Šï¼Œå§‘ä¸”æ€»ç»“ä¸€ä¸‹ï¼š

> åœ¨ `vue` ç»„åˆå¼APIé‡Œï¼Œä»¥ `â€œuseâ€` ä½œä¸ºå¼€å¤´çš„ï¼Œä¸€ç³»åˆ—æä¾›äº†ç»„ä»¶å¤ç”¨ã€çŠ¶æ€ç®¡ç†ç­‰å¼€å‘èƒ½åŠ›çš„æ–¹æ³•ã€‚

**å‘½åè§„èŒƒå’ŒæŒ‡å¯¼æ€æƒ³**

åœ¨ `react` å®˜æ–¹æ–‡æ¡£é‡Œï¼Œå¯¹ `hooks` çš„å®šä¹‰å’Œä½¿ç”¨æå‡ºäº† **â€œä¸€ä¸ªå‡è®¾ã€ä¸¤ä¸ªåªåœ¨â€** æ ¸å¿ƒæŒ‡å¯¼æ€æƒ³ã€‚

> **ä¸€ä¸ªå‡è®¾ï¼š** å‡è®¾ä»»ä½•ä»¥ ã€Œ`use`ã€ å¼€å¤´å¹¶ç´§è·Ÿç€ä¸€ä¸ªå¤§å†™å­—æ¯çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ª `Hook`ã€‚
>
> **ç¬¬ä¸€ä¸ªåªåœ¨ï¼š** åªåœ¨ `React` å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ `Hook`ï¼Œè€Œä¸åœ¨æ™®é€šå‡½æ•°ä¸­è°ƒç”¨ `Hook`ã€‚ï¼ˆ`Eslint` é€šè¿‡åˆ¤æ–­ä¸€ä¸ªæ–¹æ³•æ˜¯ä¸æ˜¯å¤§å¨å³°å‘½åæ¥åˆ¤æ–­å®ƒæ˜¯å¦æ˜¯ `React` å‡½æ•°ï¼‰
>
> **ç¬¬äºŒä¸ªåªåœ¨ï¼š** åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ `Hook`ï¼Œè€Œä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚
>
> å› ä¸ºæ˜¯çº¦å®šï¼Œå› è€Œ `useXxx` çš„å‘½åå¹¶éå¼ºåˆ¶ï¼Œä½ ä¾ç„¶å¯ä»¥å°†ä½ è‡ªå®šä¹‰çš„ `hook` å‘½åä¸º `byXxx` æˆ–å…¶ä»–æ–¹å¼ï¼Œä½†ä¸æ¨èã€‚

**ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ `hooks` ?**

- æ›´å¥½çš„ä»£ç ç»„ç»‡
- æ›´å¥½çš„é€»è¾‘å¤ç”¨

**å¦‚ä½•å¼€å§‹ç© `hooks`** 

react çš„ `Hooks` å†™æ³•ï¼Œå› ä¸º react Hooks ä»…æ”¯æŒâ€œå‡½æ•°å¼â€ç»„ä»¶ï¼Œå› æ­¤éœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ `my-component.js`

```
// my-component.js
import { useState, useEffect } from 'React'

export default () => {
  // é€šè¿‡ useState å¯ä»¥åˆ›å»ºä¸€ä¸ª çŠ¶æ€å±æ€§ å’Œä¸€ä¸ªèµ‹å€¼æ–¹æ³•
  const [ name, setName ] = useState('')

  // é€šè¿‡ useEffect å¯ä»¥å¯¹å‰¯ä½œç”¨è¿›è¡Œå¤„ç†
  useEffect(() => {
    console.log(name)
  }, [ name ])

  // é€šè¿‡ useMemo èƒ½ç”Ÿæˆä¸€ä¸ªä¾èµ– name çš„å˜é‡ message
  const message = useMemo(() => {
    return `hello, my name is ${name}`
  }, [name])

  return <div>{ message }</div>
}
```

vue çš„ `Hooks` å†™æ³•ï¼Œvue çš„ `Hooks` å†™æ³•ä¾èµ–äº `ç»„åˆå¼API`ï¼Œå› æ­¤æœ¬ä¾‹é‡‡ç”¨ `<script setup>` æ¥å†™ï¼š

```
<template>
  <div>
    {{ message }}
  </div>
</template>
<script setup>
import { computed, ref } from 'vue'
// å®šä¹‰äº†ä¸€ä¸ª ref å¯¹è±¡
const name = ref('')
// å®šä¹‰äº†ä¸€ä¸ªä¾èµ– name.value çš„è®¡ç®—å±æ€§
const message = computed(() => {
  return `hello, my name is ${name.value}`
})
</script>
```

**è‡ªå®šä¹‰Hooks**

reactå†™æ³•ï¼š

```
import React from 'react';

export const useName = () => {
  // è¿™ä¸ª useMemo å¾ˆå…³é”®
  const randomName = React.useMemo(() => genRandomName(), []);
  const [ name, setName ] = React.useState(randomName)

  return {
    name,
    setName
  }
}
```

vueå†™æ³•ï¼š

```
import { ref } from 'vue';

export const useName = () => {
  const name = ref(genRandomName())
  const setName = (v) => {
    name.value = v
  }
  return {
    name,
    setName
  }
}
```



# CSS

## ä¸­è‹±æ–‡æ¢è¡Œ

- word-break:break-word
- word-wrap:break-word

# webå‰ç«¯å¯¼èˆª

- [å°è®°ä¸­æ–‡](https://docschina.org/)
- [å‰ç«™å¯¼èˆª](http://www.frontendjs.com/)
- [ç¨‹åºå‘˜ç›’å­](https://www.coderutil.com/)

# Flowé™æ€ç±»å‹æ£€æµ‹å™¨

- [Flowå®˜ç½‘](https://flow.org/en/docs/install/)
- [Flowä¸­æ–‡ç½‘](https://zhenyong.github.io/flowtype/docs/getting-started.html#_)
- [Flowä¸­æ–‡æ”»ç•¥](https://flowjs.judysocute.com/startup/installation)

## å®‰è£…ç¼–è¯‘å™¨

é¦–å…ˆï¼Œä½ éœ€è¦ä¸€ä¸ªç¼–è¯‘å™¨æ¥å‰”é™¤`Flow`çš„ç±»å‹æ³¨è§£ã€‚ä½ å¯ä»¥é€‰æ‹©`Babel`æˆ–`flow-remove-types`.

### Babel

`Babel`æ˜¯ä¸€ä¸ªæ”¯æŒ`Flow`çš„`Javascript`ç¼–è¯‘å™¨ã€‚`Babel`æˆ‘ä»¬é€šä¿—çš„ç†è§£å°±æ˜¯æŠŠç°åœ¨æµè§ˆå™¨ä¸æ”¯æŒçš„æ–°ç‰¹æ€§ï¼ˆæ¯”å¦‚ï¼šES6ï¼‰è½¬æ¢ä¸ºå¯ä»¥æ”¯æŒçš„ES5è¯­æ³•ï¼Œä»è€Œä½¿æˆ‘ä»¬èƒ½åœ¨é¡¹ç›®ä¸­ä½“æµ‹æ–°æ ‡å‡†å¸¦æ¥çš„ç¦åˆ©ã€‚`Babel`ä½¿ç”¨æˆ‘ä»¬`Flow`ä»£ç ï¼Œå¹¶å‰”é™¤æ‰€æœ‰çš„ç±»å‹æ³¨è§£ã€‚

é¦–å…ˆå¾—å®‰è£… `babel-cli` æˆ– `babel-preset-flow`

npmç¯å¢ƒ

```undefined
npm install --save-dev babel-cli babel-preset-flow
```

æ–°å»ºä¸€ä¸ª `.babelrc`æ–‡ä»¶ï¼Œå¹¶åœ¨ `presets`å±æ€§é‡Œè®¾ç½® `flow`

```javascript
{
  "presets": ["flow"]
}
```

å¦‚æœä½ çš„æºä»£ç åœ¨ `src` ç›®å½•é‡Œï¼Œä½ å¯ä»¥å°†è¿™äº›ä»£ç ç¼–è¯‘åˆ°å¦ä¸€ä¸ªç›®å½•ä¸­

npmç¯å¢ƒ

```undefined
./node_modules/.bin/babel src/ -d lib/
```

å½“ç„¶ï¼Œåœ¨ `package.json`é…ç½®è¿è¡Œ

```javascript
{
  "name": "my-project",
  "main": "lib/index.js",
  "scripts": {
    "build": "babel src/ -d lib/"
  }
}
```

### flow-remove-types

`flow-remove-types`æ˜¯ä¸€ä¸ªç®€å•å»æ‰ç±»å‹æ³¨é‡Šçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä»–æ˜¯ä¸€ä¸ªä¸éœ€è¦ `Babel` æ”¯æŒçš„è½»é‡çº§ä»£æ›¿ `Babel`çš„å·¥å…·ã€‚

é¦–è¡Œå®‰è£… `flow-remove-types`

```undefined
npm install --save-dev flow-remove-types
```

å¦‚æœä½ çš„æºä»£ç åœ¨ `src` ç›®å½•é‡Œï¼Œä½ å¯ä»¥å°†è¿™äº›ä»£ç ç¼–è¯‘åˆ°å¦ä¸€ä¸ªç›®å½•ä¸­

```undefined
./node_modules/.bin/flow-remove-types src/ -d lib/
```

åœ¨ `package.json`é…ç½®è¿è¡Œ

```javascript
{
  "name": "my-project",
  "main": "lib/index.js",
  "scripts": {
    "build": "flow-remove-types src/ -d lib/"
  }
}
```

## å®‰è£… Flow

æŠŠ`npm`åŒ…å®‰è£…åˆ°`devDependency`ä¸Š

```undefined
npm install --save-dev flow-bin
```

åœ¨ `package.json` çš„ `scripts` é‡Œæ·»åŠ  `"flow"`

```javascript
{
  "name": "my-flow-project",
  "version": "1.0.0",
  "devDependencies": {
    "flow-bin": "^0.86.0"
  },
  "scripts": {
    "flow": "flow"
  }
}
```

é¦–å…ˆè¿è¡Œ

```undefined
npm run flow init
```

åœ¨ç¬¬ä¸€æ¬¡è¿è¡Œäº† `init` åï¼Œè¿è¡Œ

```undefined
npm run flow
```

/src/index.js

```
// @flow
function square(n: number): number {
  return n * n;
}

square(2);


```



# CSS

## CSSå®ç°èŠ‚æµ

å®ç°è¿‡ç¨‹ï¼š

1. å‡½æ•°èŠ‚æµæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„ä¼˜åŒ–æ–¹å¼ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å‡½æ•°è¿‡äºé¢‘ç¹çš„æ‰§è¡Œ
2. CSS çš„å®ç°æ€è·¯å’Œ JS ä¸åŒï¼Œé‡ç‚¹åœ¨äºåœ¨äºæ‰¾åˆ°å’Œè¯¥åœºæ™¯ç›¸å…³è”çš„å±æ€§
3. CSS å®ç°â€œèŠ‚æµâ€å…¶å®å°±æ˜¯æ§åˆ¶ä¸€ä¸ªåŠ¨ç”»çš„ç²¾å‡†æ§åˆ¶ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåŠ¨ç”»æ§åˆ¶æŒ‰é’®ä»**ç¦ç”¨**->**å¯ç‚¹å‡»**çš„å˜åŒ–ï¼Œæ¯æ¬¡ç‚¹å‡»æ—¶è®©è¿™ä¸ªåŠ¨ç”»é‡æ–°æ‰§è¡Œä¸€éï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸€ç›´å¤„äº**ç¦ç”¨**çŠ¶æ€ï¼Œè¿™æ ·å°±è¾¾åˆ°äº†â€œèŠ‚æµâ€çš„æ•ˆæœ
4. è¿˜å¯ä»¥é€šè¿‡ transition çš„å›è°ƒå‡½æ•°åŠ¨æ€è®¾ç½®æŒ‰é’®ç¦ç”¨æ€
5. è¿™ç§å®ç°çš„å¥½å¤„åœ¨äºç¦ç”¨é€»è¾‘å’Œä¸šåŠ¡é€»è¾‘æ˜¯å®Œå…¨è§£è€¦çš„

```
<button onclick="console.log('ä¿å­˜1')">æˆ‘æ˜¯â€œæ™®é€šâ€ä¿å­˜</button>
<button class="throttle" onclick="console.log('ä¿å­˜2')">æˆ‘æ˜¯â€œèŠ‚æµâ€ä¿å­˜</button>

  body{
    display: grid;
    place-content: center;
    height: 100vh;
    margin: 0;
    gap: 15px;
    background: #f1f1f1;
}
button{
  user-select: none;
}
.throttle{
  opacity: .99;
  transition: opacity 2s;
}
.throttle:not(:disabled):active{
  opacity: 1;
  transition: 0s;
}

document.addEventListener('transitionstart', function(ev){
      ev.target.disabled = true
    })
    document.addEventListener('transitionend', function(ev){
      ev.target.disabled = false
    })
```



## ä¼˜ç§€ä»£ç å®è·µ

### å·§ç”¨noté€‰æ‹©å™¨

> æœ‰äº›æƒ…å†µä¸‹`æ‰€æœ‰`çš„å…ƒç´ éƒ½éœ€è¦æŸäº›æ ·å¼ï¼Œå”¯ç‹¬`æœ€åä¸€ä¸ª`ä¸éœ€è¦ï¼Œè¿™æ—¶å€™ä½¿ç”¨noté€‰æ‹©å™¨å°†ä¼šç‰¹åˆ«æ–¹ä¾¿

```
li:not(:last-child){
  border-bottom: 1px solid #ebedf0;
}
```

### ä½¿ç”¨flexå¸ƒå±€å®ç°æ™ºèƒ½å›ºå®šåº•éƒ¨

> å†…å®¹ä¸å¤Ÿæ—¶ï¼Œ`è§„åˆ™è¯´æ˜`è¦å¤„äºåº•éƒ¨ï¼Œå†…å®¹è¶³å¤Ÿå¤šæ—¶ï¼Œ`è§„åˆ™è¯´æ˜`éšç€å†…å®¹å¾€ä¸‹æ²‰ï¼Œå¤§å®¶ä¸€å®šä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„éœ€æ±‚ï¼Œä½¿ç”¨flexå·§å¦™å®ç°å¸ƒå±€ã€‚

```
<div class="container">
  <div class="main">æˆ‘æ˜¯å†…å®¹åŒºåŸŸ</div>
  <div class="footer">è§„åˆ™è¯´æ˜</div>
</div>

 .container{
  height: 100vh;
  /* å…³é”®csså¤„ */
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
.main{
  /* å…³é”®csså¤„ */
  flex: 1;
  background-image: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
}
.footer{
  padding: 15px 0;
  text-align: center;
  color: #ff9a9e;
  font-size: 14px;
}
```

### ç”»ä¸‰è§’å½¢

```
<div class="box">
  <div class="box-inner">
    <div class="triangle bottom"></div>
    <div class="triangle right"></div>
    <div class="triangle top"></div>
    <div class="triangle left"></div>
  </div>
</div>

.triangle {
  display: inline-block;
  margin-right: 10px;
  /* åŸºç¡€æ ·å¼ */
  border: solid 10px transparent;
}
  /*ä¸‹*/
.triangle.bottom {
  border-top-color: #0097a7;
}
  /*ä¸Š*/
.triangle.top {
  border-bottom-color: #b2ebf2;
}
/*å·¦*/
.triangle.left {
  border-right-color: #00bcd4;
}
/*å³*/
.triangle.right {
  border-left-color: #009688;
}
```

### ç”»å°ç®­å¤´

```
<div class="box">
  <div class="box-inner">
    <div class="arrow bottom"></div>
    <div class="arrow top"></div>
    <div class="arrow right"></div>
    <div class="arrow left"></div>
  </div>
</div>

.arrow {
    display: inline-block;
    margin-right: 10px;
    /* åŸºç¡€æ ·å¼ */
    width: 0;
    height: 0;
    /* åŸºç¡€æ ·å¼ */
    border: 16px solid;
    border-color: transparent #CDDC39 transparent transparent;
    position: relative;
  }

  .arrow::after {
    content: "";
    position: absolute;
    /* é€šè¿‡ä½ç§»è¦†ç›–èƒŒæ™¯ */
    right: -20px;
    top: -16px;
    border: 16px solid;
    border-color: transparent #fff transparent transparent;
  }
  /*ä¸‹*/
  .arrow.bottom {
    transform: rotate(270deg);
  }
  /*ä¸Š*/
  .arrow.top {
    transform: rotate(90deg);
  }
  /*å·¦*/
  .arrow.left {
    transform: rotate(180deg);
  }
  /*å³*/
  .arrow.right {
    transform: rotate(0deg);
  }
```

### ç¦æ­¢é€‰æ‹©æ–‡æœ¬

```
user-select: none;
```

### æ–‡æœ¬è¶…å‡º

å•è¡Œæ–‡æœ¬è¶…è¿‡éƒ¨åˆ†æ˜¾ç¤ºçœç•¥å·

```
overflow: hidden;
text-overflow: ellipsis;
white-space: nowrap;
```

å¤šè¡Œæ–‡æœ¬è¶…è¿‡éƒ¨åˆ†æ˜¾ç¤ºçœç•¥å·

```
overflow: hidden;
text-overflow: ellipsis;
display: -webkit-box;
-webkit-box-orient: vertical;
-webkit-line-clamp: 2;
word-break: break-all;
```

è‹¥ä½¿ç”¨vueï¼Œåˆ™å¯ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼

```
display: -webkit-box;
-webkit-box-orient: vertical;
-webkit-line-clamp: 2;
overflow: hidden;
word-break: break-all;
```

### ç½‘é¡µå‘ˆç°å“€æ‚¼æ¨¡å¼

```
body{
  filter: grayscale(1);
}
```



# JS

## ä¸ºä»€ä¹ˆè¦**ç”¨setTimeoutæ¥æ¨¡æ‹ŸsetIntervalçš„è¡Œä¸º**ï¼Ÿ

è¿™é‡Œç”¨setInervalä¸æ˜¯æ›´æ–¹ä¾¿å—ï¼Ÿ

```
setTimeout(function(){Â·Â·Â· }, n); // næ¯«ç§’åæ‰§è¡Œfunction
setInterval(function(){Â·Â·Â· }, n); // æ¯éš”næ¯«ç§’æ‰§è¡Œä¸€æ¬¡function
```

å¯ä»¥çœ‹çœ‹setIntervalæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼š

> å†æ¬¡å¼ºè°ƒï¼Œå®šæ—¶å™¨æŒ‡å®šçš„æ—¶é—´é—´éš”ï¼Œè¡¨ç¤ºçš„æ˜¯ä½•æ—¶å°†å®šæ—¶å™¨çš„ä»£ç æ·»åŠ åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œä¸æ˜¯ä½•æ—¶æ‰§è¡Œä»£ç ã€‚æ‰€ä»¥çœŸæ­£ä½•æ—¶æ‰§è¡Œä»£ç çš„æ—¶é—´æ˜¯ä¸èƒ½ä¿è¯çš„ï¼Œå–å†³äºä½•æ—¶è¢«ä¸»çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯å–åˆ°ï¼Œå¹¶æ‰§è¡Œã€‚

```
setInterval(function, N)  
//å³ï¼šæ¯éš”Nç§’æŠŠfunctionäº‹ä»¶æ¨åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­
```

æˆªå›¾:https://www.vue-js.com/topic/61e13ee5cbbfd1003b11f98b

ä¸Šå›¾å¯è§ï¼ŒsetIntervalæ¯éš”100mså¾€é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªäº‹ä»¶ï¼›100msåï¼Œæ·»åŠ T1å®šæ—¶å™¨ä»£ç è‡³é˜Ÿåˆ—ä¸­ï¼Œä¸»çº¿ç¨‹ä¸­è¿˜æœ‰ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œæ‰€ä»¥ç­‰å¾…ï¼Œsome eventæ‰§è¡Œç»“æŸåæ‰§è¡ŒT1å®šæ—¶å™¨ä»£ç ï¼›åˆè¿‡äº†100msï¼ŒT2å®šæ—¶å™¨è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œä¸»çº¿ç¨‹è¿˜åœ¨æ‰§è¡ŒT1ä»£ç ï¼Œæ‰€ä»¥ç­‰å¾…ï¼›åˆè¿‡äº†100msï¼Œç†è®ºä¸Šåˆè¦å¾€é˜Ÿåˆ—é‡Œæ¨ä¸€ä¸ªå®šæ—¶å™¨ä»£ç ï¼Œä½†ç”±äºæ­¤æ—¶T2è¿˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ‰€ä»¥T3ä¸ä¼šè¢«æ·»åŠ ï¼Œç»“æœå°±æ˜¯æ­¤æ—¶è¢«è·³è¿‡ï¼›è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒT1å®šæ—¶å™¨æ‰§è¡Œç»“æŸåé©¬ä¸Šæ‰§è¡Œäº†T2ä»£ç ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰è¾¾åˆ°å®šæ—¶å™¨çš„æ•ˆæœã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒsetIntervalæœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š

1. ä½¿ç”¨setIntervalæ—¶ï¼ŒæŸäº›é—´éš”ä¼šè¢«è·³è¿‡ï¼›
2. å¯èƒ½å¤šä¸ªå®šæ—¶å™¨ä¼šè¿ç»­æ‰§è¡Œï¼›

å¯ä»¥è¿™ä¹ˆç†è§£ï¼š**æ¯ä¸ªsetTimeoutäº§ç”Ÿçš„ä»»åŠ¡ä¼šç›´æ¥pushåˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼›è€ŒsetIntervalåœ¨æ¯æ¬¡æŠŠä»»åŠ¡pushåˆ°ä»»åŠ¡é˜Ÿåˆ—å‰ï¼Œéƒ½è¦è¿›è¡Œä¸€ä¸‹åˆ¤æ–­(çœ‹ä¸Šæ¬¡çš„ä»»åŠ¡æ˜¯å¦ä»åœ¨é˜Ÿåˆ—ä¸­)**ã€‚å› è€Œæˆ‘ä»¬ä¸€èˆ¬ç”¨setTimeoutæ¨¡æ‹ŸsetIntervalï¼Œæ¥è§„é¿æ‰ä¸Šé¢çš„ç¼ºç‚¹ã€‚

# åå°ç»™ä½ 10wæ•°æ®

https://www.vue-js.com/topic/61e56bd4cbbfd1003b11fa09

# Vue3

[Vue3çš„æ¼æ´](https://www.vue-js.com/topic/61e622a4cbbfd1003b11fa19)

[å‰ç«¯æ¡†æ¶è®¾è®¡ç†å¿µä¸è¶‹åŠ¿](https://juejin.cn/post/7123178292865155102#heading-0)

## å¸¸ç”¨çš„å‘¨è¾¹ç”Ÿæ€è½®å­

**PC UI**

- Element Plus
- Ant Design Vue
- Echarts
- Quasar
- Vuetify
- NativeUI
- Prime Vue

**Mobile UI**

- Ionic Vue
- Vant
- Varlet

**å›½é™…åŒ–**

- vue-i18n
- i18next

**å…¶ä»–ç”Ÿæ€**

- VueUseï¼šé’ˆå¯¹vue3 composition apiçš„å·¥å…·åº“
- lodash.js
- moment:è§£æã€æ ¡éªŒã€æ“ä½œã€æ˜¾ç¤ºæ—¥æœŸå’Œæ—¶é—´
- validator.jsï¼šè¡¨å•éªŒè¯
- nuxt3
- Animate.cssï¼šåŠ¨ç”»åº“
- mescroll.jsï¼šæ»šåŠ¨æ’ä»¶
- swiperï¼šè½®æ’­å›¾
- day.js
- vue-draggableï¼šæ‹–æ‹½
- vue-qrï¼šç”ŸæˆäºŒç»´ç 
- vue-cropperï¼šå›¾ç‰‡è£å‰ª
- vue-lazyloadï¼šå›¾ç‰‡æ‡’åŠ è½½
- clipboard.jsï¼šå¤åˆ¶ç²˜è´´

# è®¾è®¡æ¨¡å¼

ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹

ã€ŠJavaScriptè®¾è®¡æ¨¡å¼æ ¸â¼¼åŸç†ä¸åº”â½¤å®è·µã€‹

**å…¶ä»–**

https://github.com/mynane/PDF/blob/master/JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5.pdf

https://tb-tech.oss-cn-hangzhou.aliyuncs.com/The%20Complete%20Works%20of%20Tao%20Technology%202022.pdf

**å‘å¸ƒè®¢é˜…æ¨¡å¼**

é€šä¿—ç†è§£ï¼š

> å°æ˜æœ€è¿‘çœ‹ä¸Šäº†ä¸€å¥—æˆ¿å­ï¼Œåˆ°äº†å”®æ¥¼å¤„ä¹‹åæ‰è¢«å‘ŠçŸ¥ï¼Œè¯¥æ¥¼ç›˜çš„æˆ¿å­æ—©å·²å”®ç½„ã€‚å¥½åœ¨å”®æ¥¼ MM å‘Šè¯‰å°æ˜ï¼Œä¸ä¹…ä¹‹åè¿˜æœ‰ä¸€äº›å°¾ç›˜æ¨å‡ºï¼Œå¼€å‘å•†æ­£åœ¨åŠç†ç›¸å…³æ‰‹ç»­ï¼Œæ‰‹ç»­åŠå¥½åä¾¿å¯ä»¥è´­ä¹°ã€‚ä½†åˆ°åº•æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Œç›®å‰è¿˜æ²¡æœ‰äººèƒ½å¤ŸçŸ¥é“ã€‚
>
> å°æ˜ç¦»å¼€ä¹‹å‰ï¼ŒæŠŠç”µè¯å·ç•™åœ¨äº†å”®æ¥¼å¤„ã€‚å”®æ¥¼ MM ç­”åº”ä»–ï¼Œæ–°æ¥¼ç›˜ä¸€æ¨å‡ºå°±é©¬ä¸Šå‘ä¿¡æ¯é€šçŸ¥å°æ˜ã€‚å°çº¢ã€å°å¼ºå’Œå°é¾™ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä»–ä»¬çš„ç”µè¯å·ç éƒ½è¢«è®°è½½å”®æ¥¼å¤„çš„èŠ±åå†Œä¸Šï¼Œæ–°æ¥¼ç›˜æ¨å‡ºçš„æ—¶å€™ï¼Œå”®æ¥¼ MM ä¼šç¿»å¼€èŠ±åå†Œï¼Œéå†ä¸Šé¢çš„ç”µè¯å·ç ï¼Œä¾æ¬¡å‘é€ä¸€æ¡çŸ­ä¿¡æ¥é€šçŸ¥ä»–ä»¬ã€‚

æœ‰ä¸‰ä¸ªè¦ç‚¹ï¼š

- `å‘å¸ƒè€…`ï¼šdep å¯¹è±¡
- `ç¼“å­˜åˆ—è¡¨`ï¼šdep.subscribers
- `å‘å¸ƒæ¶ˆæ¯`ï¼šdep.notify()

1. é¦–å…ˆè¦æŒ‡å®šå¥½è°å……å½“å‘å¸ƒè€…ï¼ˆæ¯”å¦‚å”®æ¥¼å¤„ï¼‰
2. ç„¶åç»™å‘å¸ƒè€…æ·»åŠ ä¸€ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œç”¨äºå­˜æ”¾å›è°ƒå‡½æ•°ä»¥ä¾¿é€šçŸ¥è®¢é˜…è€…ï¼ˆå”®æ¥¼å¤„çš„èŠ±åå†Œï¼‰
3. æœ€åå‘å¸ƒæ¶ˆæ¯çš„æ—¶å€™ï¼Œå‘å¸ƒè€…ä¼šéå†è¿™ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œä¾æ¬¡è§¦å‘é‡Œé¢å­˜æ”¾çš„è®¢é˜…è€…å›è°ƒå‡½æ•°ï¼ˆéå†èŠ±åå†Œï¼ŒæŒ¨ä¸ªå‘çŸ­ä¿¡ï¼‰

# gupiao

ETFçš„T+0äº¤æ˜“
ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼šç›´æ¥T+0å’Œå˜ç›¸T+0ã€‚
1.å½“å‰è·¨å¢ƒETFï¼ˆæ’ç”Ÿå›½ä¼ETFã€æ’ç”ŸETFï¼‰ã€å€ºåˆ¸ETFã€é»„é‡‘ETFã€è´§å¸ETFåŸºæœ¬éƒ½å¯ä»¥å®ç°ç›´æ¥T+0äº¤æ˜“ã€‚
2ã€å˜ç›¸T+0ï¼Œæ˜¯æŒ‡Tæ—¥ä¹°å…¥çš„ETFè™½ç„¶Tæ—¥ä¸å¯ä»¥å–å‡ºï¼Œä½†å´å¯ä»¥Tæ—¥èµå›ï¼Œèµå›å¾—åˆ°çš„ä»½é¢Tæ—¥å¯ä»¥å–å‡ºã€‚åä¹‹ï¼ŒTæ—¥ä¹°å…¥çš„è‚¡ç¥¨Tæ—¥å¯ä»¥ç”³è´­ETFä»½é¢ï¼Œç”³è´­å¾—åˆ°çš„ä»½é¢å¯ä»¥Tæ—¥å–å‡ºã€‚æ¯”å¦‚ä¸Šè¯50ETF

é›†åˆç«ä»·
9:15â€”9:20ï¼šè¿™äº”åˆ†é’Ÿæ˜¯å¼€æ”¾å¼é›†åˆç«ä»·ï¼Œå¯ä»¥å§”æ‰˜ä¹°è¿›å’Œå–å‡ºçš„å•å­ã€‚è¿™æ®µæ—¶é—´æ˜¯å¯ä»¥æ’¤å•çš„ï¼Œå› æ­¤è¿™ä¸ªæ—¶é—´æ®µä½ çœ‹åˆ°çš„æ´»è·ƒä¸ªè‚¡çš„æˆäº¤é‡åŸºæœ¬ä¸Šéƒ½æ˜¯å‡çš„ï¼Œå› ä¸ºå¾ˆå¤šå¤§å•æ˜¯æ•…æ„æŒ‚çš„ï¼Œä»–ä»¬ä¼šåœ¨9:19:30ä¹‹åæ’¤å•ï¼Œæ ¹æ®å¼€ç›˜ä»·çš„æœ€å¤§æˆäº¤é‡åŸåˆ™ï¼Œæ’¤å•åæˆäº¤é‡æœ€å¤§çš„ä»·æ ¼ä¼šè¢«æ‰“ä¸‹æ¥å¾ˆå¤šã€‚

9:20â€”9:25ï¼šè¿™ä¸ªæ—¶é—´æ®µäº¤æ˜“æ‰€æ¥å—ç”³æŠ¥ï¼ŒåŒæ ·å¯ä»¥å§”æ‰˜ä¹°è¿›å’Œå–å‡ºçš„å•å­ï¼Œä½†æ˜¯ä¸å¯ä»¥æ’¤å•ï¼Œå› æ­¤è¿™ä¸ªæ—¶é—´æ®µä½ çœ‹åˆ°çš„å§”æ‰˜å•å­æ˜¯çœŸå®çš„ã€‚ä½†æ˜¯!æˆäº¤ä»·æœªå¿…ï¼Œåˆ«å¿˜äº†å¼€ç›˜ä»·çš„å½¢æˆæ˜¯æœ€å¤§æˆäº¤é‡åŸåˆ™ï¼Œå¦‚æœçœŸæ­£çš„å¤§èµ„é‡‘æƒ³è¦å‡ºè´§ï¼Œä»–ä¼šåœ¨9:24:30ä¹‹åæŒ‚çœŸæ­£çš„å¤§å–å•ï¼Œä»·æ ¼ä¼šç¬é—´è¢«æ‰“ä¸‹æ¥å¾ˆå¤š

9:25â€”9:30ï¼šæ–°è§„åˆ™ä¹‹åï¼Œè¿™ä¸ªæ—¶é—´æ®µäº¤æ˜“æ‰€ä¸æ¥å—ä¹°å–ç”³æŠ¥å’Œæ’¤å•ã€‚ä½†æ˜¯ï¼Œåœ¨äº¤æ˜“è½¯ä»¶ä½ ä¾ç„¶å¯ä»¥ä¸‹å•ï¼Œåªæ˜¯è¿™ä¸ªå§”æ‰˜æš‚æ—¶ä¼šè¢«å­˜æ”¾åˆ°åˆ¸å•†çš„ç³»ç»Ÿé‡Œï¼Œç­‰åˆ°9:30å¼€ç›˜ä¹‹åï¼Œåˆ¸å•†ä¼šæŒ‰ç…§ä¸‹å•çš„æ—¶é—´ä¼ é€åˆ°äº¤æ˜“æ‰€ã€‚

14:57-15:00ï¼šæ·±å¸‚çš„è‚¡ç¥¨åœ¨è¿™ä¸ªé˜¶æ®µè¿›è¡Œé›†åˆç«ä»·å½¢æˆæ”¶ç›˜ä»·ï¼Œè¿™ä¸ªæ—¶é—´åªèƒ½æ¥å—ä¹°è¿›å’Œå–å‡ºç”³æŠ¥ï¼Œä¸èƒ½æ’¤å•ã€‚

# Webpack

[æ˜é‡‘ç«™å†… webpack ä¼˜ç§€æ–‡ç« æ±‡æ€»](https://juejin.cn/post/6844903986185650190)

# Vue Test Utils

- [ä½¿ç”¨ TDD å¼€å‘ç»„ä»¶ --- Notification](https://juejin.cn/post/6844904013503152141#heading-19)
- [ã€element3-å¼€å‘æ—¥è®°ã€‘æ‰‹æ‘¸æ‰‹æ•™ä½ é‡å†™ Button ç»„ä»¶](https://juejin.cn/post/6898959238576472077#heading-0)

# SolidJS

## SolidJSæ˜¯ä»€ä¹ˆ

å·ç§°æ”¯æŒç°ä»£å‰ç«¯ç‰¹æ€§ï¼š**JSX**ã€**Fragments**ã€**Context**ã€**Portals**ã€**Suspense**ã€**Streaming SSR**ã€**Error Boundaries**ã€**å¹¶å‘æ¸²æŸ“**ç­‰ç°ä»£åŠŸèƒ½ã€‚

åˆä¸€ä¸ªæ‘’å¼ƒ è™šæ‹ŸDOMï¼Œè·Ÿ Svelte ä¸€æ ·èµ°ç¼–è¯‘å‹è·¯çº¿çš„æ¡†æ¶ï¼Œæ²¡äº†è™šæ‹ŸDOM è¿è¡Œæ—¶ï¼Œåˆé€šè¿‡ä¼˜ç§€çš„å“åº”å¼ç³»ç»Ÿä¿è¯æ›´æ–°é¢—ç²’åº¦éå¸¸å°ï¼Œæ€§èƒ½çˆ†è¡¨ã€‚å’Œ Svelte ä¸åŒçš„æ˜¯ Solid ç›´æ¥å€Ÿç”¨äº† React ç¤¾åŒºçš„ JSX æ¥ç¼–å†™æ¨¡æ¿ï¼Œæ²¡æœ‰åƒ Vue Svelte é‚£æ ·å»è‡ªå®šä¹‰æ¨¡æ¿è¯­æ³•ã€‚æ€»ä½“æ¥è®² React æœ‰çš„ API å¤§éƒ¨åˆ†éƒ½èƒ½åœ¨å®ƒé‡Œé¢æ‰¾åˆ°ï¼Œç”šè‡³åŒ…æ‹¬ React 18 çš„ useTransitionï¼ŒSuspenseList. å¦å¤–ä¸æä¾› Class ç»„ä»¶ç©æ³•ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½æ˜¯å‡½æ•°ç»„ä»¶ï¼Œä¸”è¯¥ç»„ä»¶å‡½æ•°åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚å†…ç½®äº† For ç»„ä»¶æ¥æ›¿ä»£ map æ¥ä¼˜åŒ–æ€§èƒ½ã€‚æ”¯æŒè‡ªå®šæŒ‡ä»¤ç­‰

## ä½¿ç”¨

```
import { render } from 'solid-js/web';
import { createSignal, createEffect } from 'solid-js';

const Counter = () => {
  const [getCount, setCount] = createSignal(0);
  const add = () => setCount(getCount() + 1);
  createEffect(() => {
    console.log('count is change:', getCount());
  });

  return (
    <button type='button' onClick={add}>
      {getCount()}
    </button>
  );
};

render(() => <Counter />, document.getElementById('root'));
```

**SolidJS**ä¸ä»…æ‰“åŒ…ä½“ç§¯å°ï¼Œæ€§èƒ½ä¹Ÿæ˜¯ **Number 1**

å‚ç…§[js-framework-benchmark](https://link.juejin.cn/?target=https%3A%2F%2Fkrausest.github.io%2Fjs-framework-benchmark%2Findex.html) è·‘åˆ†ç»“æœï¼šæˆªå›¾https://juejin.cn/post/7018846783203704863#heading-1

## ç‰¹ç‚¹

### å¹³è¡¡äº† jsx ä¸ template çš„åˆ©å¼Š

**jsx** å’Œ **template** çš„ä¼˜ç¼ºç‚¹ï¼š

> jsx
>
> - ä¼˜ç‚¹ï¼šä½œä¸º`js`çš„è¯­æ³•ç³–æ‹¥æœ‰é«˜åº¦çµæ´»æ€§ï¼Œå¯ä»¥éšæ„ç¼–å†™
> - ç¼ºç‚¹ï¼šå› ä¸ºè¿‡äºçµæ´»åœ¨ **ç¼–è¯‘é˜¶æ®µ** å¾ˆéš¾åˆ†ææ“ä½œæ„å›¾
>
> template
>
> - ä¼˜ç‚¹ï¼šå› ä¸ºè¯­æ³•æœ‰é™åˆ¶ï¼Œå¤§éƒ¨åˆ†å¸¦æœ‰ **æ“ä½œæ„å›¾ï¼ˆv-ifã€v-forï¼‰** çš„ä»£ç éƒ½å¯ä»¥åœ¨ **ç¼–è¯‘é˜¶æ®µ**è¢«è¯†åˆ«ä»¥åšä¼˜åŒ–
> - ç¼ºç‚¹ï¼šå†™æ³•å—é™ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸å¦‚`jsx`çµæ´»

**Vue3** å¯¹æ¯” **Vue2** æ€§èƒ½ä¹‹æ‰€ä»¥å®ç°äº†ä¸€ä¸ªè´¨çš„é£è·ƒï¼Œè¿™å…¶ä¸­å°±ç¦»ä¸å¼€ **ç¼–è¯‘é˜¶æ®µä¼˜åŒ–**ã€‚

> 1ã€ æ¯”å¦‚åœ¨**ç¼–è¯‘é˜¶æ®µ**æ ‡è®°å‡º`template`ä¸­æ°¸è¿œä¸ä¼šå˜åŒ–çš„èŠ‚ç‚¹ä½œä¸º**é™æ€èŠ‚ç‚¹**å­˜å‚¨ï¼Œå°†æ¥æ›´æ–°æ—¶ç›´æ¥ç»•è¿‡ä»–ä»¬ï¼›
>
> 2ã€æå‰å¯¹`v-ifã€v-for`è¿™ä¸€ç±»**åŒºå—**åšåŒºåˆ†ï¼Œå°†æ¥diffæ—¶ç»•è¿‡ä¸å¿…è¦çš„åˆ¤æ–­ï¼›
>
> 3ã€ç»‘å®š`props`æ—¶è®°å½•å“ªäº›**å±æ€§**å¯èƒ½ä¼šå˜ï¼Œå°†æ¥ **diff** æ—¶åªå¯¹æ¯”â€œå¯èƒ½ä¼šå˜åŒ–çš„åŠ¨æ€èŠ‚ç‚¹å’Œå±æ€§â€ï¼Œè·³è¿‡â€œæ°¸è¿œä¸ä¼šå˜åŒ–çš„èŠ‚ç‚¹å’Œå±æ€§â€ã€‚
>
> é™¤æ­¤ä¹‹å¤–è¿˜æœ‰**ç¼“å­˜äº‹ä»¶å¤„ç†ç¨‹åº**ç­‰ç­‰

ä½†JSXå°±ä¸èƒ½è¯†åˆ«æ“ä½œæ„å›¾ï¼Œä¸»è¦æ˜¯å†™æ³•å¤ªçµæ´»ã€‚å¦‚æœæ¯ç§æƒ…å†µéƒ½å»åˆ¤æ–­ä¸€éï¼Œé‚£ä¹ˆ **ç¼–è¯‘é˜¶æ®µ** å°†ä¼šéå¸¸å¤æ‚ä¸”è€—æ—¶ï¼Œå¦å¤–æ˜¾å¾—ä¹Ÿéå¸¸éº»ç“œã€‚

```
v-ifçš„å†™æ³•å°±æœ‰ä¸‰ç§ï¼š
// å†™æ³•1
return status === 1 ? <span>é€šè¿‡</span> : status === 2 ? <span>æ‹’ç»</span> : null;
// å†™æ³•2
return (
  <>
    {status === 1 && <span>é€šè¿‡</span>}
    {status === 2 && <span>æ‹’ç»</span>}
  </>
);
// å†™æ³•3
switch (status) {
  case 1:
    return <span>é€šè¿‡</span>;
  case 2:
    return <span>æ‹’ç»</span>;
}
```

**SolidJS** é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯ï¼šåœ¨ **JSX** çš„åŸºç¡€ä¸Šåšäº†ä¸€å±‚è§„èŒƒï¼Œä¸­æ–‡è¯‘åä¸º [æ§åˆ¶æµ](https://link.juejin.cn/?target=https%3A%2F%2Fwww.solidjs.com%2Fdocs%2Flatest%2Fapi%23%E6%8E%A7%E5%88%B6%E6%B5%81)ã€‚å†™æ³•ä¸Šç±»ä¼¼æŸç§é¢„è®¾çš„ç»„ä»¶ï¼Œç”¨äº**ç¼–è¯‘é˜¶æ®µ**ä¼˜åŒ–ã€‚è¿™æ ·åœ¨**ç¼–è¯‘é˜¶æ®µ**å°±å¯ä»¥åš**æ„å›¾åˆ†æ**ï¼Œæå‰çŸ¥é“è¿™æ˜¯åœ¨**åšæŒ‰æ¡ä»¶æ¸²æŸ“**ï¼Œç„¶åç¼–è¯‘æˆå¯¹åº”çš„**domæ“ä½œ**å³å¯ã€‚

SolidJSå°ç»“ï¼š

> - å³å€Ÿé‰´äº† **template** æ›´å®¹æ˜“åšç¼–è¯‘é˜¶æ®µä¼˜åŒ–çš„ä¼˜åŠ¿
> - åˆä¿ç•™äº† **JSX** çš„çµæ´»æ€§

### No Dom Diff

**No Dom Diff** æ˜¯è¯´ **SolidJS**åœ¨**æ›´æ–°ç²’åº¦**æ–¹é¢ï¼Œæ‘’å¼ƒäº†**è™šæ‹Ÿdom**ï¼Œé‡‡ç”¨**èŠ‚ç‚¹çº§æ›´æ–°**ã€‚

ç›®å‰å‰ç«¯ä¸»æµçš„å‡ ç§æ–¹æ¡ˆï¼š

- åº”ç”¨çº§æ›´æ–°ï¼šçŠ¶æ€æ›´æ–°ä¼šå¼•èµ·æ•´ä¸ªåº”ç”¨`render`ï¼Œå…·ä½“æ¸²æŸ“å“ªäº›å†…å®¹å–å†³äº**åè°ƒ**çš„ç»“æœã€‚ä»£è¡¨ä½œæœ‰ **React**(å› ä¸º **React** æ¯æ¬¡æ›´æ–°éƒ½ä¼šé‡æ–°èµ°ä¸€éæ›´æ–°æµç¨‹ï¼Œåšè¿™äº›é™åˆ¶æ˜¯ä¸ºäº†è·å–åˆ°å®Œæ•´çš„**VDomæ ‘/Fiberæ ‘**ï¼Œé€šè¿‡ **diffæ–°æ—§ä¸¤æ£µæ ‘**æ¥å†³å®šçœŸæ­£æ›´æ–°å“ªäº›ç»„ä»¶ï¼Œæ‰€ä»¥ **React** å¹¶ä¸æ˜¯**ç»„ä»¶çº§æ›´æ–°**)
- ç»„ä»¶çº§æ›´æ–°ï¼šçŠ¶æ€æ›´æ–°æ—¶åªä¼šå¼•èµ·ç»‘å®šäº†è¯¥çŠ¶æ€çš„ç»„ä»¶æ¸²æŸ“ï¼Œå…·ä½“æ¸²æŸ“å“ªäº›å†…å®¹åŒæ ·å–å†³äº**åè°ƒ**çš„ç»“æœã€‚ä»£è¡¨ä½œæœ‰**vue2.x**
- èŠ‚ç‚¹çº§æ›´æ–°ï¼šçŠ¶æ€æ›´æ–°æ—¶ç›´æ¥è§¦æ³•ç»‘å®šè¯¥çŠ¶æ€çš„èŠ‚ç‚¹æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯**æŒ‡å‘å‹æ›´æ–°**ã€‚ä»£è¡¨ä½œæœ‰**vue1.x**ã€**Svelte**ã€**SolidJS**

è€Œ**SolidJS**å¯¹äºä¸‰å¤§å¯¹è±¡å‡é‡‡ç”¨**ç®€å•å¯¹è±¡**å­˜å‚¨ï¼Œå¦å¤–ä¸éœ€è¦**é€’å½’è§‚å¯Ÿ**ï¼Œæ‰€ä»¥å ç”¨å†…å­˜éå¸¸å°‘ã€‚å¯¹äº**å¦‚ä½•æ›´æ–°dom**ï¼Œå…·ä½“çš„åšæ³•æ˜¯ï¼šåœ¨**ç¼–è¯‘é˜¶æ®µ**æå‰ç”Ÿæˆç±»ä¼¼ `insert`ã€`update`ã€`delete`çš„**domæ“ä½œ**æ–¹æ³•ï¼Œå°†æ¥æ›´æ–°æ—¶ç›´æ¥è°ƒç”¨ã€‚

### é‡Â·ç¼–è¯‘æ—¶

- æå‰ç”ŸæˆèŠ‚ç‚¹æ¸²æŸ“æ–¹æ³•

åˆšæ‰è¯´åˆ° **SolidJS** åœ¨ **jsx** ä¸­å€Ÿé‰´äº†éƒ¨åˆ† **template** çš„è§„èŒƒå†™æ³•ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µ **åˆ†ææ„å›¾**ï¼Œæå‰ç”Ÿæˆå¯¹åº”çš„**domæ“ä½œæ–¹æ³•**

- æŒ‰éœ€æ‰“åŒ…ï¼Œç¼©å°ä½“ç§¯

è¿™ä¸€æ­¥ä¹Ÿå°±æ˜¯ **tree-shaking**ï¼Œåªæ‰“åŒ…ç”¨åˆ°çš„æ¨¡å—ï¼Œè¿‘ä¸€æ­¥ç¼©å°æ‰“åŒ…èµ„æºä½“ç§¯ã€‚

### è½»Â·è¿è¡Œæ—¶

ç”±äºæ²¡æœ‰äº†**diff**è¿™ä¸€å¤§è§„æ¨¡è®¡ç®—ï¼Œä½¿å¾—è¿è¡Œæ—¶ä»£ç æ›´è½»é‡ï¼Œæ‰€ä»¥**SolidJS**åœ¨æ›´æ–°æ—¶ä¹Ÿæ›´**ç®€æ´**ã€‚

**SolidJS** åœ¨æ›´æ–°æ—¶çš„**jsè°ƒç”¨æ ˆ**å¦‚å›¾ï¼šæˆªå›¾https://juejin.cn/post/7018846783203704863#heading-3

**React v16** åœ¨æ›´æ–°æ—¶çš„**jsè°ƒç”¨æ ˆ**å¦‚å›¾ï¼šæˆªå›¾https://juejin.cn/post/7018846783203704863#heading-3

### ä¸è¢«é¡ºåºé™åˆ¶çš„ hook

è¯´åˆ°å‰ç«¯æ¡†æ¶ä¸­çš„ **Hook**ï¼Œæœ€å…ˆå°†è¿™ä¸ªæ–¹æ¡ˆè½åœ°çš„æ˜¯**React**ï¼Œä½†ç”±äº**React**ä¸€ç›´æ¨å´‡ **immutable** æ€æƒ³ï¼Œæ¯æ¬¡æ›´æ–°å¿…é¡»é‡æ–°èµ°ä¸€éæ•´ä¸ªæ ‘çš„æ›´æ–°æµç¨‹ï¼Œä½¿å¾— **React Hook** ä¸å¯ä»¥åœ¨æ¡ä»¶å¾ªç¯ä¸­ä½¿ç”¨ï¼Œå¦åˆ™**å¯èƒ½**ä½¿æ¸²æŸ“ç»“æœå—åˆ°å½±å“ã€‚

åæ¥å°¤å¤§å‘å¸ƒäº†**Vue3.0**ï¼Œä¼´éšè€Œæ¥çš„ä¸€å¤§ç‰¹æ€§æ˜¯**Composition API**ï¼Œä¿—ç§°**Vue3 hook**ï¼Œç”±äº**Vue2**ä»¥åéƒ½é‡‡ç”¨**ç»„ä»¶çº§**çš„**æ›´æ–°ç²’åº¦**ï¼Œå†åŠ ä¸Š**å“åº”å¼åŸç†**é‡‡ç”¨çš„æ˜¯**è‡ªåŠ¨æ”¶é›†ä¾èµ–**ï¼Œæ‰€ä»¥**Vue3 hook**ä¸ä¼šæœ‰é¡ºåº/æ¡ä»¶çš„é™åˆ¶ï¼Œå¦å¤–è¿˜å¯ä»¥åµŒå¥—ä½¿ç”¨ã€‚

**SolidJS**çš„**å“åº”å¼åŸç†**ä¸»è¦å€Ÿé‰´äº†**React Hook**çš„æ€æƒ³ï¼ŒåŒæ—¶ä¹Ÿä¿ç•™äº†**Vue3**çš„**ä¾èµ–æ”¶é›†æ¨¡å‹**ï¼Œæ‰€ä»¥ç”¨èµ·æ¥éå¸¸ä¸æ»‘ã€‚

### å…¶ä»–

- è„šæ‰‹æ¶ï¼š**degit**ï¼Œå†…éƒ¨é›†æˆäº† **vite**ã€‚
- æ”¯æŒ`TS`ä¸”**ç±»å‹**å‹å¥½
- ç°ä»£å‰ç«¯æ¡†æ¶å¤§éƒ¨åˆ†ç‰¹æ€§ï¼š`Fragments`ã€`Portals`ã€`Context`ã€`Suspense`ã€`äº‹ä»¶å§”æ‰˜`ã€`SSR`ç­‰ç­‰

**å‚è€ƒ**

- [æ¯”Reactè¿˜Vue3çš„æ¡†æ¶SolidJS](https://juejin.cn/post/7018846783203704863#heading-1)

# Vueä¸React

## å¿ƒæ™ºè´Ÿæ‹…

**Reactçš„å¿ƒæ™ºè´Ÿæ‹…**

ä¸èƒ½åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ï¼Œ`useMemo` å’Œ `useCallback` éœ€è¦æ˜¾å¼æŒ‡å®šä¾èµ–ï¼Œè§£å†³å­ç»„ä»¶é‡æ–°æ¸²æŸ“å¯èƒ½è¿˜éœ€è¦é…åˆ `React.memo` ä½¿ç”¨ç­‰ç­‰ã€‚è™½ç„¶æœ‰å¯¹åº”çš„ `eslint-plugin` å¯ä»¥å¸®åŠ©å¡«å……ä¾èµ–ï¼Œä½†æ˜¯ä¾èµ–é¡¹ä¸€æ—¦å¾ˆå¤šï¼Œä»£ç çš„å¯èƒ½è¯»ä¼šéå¸¸å·®ã€‚ç°åœ¨æ™®éçš„è§‚ç‚¹æ˜¯è®¡ç®—é‡å¤§çš„å†ç”¨ `useMemo`, è€Œ `useCallback` èƒ½ä¸ç”¨å°±ä¸ç”¨ã€‚å› ä¸ºè¿™ç‚¹ä¼˜åŒ–å¯¹æ€§èƒ½çš„å½±å“æ˜¯å¾®ä¹å…¶å¾®çš„ï¼Œ99% çš„æƒ…å†µä¸‹éƒ½ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œç­‰åˆ°å‡ºç°é—®é¢˜çš„æ—¶å€™å†è¿›è¡Œä¼˜åŒ–ä¹Ÿä¸è¿Ÿã€‚

**Vueçš„å¿ƒæ™ºè´Ÿæ‹…**

> å®šä¹‰çŠ¶æ€

refå®šä¹‰çš„å˜é‡ä½¿ç”¨æ—¶ï¼Œéœ€è¦.valueã€‚è™½ç„¶æœ‰äº† `$ref` è¯­æ³•ç³–ï¼Œä½†æœ€æ–°å·²ç»åºŸå¼ƒäº†ã€‚è§£æ„ `props` ä¹Ÿä¼šå‡ºç°å“åº”ä¸¢å¤±çš„é—®é¢˜ï¼Œè¿˜è¦ä½¿ç”¨ `toRefs` æ¥è§£å†³ã€‚

> æ’æ§½

å› ä¸ºåœ¨ `react` ä¸­ä¸‡ç‰©çš† `props`ã€‚Vueä¸­éœ€è¦å…·åæ’æ§½å’Œä½œç”¨äºæ’æ§½ç­‰ã€‚

> props å’Œ emits çš„å®šä¹‰

å±æ€§ å’Œ äº‹ä»¶ è¿˜éœ€è¦åˆ†æˆ defineProps å’Œ defineEmits ä¸¤ä¸ª apiã€‚åè§‚ reactï¼Œè¿˜æ˜¯ä¸‡ç‰©çš† props ã€‚

> ä¾¦å¬ watch

watchç›‘å¬å¯¹è±¡é‡Œçš„æŸä¸ªå±æ€§æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¿˜éœ€è¦æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¿˜åˆ†ä¸ºå¥½å¤šç§ï¼Œwatchã€watchPostEffectã€watchSyncEffectã€watchEffectã€‚watch çš„ç¬¬ä¸‰ä¸ªå‚æ•°åˆæœ‰å¾ˆå¤šå±æ€§ã€‚

> æ¸²æŸ“å‡½æ•°

`vue3` æä¾›äº†ä¸€ä¸ª `h` å‡½æ•°ï¼Œä½†è¿˜æ˜¯å¾ˆéš¾ç”¨,è¿˜ä¸å¦‚tsxã€‚

> typescript æ”¯æŒ

å­˜åœ¨è¯­æ³•é™åˆ¶ã€‚ç»™ `defineProps` å®šä¹‰çš„ ts ç±»å‹ï¼Œä¸èƒ½ä»å…¶å®ƒæ–‡ä»¶å¯¼å…¥ï¼Œåªèƒ½å†™åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œã€‚æƒ³åˆ†å¼€å†™åˆ°åˆ«çš„æ–‡ä»¶ï¼Œåªèƒ½ä¸ä½¿ç”¨ ts æ¥å®šä¹‰ç±»å‹ï¼Œè¦ä½¿ç”¨ `defineProps` çš„ç¬¬ä¸€ä¸ªå‚æ•°æ¥æŒ‡å®šç±»å‹ï¼Œè¿™æ ·æ‰èƒ½ä»åˆ«çš„æ–‡ä»¶å¯¼å…¥äº†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤§å¤šæ•°ç»„ä»¶åº“æ²¡æœ‰ä½¿ç”¨ ts æ¥å®šä¹‰ç±»å‹çš„åŸå› ï¼Œè¿™æ ·å®šä¹‰çš„ç±»å‹è¦ç”¨ `ExtractPropTypes` æ¥æå– ts ç±»å‹ã€‚

> breaking change

`vue2` å‡çº§åˆ° `vue3` æ˜¯ä¸å…¼å®¹çš„ï¼Œæ—§é¡¹ç›®å‡çº§æ˜¯å¾ˆéº»çƒ¦çš„ã€‚åè§‚ `react`ï¼Œå‡ ä¹æ˜¯æ²¡ä»€ä¹ˆå½±å“ã€‚

# Vue3æºç 

**ç”Ÿæ€æ•´ç†**

> **æ„å»ºå·¥å…·**ï¼š nuxt3: ä¸€æ¬¾åŸºäº`Vue3`çš„æ··åˆå¼€å‘æ¡†æ¶ã€‚ vite: å‰ç«¯å¼€å‘ä¸æ„å»ºå·¥å…·.
>
> **å·¥å…·åº“**ï¼š vueuse: é’ˆå¯¹vue3 composition apiçš„å·¥å…·åº“ã€‚
>
> **è·¯ç”±ç®¡ç†åº“**ï¼š vue-router4
>
> **çŠ¶æ€ç®¡ç†åº“**ï¼š pinia
>
> ------
>
> **ç»„ä»¶åº“**:
>
> **UIæ¡†æ¶**: [element plus](https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2F)ã€[ant design vue](https://link.juejin.cn?target=https%3A%2F%2Fwww.antdv.com%2F)ã€[quasar](https://link.juejin.cn?target=https%3A%2F%2Fquasar.dev%2F)ã€[vuetify3beta](https://link.juejin.cn?target=https%3A%2F%2Fnext.vuetifyjs.com%2Fen%2Fgetting-started%2Finstallation%2F)ã€[naive ui](https://link.juejin.cn?target=https%3A%2F%2Fwww.naiveui.com%2Fen-US%2Fos-theme)ã€[prime vue](https://link.juejin.cn?target=https%3A%2F%2Fwww.primefaces.org%2F)
>
> **ç§»åŠ¨ç«¯**: [ionic](https://link.juejin.cn?target=https%3A%2F%2Fionicframework.com%2F)ã€[vant](https://link.juejin.cn?target=https%3A%2F%2Fyouzan.github.io%2Fvant%2F%23%2Fen-US)ã€[varlet](https://link.juejin.cn?target=https%3A%2F%2Fmadewithvuejs.com%2Fvarlet-ui)ã€[nutui](https://link.juejin.cn?target=https%3A%2F%2Fnutui.jd.com%2F%23%2Fstart)ã€[waveui](

# Viteæ€§èƒ½ä¼˜åŒ–

[è®°ä¸€æ¬¡Viteæ‰“åŒ…ä¼˜åŒ–](https://developer.aliyun.com/article/1166403)

ä¸‰éƒ¨æ›²ï¼š

- Network åˆ†æ
- Lighthouse åˆ†æ
- Bundle åˆ†æ

# æ•°æ®ç»“æ„-1äº¿æ•°æ®ä¸­è®¿é—®æŸæ•°æ®

å…ˆæ¥çœ‹ä¸€ä¸‹éƒ½æœ‰å“ªäº›é¢˜ç›®ï¼š

- å¦‚ä½•ä»å¤§é‡çš„ URL ä¸­æ‰¾å‡ºç›¸åŒçš„ URLï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•ä»å¤§é‡æ•°æ®ä¸­æ‰¾å‡ºé«˜é¢‘è¯ï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•æ‰¾å‡ºæŸä¸€å¤©è®¿é—®ç™¾åº¦ç½‘ç«™æœ€å¤šçš„ IPï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•åœ¨å¤§é‡çš„æ•°æ®ä¸­æ‰¾å‡ºä¸é‡å¤çš„æ•´æ•°ï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•åœ¨å¤§é‡çš„æ•°æ®ä¸­åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦å­˜åœ¨ï¼Ÿï¼ˆè…¾è®¯ï¼‰
- å¦‚ä½•æŸ¥è¯¢æœ€çƒ­é—¨çš„æŸ¥è¯¢ä¸²ï¼Ÿï¼ˆè…¾è®¯ï¼‰
- å¦‚ä½•ç»Ÿè®¡ä¸åŒç”µè¯å·ç çš„ä¸ªæ•°ï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•ä» 5 äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºä¸­ä½æ•°ï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•æŒ‰ç…§ query çš„é¢‘åº¦æ’åºï¼Ÿï¼ˆç™¾åº¦ï¼‰
- å¦‚ä½•æ‰¾å‡ºæ’åå‰ 500 çš„æ•°ï¼Ÿï¼ˆè…¾è®¯ï¼‰

ç­”æ¡ˆå‘¢ï¼Ÿå¾€ä¸‹çœ‹~

## 1. å¦‚ä½•ä»å¤§é‡çš„ URL ä¸­æ‰¾å‡ºç›¸åŒçš„ URLï¼Ÿ

**é¢˜ç›®æè¿°**

ç»™å®š aã€b ä¸¤ä¸ªæ–‡ä»¶ï¼Œå„å­˜æ”¾ 50 äº¿ä¸ª URLï¼Œæ¯ä¸ª URL å„å  64Bï¼Œå†…å­˜é™åˆ¶æ˜¯ 4Gã€‚è¯·æ‰¾å‡º aã€b ä¸¤ä¸ªæ–‡ä»¶å…±åŒçš„ URLã€‚

**è§£ç­”æ€è·¯**

æ¯ä¸ª URL å  64Bï¼Œé‚£ä¹ˆ 50 äº¿ä¸ª URLå ç”¨çš„ç©ºé—´å¤§å°çº¦ä¸º 320GBã€‚

> 5,000,000,000 * 64B â‰ˆ 5GB * 64 = 320GB

ç”±äºå†…å­˜å¤§å°åªæœ‰ 4Gï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ URL åŠ è½½åˆ°å†…å­˜ä¸­å¤„ç†ã€‚å¯¹äºè¿™ç§ç±»å‹çš„é¢˜ç›®ï¼Œä¸€èˆ¬é‡‡ç”¨**åˆ†æ²»ç­–ç•¥**ï¼Œå³ï¼šæŠŠä¸€ä¸ªæ–‡ä»¶ä¸­çš„ URL æŒ‰ç…§æŸä¸ªç‰¹å¾åˆ’åˆ†ä¸ºå¤šä¸ªå°æ–‡ä»¶ï¼Œä½¿å¾—æ¯ä¸ªå°æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 4Gï¼Œè¿™æ ·å°±å¯ä»¥æŠŠè¿™ä¸ªå°æ–‡ä»¶è¯»åˆ°å†…å­˜ä¸­è¿›è¡Œå¤„ç†äº†ã€‚

**æ€è·¯å¦‚ä¸‹**ï¼š

é¦–å…ˆéå†æ–‡ä»¶ aï¼Œå¯¹éå†åˆ°çš„ URL æ±‚ `hash(URL) % 1000`ï¼Œæ ¹æ®è®¡ç®—ç»“æœæŠŠéå†åˆ°çš„ URL å­˜å‚¨åˆ° a0, a1, a2, ..., a999ï¼Œè¿™æ ·æ¯ä¸ªå¤§å°çº¦ä¸º 300MBã€‚ä½¿ç”¨åŒæ ·çš„æ–¹æ³•éå†æ–‡ä»¶ bï¼ŒæŠŠæ–‡ä»¶ b ä¸­çš„ URL åˆ†åˆ«å­˜å‚¨åˆ°æ–‡ä»¶ b0, b1, b2, ..., b999 ä¸­ã€‚è¿™æ ·å¤„ç†è¿‡åï¼Œæ‰€æœ‰å¯èƒ½ç›¸åŒçš„ URL éƒ½åœ¨å¯¹åº”çš„å°æ–‡ä»¶ä¸­ï¼Œå³ a0 å¯¹åº” b0, ..., a999 å¯¹åº” b999ï¼Œä¸å¯¹åº”çš„å°æ–‡ä»¶ä¸å¯èƒ½æœ‰ç›¸åŒçš„ URLã€‚é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºè¿™ 1000 å¯¹å°æ–‡ä»¶ä¸­ç›¸åŒçš„ URL å°±å¥½äº†ã€‚

æ¥ç€éå† ai( `iâˆˆ[0,999]`)ï¼ŒæŠŠ URL å­˜å‚¨åˆ°ä¸€ä¸ª HashSet é›†åˆä¸­ã€‚ç„¶åéå† bi ä¸­æ¯ä¸ª URLï¼Œçœ‹åœ¨ HashSet é›†åˆä¸­æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œè¯´æ˜è¿™å°±æ˜¯å…±åŒçš„ URLï¼Œå¯ä»¥æŠŠè¿™ä¸ª URL ä¿å­˜åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚

**æ–¹æ³•æ€»ç»“**

1. åˆ†è€Œæ²»ä¹‹ï¼Œè¿›è¡Œå“ˆå¸Œå–ä½™ï¼›
2. å¯¹æ¯ä¸ªå­æ–‡ä»¶è¿›è¡Œ HashSet ç»Ÿè®¡ã€‚

## 2. å¦‚ä½•ä»å¤§é‡æ•°æ®ä¸­æ‰¾å‡ºé«˜é¢‘è¯ï¼Ÿ

**é¢˜ç›®æè¿°**

æœ‰ä¸€ä¸ª 1GB å¤§å°çš„æ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªè¯ï¼Œæ¯ä¸ªè¯çš„å¤§å°ä¸è¶…è¿‡ 16Bï¼Œå†…å­˜å¤§å°é™åˆ¶æ˜¯ 1MBï¼Œè¦æ±‚è¿”å›é¢‘æ•°æœ€é«˜çš„ 100 ä¸ªè¯(Top 100)ã€‚

**è§£ç­”æ€è·¯**

ç”±äºå†…å­˜é™åˆ¶ï¼Œæˆ‘ä»¬ä¾ç„¶æ— æ³•ç›´æ¥å°†å¤§æ–‡ä»¶çš„æ‰€æœ‰è¯ä¸€æ¬¡è¯»åˆ°å†…å­˜ä¸­ã€‚å› æ­¤ï¼ŒåŒæ ·å¯ä»¥é‡‡ç”¨**åˆ†æ²»ç­–ç•¥**ï¼ŒæŠŠä¸€ä¸ªå¤§æ–‡ä»¶åˆ†è§£æˆå¤šä¸ªå°æ–‡ä»¶ï¼Œä¿è¯æ¯ä¸ªæ–‡ä»¶çš„å¤§å°å°äº 1MBï¼Œè¿›è€Œç›´æ¥å°†å•ä¸ªå°æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­è¿›è¡Œå¤„ç†ã€‚

**æ€è·¯å¦‚ä¸‹**ï¼š

é¦–å…ˆéå†å¤§æ–‡ä»¶ï¼Œå¯¹éå†åˆ°çš„æ¯ä¸ªè¯xï¼Œæ‰§è¡Œ `hash(x) % 5000`ï¼Œå°†ç»“æœä¸º i çš„è¯å­˜æ”¾åˆ°æ–‡ä»¶ ai ä¸­ã€‚éå†ç»“æŸåï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° 5000 ä¸ªå°æ–‡ä»¶ã€‚æ¯ä¸ªå°æ–‡ä»¶çš„å¤§å°ä¸º 200KB å·¦å³ã€‚å¦‚æœæœ‰çš„å°æ–‡ä»¶å¤§å°ä»ç„¶è¶…è¿‡ 1MBï¼Œåˆ™é‡‡ç”¨åŒæ ·çš„æ–¹å¼ç»§ç»­è¿›è¡Œåˆ†è§£ã€‚

æ¥ç€ç»Ÿè®¡æ¯ä¸ªå°æ–‡ä»¶ä¸­å‡ºç°é¢‘æ•°æœ€é«˜çš„ 100 ä¸ªè¯ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨ HashMap æ¥å®ç°ã€‚å…¶ä¸­ key ä¸ºè¯ï¼Œvalue ä¸ºè¯¥è¯å‡ºç°çš„é¢‘ç‡ã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼šå¯¹äºéå†åˆ°çš„è¯ xï¼Œå¦‚æœåœ¨ map ä¸­ä¸å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œ `map.put(x, 1)`ï¼›è‹¥å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œ `map.put(x, map.get(x)+1)`ï¼Œå°†è¯¥è¯é¢‘æ•°åŠ  1ã€‚

ä¸Šé¢æˆ‘ä»¬ç»Ÿè®¡äº†æ¯ä¸ªå°æ–‡ä»¶å•è¯å‡ºç°çš„é¢‘æ•°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»´æŠ¤ä¸€ä¸ª**å°é¡¶å †**æ¥æ‰¾å‡ºæ‰€æœ‰è¯ä¸­å‡ºç°é¢‘æ•°æœ€é«˜çš„ 100 ä¸ªã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼šä¾æ¬¡éå†æ¯ä¸ªå°æ–‡ä»¶ï¼Œæ„å»ºä¸€ä¸ª**å°é¡¶å †**ï¼Œå †å¤§å°ä¸º 100ã€‚å¦‚æœéå†åˆ°çš„è¯çš„å‡ºç°æ¬¡æ•°å¤§äºå †é¡¶è¯çš„å‡ºç°æ¬¡æ•°ï¼Œåˆ™ç”¨æ–°è¯æ›¿æ¢å †é¡¶çš„è¯ï¼Œç„¶åé‡æ–°è°ƒæ•´ä¸º**å°é¡¶å †**ï¼Œéå†ç»“æŸåï¼Œå°é¡¶å †ä¸Šçš„è¯å°±æ˜¯å‡ºç°é¢‘æ•°æœ€é«˜çš„ 100 ä¸ªè¯ã€‚

**æ–¹æ³•æ€»ç»“**

1. åˆ†è€Œæ²»ä¹‹ï¼Œè¿›è¡Œå“ˆå¸Œå–ä½™ï¼›
2. ä½¿ç”¨ HashMap ç»Ÿè®¡é¢‘æ•°ï¼›
3. æ±‚è§£**æœ€å¤§**çš„ TopN ä¸ªï¼Œç”¨**å°é¡¶å †**ï¼›æ±‚è§£**æœ€å°**çš„ TopN ä¸ªï¼Œç”¨**å¤§é¡¶å †**ã€‚

## 3. å¦‚ä½•æ‰¾å‡ºæŸä¸€å¤©è®¿é—®ç™¾åº¦ç½‘ç«™æœ€å¤šçš„ IPï¼Ÿ

**é¢˜ç›®æè¿°**

ç°æœ‰æµ·é‡æ—¥å¿—æ•°æ®ä¿å­˜åœ¨ä¸€ä¸ªè¶…å¤§æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶æ— æ³•ç›´æ¥è¯»å…¥å†…å­˜ï¼Œè¦æ±‚ä»ä¸­æå–æŸå¤©è®¿é—®ç™¾åº¦æ¬¡æ•°æœ€å¤šçš„é‚£ä¸ª IPã€‚

**è§£ç­”æ€è·¯**

è¿™é“é¢˜åªå…³å¿ƒæŸä¸€å¤©è®¿é—®ç™¾åº¦æœ€å¤šçš„ IPï¼Œå› æ­¤ï¼Œå¯ä»¥é¦–å…ˆå¯¹æ–‡ä»¶è¿›è¡Œä¸€æ¬¡éå†ï¼ŒæŠŠè¿™ä¸€å¤©è®¿é—®ç™¾åº¦ IP çš„ç›¸å…³ä¿¡æ¯è®°å½•åˆ°ä¸€ä¸ªå•ç‹¬çš„å¤§æ–‡ä»¶ä¸­ã€‚æ¥ä¸‹æ¥é‡‡ç”¨çš„æ–¹æ³•ä¸ä¸Šä¸€é¢˜ä¸€æ ·ï¼Œå¤§è‡´å°±æ˜¯å…ˆå¯¹ IP è¿›è¡Œå“ˆå¸Œæ˜ å°„ï¼Œæ¥ç€ä½¿ç”¨ HashMap ç»Ÿè®¡é‡å¤ IP çš„æ¬¡æ•°ï¼Œæœ€åè®¡ç®—å‡ºé‡å¤æ¬¡æ•°æœ€å¤šçš„ IPã€‚

> æ³¨ï¼šè¿™é‡Œåªéœ€è¦æ‰¾å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„ IPï¼Œå¯ä»¥ä¸å¿…ä½¿ç”¨å †ï¼Œç›´æ¥ç”¨ä¸€ä¸ªå˜é‡ max å³å¯ã€‚

**æ–¹æ³•æ€»ç»“**

1. åˆ†è€Œæ²»ä¹‹ï¼Œè¿›è¡Œå“ˆå¸Œå–ä½™ï¼›
2. ä½¿ç”¨ HashMap ç»Ÿè®¡é¢‘æ•°ï¼›
3. æ±‚è§£**æœ€å¤§**çš„ TopN ä¸ªï¼Œç”¨**å°é¡¶å †**ï¼›æ±‚è§£**æœ€å°**çš„ TopN ä¸ªï¼Œç”¨**å¤§é¡¶å †**ã€‚

## 4. å¦‚ä½•åœ¨å¤§é‡çš„æ•°æ®ä¸­æ‰¾å‡ºä¸é‡å¤çš„æ•´æ•°ï¼Ÿ

**é¢˜ç›®æè¿°**

åœ¨ 2.5 äº¿ä¸ªæ•´æ•°ä¸­æ‰¾å‡ºä¸é‡å¤çš„æ•´æ•°ã€‚æ³¨æ„ï¼šå†…å­˜ä¸è¶³ä»¥å®¹çº³è¿™ 2.5 äº¿ä¸ªæ•´æ•°ã€‚

**è§£ç­”æ€è·¯**

**æ–¹æ³•ä¸€ï¼šåˆ†æ²»æ³•**

ä¸å‰é¢çš„é¢˜ç›®æ–¹æ³•ç±»ä¼¼ï¼Œå…ˆå°† 2.5 äº¿ä¸ªæ•°åˆ’åˆ†åˆ°å¤šä¸ªå°æ–‡ä»¶ï¼Œç”¨ HashSet/HashMap æ‰¾å‡ºæ¯ä¸ªå°æ–‡ä»¶ä¸­ä¸é‡å¤çš„æ•´æ•°ï¼Œå†åˆå¹¶æ¯ä¸ªå­ç»“æœï¼Œå³ä¸ºæœ€ç»ˆç»“æœã€‚

**æ–¹æ³•äºŒï¼šä½å›¾æ³•**

**ä½å›¾**ï¼Œå°±æ˜¯ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª bit æ¥æ ‡è®°æŸä¸ªå…ƒç´ å¯¹åº”çš„å€¼ï¼Œè€Œé”®å°±æ˜¯è¯¥å…ƒç´ ã€‚é‡‡ç”¨ä½ä½œä¸ºå•ä½æ¥å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥å¤§å¤§èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚

ä½å›¾é€šè¿‡ä½¿ç”¨ä½æ•°ç»„æ¥è¡¨ç¤ºæŸäº›å…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚å®ƒå¯ä»¥ç”¨äºå¿«é€ŸæŸ¥æ‰¾ï¼Œåˆ¤é‡ï¼Œæ’åºç­‰ã€‚ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Ÿæˆ‘å…ˆä¸¾ä¸ªå°ä¾‹å­ã€‚

å‡è®¾æˆ‘ä»¬è¦å¯¹ `[0,7]` ä¸­çš„ 5 ä¸ªå…ƒç´  (6, 4, 2, 1, 5) è¿›è¡Œæ’åºï¼Œå¯ä»¥é‡‡ç”¨ä½å›¾æ³•ã€‚0~7 èŒƒå›´æ€»å…±æœ‰ 8 ä¸ªæ•°ï¼Œåªéœ€è¦ 8bitï¼Œå³ 1 ä¸ªå­—èŠ‚ã€‚é¦–å…ˆå°†æ¯ä¸ªä½éƒ½ç½® 0ï¼š

```
0 0 0 0 0 0 0 0
å¤åˆ¶ä»£ç 
```

ç„¶åéå† 5 ä¸ªå…ƒç´ ï¼Œé¦–å…ˆé‡åˆ° 6ï¼Œé‚£ä¹ˆå°†ä¸‹æ ‡ä¸º 6 çš„ä½çš„ 0 ç½®ä¸º 1ï¼›æ¥ç€é‡åˆ° 4ï¼ŒæŠŠä¸‹æ ‡ä¸º 4 çš„ä½ çš„ 0 ç½®ä¸º 1ï¼š

```
0 0 0 0 1 0 1 0
å¤åˆ¶ä»£ç 
```

ä¾æ¬¡éå†ï¼Œç»“æŸåï¼Œä½æ•°ç»„æ˜¯è¿™æ ·çš„ï¼š

```
0 1 1 0 1 1 1 0
å¤åˆ¶ä»£ç 
```

æ¯ä¸ªä¸º 1 çš„ä½ï¼Œå®ƒçš„ä¸‹æ ‡éƒ½è¡¨ç¤ºäº†ä¸€ä¸ªæ•°ï¼š

```arduino
for i in range(8):
    if bits[i] == 1:
        print(i)
å¤åˆ¶ä»£ç 
```

è¿™æ ·æˆ‘ä»¬å…¶å®å°±å·²ç»å®ç°äº†æ’åºã€‚

å¯¹äºæ•´æ•°ç›¸å…³çš„ç®—æ³•çš„æ±‚è§£ï¼Œ**ä½å›¾æ³•**æ˜¯ä¸€ç§éå¸¸å®ç”¨çš„ç®—æ³•ã€‚å‡è®¾ int æ•´æ•°å ç”¨ 4Bï¼Œå³ 32bitï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¡¨ç¤ºçš„æ•´æ•°çš„ä¸ªæ•°ä¸º 232ã€‚

**é‚£ä¹ˆå¯¹äºè¿™é“é¢˜**ï¼Œæˆ‘ä»¬ç”¨ 2 ä¸ª bit æ¥è¡¨ç¤ºå„ä¸ªæ•°å­—çš„çŠ¶æ€ï¼š

- 00 è¡¨ç¤ºè¿™ä¸ªæ•°å­—æ²¡å‡ºç°è¿‡ï¼›
- 01 è¡¨ç¤ºè¿™ä¸ªæ•°å­—å‡ºç°è¿‡ä¸€æ¬¡ï¼ˆå³ä¸ºé¢˜ç›®æ‰€æ‰¾çš„ä¸é‡å¤æ•´æ•°ï¼‰ï¼›
- 10 è¡¨ç¤ºè¿™ä¸ªæ•°å­—å‡ºç°äº†å¤šæ¬¡ã€‚

é‚£ä¹ˆè¿™ 232 ä¸ªæ•´æ•°ï¼Œæ€»å…±æ‰€éœ€å†…å­˜ä¸º 232*2b=1GBã€‚å› æ­¤ï¼Œå½“å¯ç”¨å†…å­˜è¶…è¿‡ 1GB æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ä½å›¾æ³•ã€‚å‡è®¾å†…å­˜æ»¡è¶³ä½å›¾æ³•éœ€æ±‚ï¼Œè¿›è¡Œä¸‹é¢çš„æ“ä½œï¼š

éå† 2.5 äº¿ä¸ªæ•´æ•°ï¼ŒæŸ¥çœ‹ä½å›¾ä¸­å¯¹åº”çš„ä½ï¼Œå¦‚æœæ˜¯ 00ï¼Œåˆ™å˜ä¸º 01ï¼Œå¦‚æœæ˜¯ 01 åˆ™å˜ä¸º 10ï¼Œå¦‚æœæ˜¯ 10 åˆ™ä¿æŒä¸å˜ã€‚éå†ç»“æŸåï¼ŒæŸ¥çœ‹ä½å›¾ï¼ŒæŠŠå¯¹åº”ä½æ˜¯ 01 çš„æ•´æ•°è¾“å‡ºå³å¯ã€‚

**æ–¹æ³•æ€»ç»“**

**åˆ¤æ–­æ•°å­—æ˜¯å¦é‡å¤çš„é—®é¢˜**ï¼Œä½å›¾æ³•æ˜¯ä¸€ç§éå¸¸é«˜æ•ˆçš„æ–¹æ³•ã€‚

## 5. å¦‚ä½•åœ¨å¤§é‡çš„æ•°æ®ä¸­åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦å­˜åœ¨ï¼Ÿ

**é¢˜ç›®æè¿°**

ç»™å®š 40 äº¿ä¸ªä¸é‡å¤çš„æ²¡æ’è¿‡åºçš„ unsigned int å‹æ•´æ•°ï¼Œç„¶åå†ç»™å®šä¸€ä¸ªæ•°ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤æ–­è¿™ä¸ªæ•°æ˜¯å¦åœ¨è¿™ 40 äº¿ä¸ªæ•´æ•°å½“ä¸­ï¼Ÿ

**è§£ç­”æ€è·¯**

**æ–¹æ³•ä¸€ï¼šåˆ†æ²»æ³•**

ä¾ç„¶å¯ä»¥ç”¨åˆ†æ²»æ³•è§£å†³ï¼Œæ–¹æ³•ä¸å‰é¢ç±»ä¼¼ï¼Œå°±ä¸å†æ¬¡èµ˜è¿°äº†ã€‚

**æ–¹æ³•äºŒï¼šä½å›¾æ³•**

40 äº¿ä¸ªä¸é‡å¤æ•´æ•°ï¼Œæˆ‘ä»¬ç”¨ 40 äº¿ä¸ª bit æ¥è¡¨ç¤ºï¼Œåˆå§‹ä½å‡ä¸º 0ï¼Œé‚£ä¹ˆæ€»å…±éœ€è¦å†…å­˜ï¼š4,000,000,000bâ‰ˆ512Mã€‚

æˆ‘ä»¬è¯»å–è¿™ 40 äº¿ä¸ªæ•´æ•°ï¼Œå°†å¯¹åº”çš„ bit è®¾ç½®ä¸º 1ã€‚æ¥ç€è¯»å–è¦æŸ¥è¯¢çš„æ•°ï¼ŒæŸ¥çœ‹ç›¸åº”ä½æ˜¯å¦ä¸º 1ï¼Œå¦‚æœä¸º 1 è¡¨ç¤ºå­˜åœ¨ï¼Œå¦‚æœä¸º 0 è¡¨ç¤ºä¸å­˜åœ¨ã€‚

**æ–¹æ³•æ€»ç»“**

**åˆ¤æ–­æ•°å­—æ˜¯å¦å­˜åœ¨ã€åˆ¤æ–­æ•°å­—æ˜¯å¦é‡å¤çš„é—®é¢˜**ï¼Œä½å›¾æ³•æ˜¯ä¸€ç§éå¸¸é«˜æ•ˆçš„æ–¹æ³•ã€‚

## 6. å¦‚ä½•æŸ¥è¯¢æœ€çƒ­é—¨çš„æŸ¥è¯¢ä¸²ï¼Ÿ

**é¢˜ç›®æè¿°**

æœç´¢å¼•æ“ä¼šé€šè¿‡æ—¥å¿—æ–‡ä»¶æŠŠç”¨æˆ·æ¯æ¬¡æ£€ç´¢ä½¿ç”¨çš„æ‰€æœ‰æŸ¥è¯¢ä¸²éƒ½è®°å½•ä¸‹æ¥ï¼Œæ¯ä¸ªæŸ¥è¯¢åºŠçš„é•¿åº¦ä¸è¶…è¿‡ 255 å­—èŠ‚ã€‚

å‡è®¾ç›®å‰æœ‰ 1000w ä¸ªè®°å½•ï¼ˆè¿™äº›æŸ¥è¯¢ä¸²çš„é‡å¤åº¦æ¯”è¾ƒé«˜ï¼Œè™½ç„¶æ€»æ•°æ˜¯ 1000wï¼Œä½†å¦‚æœé™¤å»é‡å¤åï¼Œåˆ™ä¸è¶…è¿‡ 300w ä¸ªï¼‰ã€‚è¯·ç»Ÿè®¡æœ€çƒ­é—¨çš„ 10 ä¸ªæŸ¥è¯¢ä¸²ï¼Œè¦æ±‚ä½¿ç”¨çš„å†…å­˜ä¸èƒ½è¶…è¿‡ 1Gã€‚ï¼ˆä¸€ä¸ªæŸ¥è¯¢ä¸²çš„é‡å¤åº¦è¶Šé«˜ï¼Œè¯´æ˜æŸ¥è¯¢å®ƒçš„ç”¨æˆ·è¶Šå¤šï¼Œä¹Ÿå°±è¶Šçƒ­é—¨ã€‚ï¼‰

**è§£ç­”æ€è·¯**

æ¯ä¸ªæŸ¥è¯¢ä¸²æœ€é•¿ä¸º 255Bï¼Œ1000w ä¸ªä¸²éœ€è¦å ç”¨ çº¦ 2.55G å†…å­˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•å°†æ‰€æœ‰å­—ç¬¦ä¸²å…¨éƒ¨è¯»å…¥åˆ°å†…å­˜ä¸­å¤„ç†ã€‚

**æ–¹æ³•ä¸€ï¼šåˆ†æ²»æ³•**

åˆ†æ²»æ³•ä¾ç„¶æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ã€‚

åˆ’åˆ†ä¸ºå¤šä¸ªå°æ–‡ä»¶ï¼Œä¿è¯å•ä¸ªå°æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²èƒ½è¢«ç›´æ¥åŠ è½½åˆ°å†…å­˜ä¸­å¤„ç†ï¼Œç„¶åæ±‚å‡ºæ¯ä¸ªæ–‡ä»¶ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„ 10 ä¸ªå­—ç¬¦ä¸²ï¼›æœ€åé€šè¿‡ä¸€ä¸ªå°é¡¶å †ç»Ÿè®¡å‡ºæ‰€æœ‰æ–‡ä»¶ä¸­å‡ºç°æœ€å¤šçš„ 10 ä¸ªå­—ç¬¦ä¸²ã€‚

æ–¹æ³•å¯è¡Œï¼Œä½†ä¸æ˜¯æœ€å¥½ï¼Œä¸‹é¢ä»‹ç»å…¶ä»–æ–¹æ³•ã€‚

**æ–¹æ³•äºŒï¼šHashMap æ³•**

è™½ç„¶å­—ç¬¦ä¸²æ€»æ•°æ¯”è¾ƒå¤šï¼Œä½†å»é‡åä¸è¶…è¿‡ 300wï¼Œå› æ­¤ï¼Œå¯ä»¥è€ƒè™‘æŠŠæ‰€æœ‰å­—ç¬¦ä¸²åŠå‡ºç°æ¬¡æ•°ä¿å­˜åœ¨ä¸€ä¸ª HashMap ä¸­ï¼Œæ‰€å ç”¨çš„ç©ºé—´ä¸º 300w*(255+4)â‰ˆ777Mï¼ˆå…¶ä¸­ï¼Œ4è¡¨ç¤ºæ•´æ•°å ç”¨çš„4ä¸ªå­—èŠ‚ï¼‰ã€‚ç”±æ­¤å¯è§ï¼Œ1G çš„å†…å­˜ç©ºé—´å®Œå…¨å¤Ÿç”¨ã€‚

**æ€è·¯å¦‚ä¸‹**ï¼š

é¦–å…ˆï¼Œéå†å­—ç¬¦ä¸²ï¼Œè‹¥ä¸åœ¨ map ä¸­ï¼Œç›´æ¥å­˜å…¥ mapï¼Œvalue è®°ä¸º 1ï¼›è‹¥åœ¨ map ä¸­ï¼Œåˆ™æŠŠå¯¹åº”çš„ value åŠ  1ï¼Œè¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦ `O(N)`ã€‚

æ¥ç€éå† mapï¼Œæ„å»ºä¸€ä¸ª 10 ä¸ªå…ƒç´ çš„å°é¡¶å †ï¼Œè‹¥éå†åˆ°çš„å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°å¤§äºå †é¡¶å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°ï¼Œåˆ™è¿›è¡Œæ›¿æ¢ï¼Œå¹¶å°†å †è°ƒæ•´ä¸ºå°é¡¶å †ã€‚

éå†ç»“æŸåï¼Œå †ä¸­ 10 ä¸ªå­—ç¬¦ä¸²å°±æ˜¯å‡ºç°æ¬¡æ•°æœ€å¤šçš„å­—ç¬¦ä¸²ã€‚è¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦ `O(Nlog10)`ã€‚

**æ–¹æ³•ä¸‰ï¼šå‰ç¼€æ ‘æ³•**

æ–¹æ³•äºŒä½¿ç”¨äº† HashMap æ¥ç»Ÿè®¡æ¬¡æ•°ï¼Œå½“è¿™äº›å­—ç¬¦ä¸²æœ‰å¤§é‡ç›¸åŒå‰ç¼€æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å‰ç¼€æ ‘æ¥ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°ï¼Œæ ‘çš„ç»“ç‚¹ä¿å­˜å­—ç¬¦ä¸²å‡ºç°æ¬¡æ•°ï¼Œ0 è¡¨ç¤ºæ²¡æœ‰å‡ºç°ã€‚

**æ€è·¯å¦‚ä¸‹**ï¼š

åœ¨éå†å­—ç¬¦ä¸²æ—¶ï¼Œåœ¨å‰ç¼€æ ‘ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™æŠŠç»“ç‚¹ä¸­ä¿å­˜çš„å­—ç¬¦ä¸²æ¬¡æ•°åŠ  1ï¼Œå¦åˆ™ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²æ„å»ºæ–°ç»“ç‚¹ï¼Œæ„å»ºå®ŒæˆåæŠŠå¶å­ç»“ç‚¹ä¸­å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°ç½®ä¸º 1ã€‚

æœ€åä¾ç„¶ä½¿ç”¨å°é¡¶å †æ¥å¯¹å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°è¿›è¡Œæ’åºã€‚

**æ–¹æ³•æ€»ç»“**

å‰ç¼€æ ‘ç»å¸¸è¢«ç”¨æ¥ç»Ÿè®¡å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°ã€‚å®ƒçš„å¦å¤–ä¸€ä¸ªå¤§çš„ç”¨é€”æ˜¯å­—ç¬¦ä¸²æŸ¥æ‰¾ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰é‡å¤çš„å­—ç¬¦ä¸²ç­‰ã€‚

## 7. å¦‚ä½•ç»Ÿè®¡ä¸åŒç”µè¯å·ç çš„ä¸ªæ•°ï¼Ÿ

**é¢˜ç›®æè¿°**

å·²çŸ¥æŸä¸ªæ–‡ä»¶å†…åŒ…å«ä¸€äº›ç”µè¯å·ç ï¼Œæ¯ä¸ªå·ç ä¸º 8 ä½æ•°å­—ï¼Œç»Ÿè®¡ä¸åŒå·ç çš„ä¸ªæ•°ã€‚

**è§£ç­”æ€è·¯**

è¿™é“é¢˜æœ¬è´¨è¿˜æ˜¯æ±‚è§£**æ•°æ®é‡å¤**çš„é—®é¢˜ï¼Œå¯¹äºè¿™ç±»é—®é¢˜ï¼Œä¸€èˆ¬é¦–å…ˆè€ƒè™‘ä½å›¾æ³•ã€‚

å¯¹äºæœ¬é¢˜ï¼Œ8 ä½ç”µè¯å·ç å¯ä»¥è¡¨ç¤ºçš„å·ç ä¸ªæ•°ä¸º 108 ä¸ªï¼Œå³ 1 äº¿ä¸ªã€‚æˆ‘ä»¬æ¯ä¸ªå·ç ç”¨ä¸€ä¸ª bit æ¥è¡¨ç¤ºï¼Œåˆ™æ€»å…±éœ€è¦ 1 äº¿ä¸ª bitï¼Œå†…å­˜å ç”¨çº¦ 100Mã€‚

**æ€è·¯å¦‚ä¸‹**ï¼š

ç”³è¯·ä¸€ä¸ªä½å›¾æ•°ç»„ï¼Œé•¿åº¦ä¸º 1 äº¿ï¼Œåˆå§‹åŒ–ä¸º 0ã€‚ç„¶åéå†æ‰€æœ‰ç”µè¯å·ç ï¼ŒæŠŠå·ç å¯¹åº”çš„ä½å›¾ä¸­çš„ä½ç½®ç½®ä¸º 1ã€‚éå†å®Œæˆåï¼Œå¦‚æœ bit ä¸º 1ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªç”µè¯å·ç åœ¨æ–‡ä»¶ä¸­å­˜åœ¨ï¼Œå¦åˆ™ä¸å­˜åœ¨ã€‚bit å€¼ä¸º 1 çš„æ•°é‡å³ä¸º ä¸åŒç”µè¯å·ç çš„ä¸ªæ•°ã€‚

**æ–¹æ³•æ€»ç»“**

æ±‚è§£æ•°æ®é‡å¤é—®é¢˜ï¼Œè®°å¾—è€ƒè™‘ä½å›¾æ³•ã€‚

## 8. å¦‚ä½•ä» 5 äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºä¸­ä½æ•°ï¼Ÿ

**é¢˜ç›®æè¿°**

ä» 5 äº¿ä¸ªæ•°ä¸­æ‰¾å‡ºä¸­ä½æ•°ã€‚æ•°æ®æ’åºåï¼Œä½ç½®åœ¨æœ€ä¸­é—´çš„æ•°å°±æ˜¯ä¸­ä½æ•°ã€‚å½“æ ·æœ¬æ•°ä¸ºå¥‡æ•°æ—¶ï¼Œä¸­ä½æ•°ä¸º ç¬¬ `(N+1)/2` ä¸ªæ•°ï¼›å½“æ ·æœ¬æ•°ä¸ºå¶æ•°æ—¶ï¼Œä¸­ä½æ•°ä¸º ç¬¬ `N/2` ä¸ªæ•°ä¸ç¬¬ `1+N/2` ä¸ªæ•°çš„å‡å€¼ã€‚

**è§£ç­”æ€è·¯**

å¦‚æœè¿™é“é¢˜æ²¡æœ‰å†…å­˜å¤§å°é™åˆ¶ï¼Œåˆ™å¯ä»¥æŠŠæ‰€æœ‰æ•°è¯»åˆ°å†…å­˜ä¸­æ’åºåæ‰¾å‡ºä¸­ä½æ•°ã€‚ä½†æ˜¯æœ€å¥½çš„æ’åºç®—æ³•çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸º `O(NlogN)`ã€‚è¿™é‡Œä½¿ç”¨å…¶ä»–æ–¹æ³•ã€‚

**æ–¹æ³•ä¸€ï¼šåŒå †æ³•**

ç»´æŠ¤ä¸¤ä¸ªå †ï¼Œä¸€ä¸ªå¤§é¡¶å †ï¼Œä¸€ä¸ªå°é¡¶å †ã€‚å¤§é¡¶å †ä¸­æœ€å¤§çš„æ•°**å°äºç­‰äº**å°é¡¶å †ä¸­æœ€å°çš„æ•°ï¼›ä¿è¯è¿™ä¸¤ä¸ªå †ä¸­çš„å…ƒç´ ä¸ªæ•°çš„å·®ä¸è¶…è¿‡ 1ã€‚

è‹¥æ•°æ®æ€»æ•°ä¸º**å¶æ•°**ï¼Œå½“è¿™ä¸¤ä¸ªå †å»ºå¥½ä¹‹åï¼Œ**ä¸­ä½æ•°å°±æ˜¯è¿™ä¸¤ä¸ªå †é¡¶å…ƒç´ çš„å¹³å‡å€¼**ã€‚å½“æ•°æ®æ€»æ•°ä¸º**å¥‡æ•°**æ—¶ï¼Œæ ¹æ®ä¸¤ä¸ªå †çš„å¤§å°ï¼Œ**ä¸­ä½æ•°ä¸€å®šåœ¨æ•°æ®å¤šçš„å †çš„å †é¡¶**ã€‚

```ini
class MedianFinder {
    
    private PriorityQueue<Integer> maxHeap;
    private PriorityQueue<Integer> minHeap;

    /** initialize your data structure here. */
    public MedianFinder() {
        maxHeap = new PriorityQueue<>(Comparator.reverseOrder());
        minHeap = new PriorityQueue<>(Integer::compareTo);
    }
    
    public void addNum(int num) {
        if (maxHeap.isEmpty() || maxHeap.peek() > num) {
            maxHeap.offer(num);
        } else {
            minHeap.offer(num);
        }
        
        int size1 = maxHeap.size();
        int size2 = minHeap.size();
        if (size1 - size2 > 1) {
            minHeap.offer(maxHeap.poll());
        } else if (size2 - size1 > 1) {
            maxHeap.offer(minHeap.poll());
        }
    }
    
    public double findMedian() {
        int size1 = maxHeap.size();
        int size2 = minHeap.size();
        
        return size1 == size2 
            ? (maxHeap.peek() + minHeap.peek()) * 1.0 / 2
            : (size1 > size2 ? maxHeap.peek() : minHeap.peek());
    }
}
å¤åˆ¶ä»£ç 
```

> è§ LeetCode No.295ï¼š[leetcode.com/problems/fiâ€¦](https://link.juejin.cn/?target=https%3A%2F%2Fleetcode.com%2Fproblems%2Ffind-median-from-data-stream%2F)

ä»¥ä¸Šè¿™ç§æ–¹æ³•ï¼Œéœ€è¦æŠŠæ‰€æœ‰æ•°æ®éƒ½åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å½“æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œå°±ä¸èƒ½è¿™æ ·äº†ï¼Œå› æ­¤ï¼Œè¿™ç§æ–¹æ³•**é€‚ç”¨äºæ•°æ®é‡è¾ƒå°çš„æƒ…å†µ**ã€‚5 äº¿ä¸ªæ•°ï¼Œæ¯ä¸ªæ•°å­—å ç”¨ 4Bï¼Œæ€»å…±éœ€è¦ 2G å†…å­˜ã€‚å¦‚æœå¯ç”¨å†…å­˜ä¸è¶³ 2Gï¼Œå°±ä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹æ³•äº†ï¼Œä¸‹é¢ä»‹ç»å¦ä¸€ç§æ–¹æ³•ã€‚

**æ–¹æ³•äºŒï¼šåˆ†æ²»æ³•**

åˆ†æ²»æ³•çš„æ€æƒ³æ˜¯æŠŠä¸€ä¸ªå¤§çš„é—®é¢˜é€æ¸è½¬æ¢ä¸ºè§„æ¨¡è¾ƒå°çš„é—®é¢˜æ¥æ±‚è§£ã€‚

å¯¹äºè¿™é“é¢˜ï¼Œé¡ºåºè¯»å–è¿™ 5 äº¿ä¸ªæ•°å­—ï¼Œå¯¹äºè¯»å–åˆ°çš„æ•°å­— numï¼Œå¦‚æœå®ƒå¯¹åº”çš„äºŒè¿›åˆ¶ä¸­æœ€é«˜ä½ä¸º1ï¼Œåˆ™æŠŠè¿™ä¸ªæ•°å­—å†™åˆ° f1 ä¸­ï¼Œå¦åˆ™å†™å…¥ f0 ä¸­ã€‚é€šè¿‡è¿™ä¸€æ­¥ï¼Œå¯ä»¥æŠŠè¿™ 5 äº¿ä¸ªæ•°åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè€Œä¸” f0 ä¸­çš„æ•°éƒ½å¤§äº f1 ä¸­çš„æ•°ï¼ˆæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼‰ã€‚

åˆ’åˆ†ä¹‹åï¼Œå¯ä»¥éå¸¸å®¹æ˜“åœ°çŸ¥é“ä¸­ä½æ•°æ˜¯åœ¨ f0 è¿˜æ˜¯ f1 ä¸­ã€‚å‡è®¾ f1 ä¸­æœ‰ 1 äº¿ä¸ªæ•°ï¼Œé‚£ä¹ˆä¸­ä½æ•°ä¸€å®šåœ¨ f0 ä¸­ï¼Œä¸”æ˜¯åœ¨ f0 ä¸­ï¼Œä»å°åˆ°å¤§æ’åˆ—çš„ç¬¬ 1.5 äº¿ä¸ªæ•°ä¸å®ƒåé¢çš„ä¸€ä¸ªæ•°çš„å¹³å‡å€¼ã€‚

> **æç¤º**ï¼Œ5 äº¿æ•°çš„ä¸­ä½æ•°æ˜¯ç¬¬ 2.5 äº¿ä¸å³è¾¹ç›¸é‚»ä¸€ä¸ªæ•°æ±‚å¹³å‡å€¼ã€‚è‹¥ f1 æœ‰ä¸€äº¿ä¸ªæ•°ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯ f0 ä¸­ä»ç¬¬ 1.5 äº¿ä¸ªæ•°å¼€å§‹çš„ä¸¤ä¸ªæ•°æ±‚å¾—çš„å¹³å‡å€¼ã€‚

å¯¹äº f0 å¯ä»¥ç”¨æ¬¡é«˜ä½çš„äºŒè¿›åˆ¶ç»§ç»­å°†æ–‡ä»¶ä¸€åˆ†ä¸ºäºŒï¼Œå¦‚æ­¤åˆ’åˆ†ä¸‹å»ï¼Œç›´åˆ°åˆ’åˆ†åçš„æ–‡ä»¶å¯ä»¥è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼ŒæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ä»¥åç›´æ¥æ’åºï¼Œæ‰¾å‡ºä¸­ä½æ•°ã€‚

> **æ³¨æ„**ï¼Œå½“æ•°æ®æ€»æ•°ä¸ºå¶æ•°ï¼Œå¦‚æœåˆ’åˆ†åä¸¤ä¸ªæ–‡ä»¶ä¸­çš„æ•°æ®æœ‰ç›¸åŒä¸ªæ•°ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯æ•°æ®è¾ƒå°çš„æ–‡ä»¶ä¸­çš„æœ€å¤§å€¼ä¸æ•°æ®è¾ƒå¤§çš„æ–‡ä»¶ä¸­çš„æœ€å°å€¼çš„å¹³å‡å€¼ã€‚

**æ–¹æ³•æ€»ç»“**

åˆ†æ²»æ³•ï¼ŒçœŸé¦™ï¼

## 9. å¦‚ä½•æŒ‰ç…§ query çš„é¢‘åº¦æ’åºï¼Ÿ

**é¢˜ç›®æè¿°**

æœ‰ 10 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å¤§å°ä¸º 1Gï¼Œæ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸€è¡Œå­˜æ”¾çš„éƒ½æ˜¯ç”¨æˆ·çš„ queryï¼Œæ¯ä¸ªæ–‡ä»¶çš„ query éƒ½å¯èƒ½é‡å¤ã€‚è¦æ±‚æŒ‰ç…§ query çš„é¢‘åº¦æ’åºã€‚

**è§£ç­”æ€è·¯**

å¦‚æœ query çš„é‡å¤åº¦æ¯”è¾ƒå¤§ï¼Œå¯ä»¥è€ƒè™‘ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ query è¯»å…¥å†…å­˜ä¸­å¤„ç†ï¼›å¦‚æœ query çš„é‡å¤ç‡ä¸é«˜ï¼Œé‚£ä¹ˆå¯ç”¨å†…å­˜ä¸è¶³ä»¥å®¹çº³æ‰€æœ‰çš„ queryï¼Œè¿™æ—¶å€™å°±éœ€è¦é‡‡ç”¨åˆ†æ²»æ³•æˆ–å…¶ä»–çš„æ–¹æ³•æ¥è§£å†³ã€‚

**æ–¹æ³•ä¸€ï¼šHashMap æ³•**

å¦‚æœ query é‡å¤ç‡é«˜ï¼Œè¯´æ˜ä¸åŒ query æ€»æ•°æ¯”è¾ƒå°ï¼Œå¯ä»¥è€ƒè™‘æŠŠæ‰€æœ‰çš„ query éƒ½åŠ è½½åˆ°å†…å­˜ä¸­çš„ HashMap ä¸­ã€‚æ¥ç€å°±å¯ä»¥æŒ‰ç…§ query å‡ºç°çš„æ¬¡æ•°è¿›è¡Œæ’åºã€‚

**æ–¹æ³•äºŒï¼šåˆ†æ²»æ³•**

åˆ†æ²»æ³•éœ€è¦æ ¹æ®æ•°æ®é‡å¤§å°ä»¥åŠå¯ç”¨å†…å­˜çš„å¤§å°æ¥ç¡®å®šé—®é¢˜åˆ’åˆ†çš„è§„æ¨¡ã€‚å¯¹äºè¿™é“é¢˜ï¼Œå¯ä»¥é¡ºåºéå† 10 ä¸ªæ–‡ä»¶ä¸­çš„ queryï¼Œé€šè¿‡ Hash å‡½æ•° `hash(query) % 10` æŠŠè¿™äº› query åˆ’åˆ†åˆ° 10 ä¸ªå°æ–‡ä»¶ä¸­ã€‚ä¹‹åå¯¹æ¯ä¸ªå°æ–‡ä»¶ä½¿ç”¨ HashMap ç»Ÿè®¡ query å‡ºç°æ¬¡æ•°ï¼Œæ ¹æ®æ¬¡æ•°æ’åºå¹¶å†™å…¥åˆ°é›¶å¤–ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ä¸­ã€‚

æ¥ç€å¯¹æ‰€æœ‰æ–‡ä»¶æŒ‰ç…§ query çš„æ¬¡æ•°è¿›è¡Œæ’åºï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å½’å¹¶æ’åºï¼ˆç”±äºæ— æ³•æŠŠæ‰€æœ‰ query éƒ½è¯»å…¥å†…å­˜ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨å¤–æ’åºï¼‰ã€‚

**æ–¹æ³•æ€»ç»“**

- å†…å­˜è‹¥å¤Ÿï¼Œç›´æ¥è¯»å…¥è¿›è¡Œæ’åºï¼›
- å†…å­˜ä¸å¤Ÿï¼Œå…ˆåˆ’åˆ†ä¸ºå°æ–‡ä»¶ï¼Œå°æ–‡ä»¶æ’å¥½åºåï¼Œæ•´ç†ä½¿ç”¨å¤–æ’åºè¿›è¡Œå½’å¹¶ã€‚

## 10. å¦‚ä½•æ‰¾å‡ºæ’åå‰ 500 çš„æ•°ï¼Ÿ

**é¢˜ç›®æè¿°**

æœ‰ 20 ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æœ‰ 500 ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”æœ‰åºæ’åˆ—ã€‚å¦‚ä½•åœ¨è¿™ 20*500 ä¸ªæ•°ä¸­æ‰¾å‡ºå‰ 500 çš„æ•°ï¼Ÿ

**è§£ç­”æ€è·¯**

å¯¹äº TopK é—®é¢˜ï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨å †æ’åºã€‚å¯¹æœ¬é¢˜è€Œè¨€ï¼Œå‡è®¾æ•°ç»„é™åºæ’åˆ—ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

é¦–å…ˆå»ºç«‹å¤§é¡¶å †ï¼Œå †çš„å¤§å°ä¸ºæ•°ç»„çš„ä¸ªæ•°ï¼Œå³ä¸º 20ï¼ŒæŠŠæ¯ä¸ªæ•°ç»„æœ€å¤§çš„å€¼å­˜åˆ°å †ä¸­ã€‚

æ¥ç€åˆ é™¤å †é¡¶å…ƒç´ ï¼Œä¿å­˜åˆ°å¦ä¸€ä¸ªå¤§å°ä¸º 500 çš„æ•°ç»„ä¸­ï¼Œç„¶åå‘å¤§é¡¶å †æ’å…¥åˆ é™¤çš„å…ƒç´ æ‰€åœ¨æ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚

é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°åˆ é™¤å®Œç¬¬ 500 ä¸ªå…ƒç´ ï¼Œä¹Ÿå³æ‰¾å‡ºäº†æœ€å¤§çš„å‰ 500 ä¸ªæ•°ã€‚

> ä¸ºäº†åœ¨å †ä¸­å–å‡ºä¸€ä¸ªæ•°æ®åï¼Œèƒ½çŸ¥é“å®ƒæ˜¯ä»å“ªä¸ªæ•°ç»„ä¸­å–å‡ºçš„ï¼Œä»è€Œå¯ä»¥ä»è¿™ä¸ªæ•°ç»„ä¸­å–ä¸‹ä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŠŠæ•°ç»„çš„æŒ‡é’ˆå­˜æ”¾åˆ°å †ä¸­ï¼Œå¯¹è¿™ä¸ªæŒ‡é’ˆæä¾›æ¯”è¾ƒå¤§å°çš„æ–¹æ³•ã€‚

```ini
import lombok.Data;

import java.util.Arrays;
import java.util.PriorityQueue;

/**
 * @author https://github.com/yanglbme
 */
@Data
public class DataWithSource implements Comparable<DataWithSource> {
    /**
     * æ•°å€¼
     */
    private int value;

    /**
     * è®°å½•æ•°å€¼æ¥æºçš„æ•°ç»„
     */
    private int source;

    /**
     * è®°å½•æ•°å€¼åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•
     */
    private int index;

    public DataWithSource(int value, int source, int index) {
        this.value = value;
        this.source = source;
        this.index = index;
    }

    /**
     *
     * ç”±äº PriorityQueue ä½¿ç”¨å°é¡¶å †æ¥å®ç°ï¼Œè¿™é‡Œé€šè¿‡ä¿®æ”¹
     * ä¸¤ä¸ªæ•´æ•°çš„æ¯”è¾ƒé€»è¾‘æ¥è®© PriorityQueue å˜æˆå¤§é¡¶å †
     */
    @Override
    public int compareTo(DataWithSource o) {
        return Integer.compare(o.getValue(), this.value);
    }
}


class Test {
    public static int[] getTop(int[][] data) {
        int rowSize = data.length;
        int columnSize = data[0].length;

        // åˆ›å»ºä¸€ä¸ªcolumnSizeå¤§å°çš„æ•°ç»„ï¼Œå­˜æ”¾ç»“æœ
        int[] result = new int[columnSize];

        PriorityQueue<DataWithSource> maxHeap = new PriorityQueue<>();
        for (int i = 0; i < rowSize; ++i) {
            // å°†æ¯ä¸ªæ•°ç»„çš„æœ€å¤§ä¸€ä¸ªå…ƒç´ æ”¾å…¥å †ä¸­
            DataWithSource d = new DataWithSource(data[i][0], i, 0);
            maxHeap.add(d);
        }

        int num = 0;
        while (num < columnSize) {
            // åˆ é™¤å †é¡¶å…ƒç´ 
            DataWithSource d = maxHeap.poll();
            result[num++] = d.getValue();
            if (num >= columnSize) {
                break;
            }

            d.setValue(data[d.getSource()][d.getIndex() + 1]);
            d.setIndex(d.getIndex() + 1);
            maxHeap.add(d);
        }
        return result;

    }

    public static void main(String[] args) {
        int[][] data = {
                {29, 17, 14, 2, 1},
                {19, 17, 16, 15, 6},
                {30, 25, 20, 14, 5},
        };

        int[] top = getTop(data);
        System.out.println(Arrays.toString(top)); // [30, 29, 25, 20, 19]
    }
}
å¤åˆ¶ä»£ç 
```

**æ–¹æ³•æ€»ç»“**

æ±‚ TopKï¼Œä¸å¦¨è€ƒè™‘ä¸€ä¸‹å †æ’åºï¼Ÿ