---
title: 前端系统架构设计
date: 2022-05-05 06:33:16
categories:
- H_工程和热点
toc: true # 是否启用内容索引
---

# 1.参考

[大型项目前端架构浅谈](https://juejin.cn/post/6844903853859536903#heading-32)

# 2.常用指标

**响应时间**

系统响应时间，是计算机对用户的输入或请求作出反应的时间 。响应时间和时间片的大小有关，一般情况是：时间片越短，响应时间越快。

**并发数**

同时访问服务器站点的连接数。

- 并发：一个处理器同时处理多个任务。逻辑上的同时发生，你吃饭吃到一半，电话来了，你停了下来接了电话，接完后继续吃饭。
- 并行：多个处理器或者是多核的处理器同时处理多个不同的任务。物理上的同时发生。你吃饭吃到一半，电话来了，你一边打电话一边吃饭

**吞吐量**

指的就是单位时间内，系统处理的请求数量。 TPS（每秒的事务数），HPS（每秒的HTTP请求数），QPS（每秒的查询数）等等。性能一般通过缓存来解决。

# **3.分布式与集群**

## **定义**

简单理解

- 分布式是以缩短单个任务的执行时间来提升效率的
- 集群则是通过提高单位时间内执行的任务数来提升效率

> 如果一个任务由10个子任务组成，每个子任务单独执行需1小时，则在一台服务器上执行改任务需10小时。
>
> 采用分布式方案，提供10台服务器，每台服务器只负责处理一个子任务，不考虑子任务间的依赖关系，执行完这个任务只需一个小时。(这种工作模式的一个典型代表就是Hadoop的Map/Reduce分布式计算模型）
>
> 而采用集群方案，同样提供10台服务器，每台服务器都能独立处理这个任务。假设有10个任务同时到达，10个服务器将同时工作，10小后，10个任务同时完成，这样，整身来看，还是1小时内完成一个任务！

- **分布式：**不同的业务模块部署在不同的服务器上或者同一个业务模块分拆多个子业务，部署在不同的服务器上，解决高并发的问题
- **集群：**同一个业务部署在多台机器上，提高系统可用性

**区别与联系**

分布式是指将不同的业务分布在不同的地方；而集群指的是将几台服务器集中在一起，实现同一业务。

分布式中的每一个节点，都可以做集群。 而集群并不一定就是分布式的。

举例：就比如新浪网，访问的人多了，他可以做一个群集，前面放一个响应服务器，后面几台服务器完成同一业务，如果有业务访问的时候，响应服务器看哪台服务器的负载不是很重，就将给哪一台去完成。

而分布式，从窄意上理解，也跟集群差不多， 但是它的组织比较松散，不像集群，有一个组织性，一台服务器垮了，其它的服务器可以顶上来。

分布式的每一个节点，都完成不同的业务，一个节点垮了，那这个业务就不可访问了。

## **集群**

**两大关键特性**

- 可扩展性－－集群的性能不限于单一的服务实体，新的服务实体可以动态地加入到集群，从而增强集群的性能。
- 高可用性－－集群通过服务实体冗余使客户端免于轻易遇到out of service的警告。在集群中，同样的服务可以由多个服务实体提供。如果一个服务实体失败了，另一个服务实体会接管失败的服务实体。集群提供的从一个出 错的服务实体恢复到另一个服务实体的功能增强了应用的可用性。

**两大能力**

- 负载均衡－－负载均衡能把任务比较均衡地分布到集群环境下的计算和网络资源。
- 错误恢复－－由于某种原因，执行某个任务的资源出现故障，另一服务实体中执行同一任务的资源接着完成任务。这种由于一个实体中的资源不能工作，另一个实体中的资源透明的继续完成任务的过程叫错误恢复。

**集群分类**

Linux集群主要分成三大类(高可用集群， 负载均衡集群，科学计算集群)

1.高可用集群(High Availability Cluster)

> 常见的就是2个节点做成的HA集群，有很多通俗的不科学的名称，比如"双机热备"，"双机互备"，"双机"。
>
> 高可用集群解决的是保障用户的应用程序持续对外提供服务的能力。

2.负载均衡集群(Load Balance Cluster)

> 负载均衡系统：集群中所有的节点都处于活动状态，它们分摊系统的工作负载。一般Web服务器集群、数据库集群和应用服务器集群都属于这种类型。
>
> 负载均衡集群一般用于相应网络请求的网页服务器，数据库服务器。这种集群可以在接到请求时，检查接受请求较少，不繁忙的服务器，并把请求转到这些服务器上。从检查其他服务器状态这一点上看，负载均衡和容错集群很接近，不同之处是数量上更多。

3.科学计算集群(High Performance Computing Cluster)

> 高性能计算(High Perfermance Computing)集群，简称HPC集群。这类集群致力于提供单个计算机所不能提供的强大的计算能力。

具体包括：

高可用集群(普通两节点双机热备，多节点HA集群，RAC, shared, share-nothing集群等)

负载均衡集群(LVS等....)

高性能科学计算集群(Beowulf 类集群....)

## 分布式

**大白话讲**

小饭店原来只有一个厨师，切菜洗菜备料炒菜全干。后来客人多了，厨房一个厨师忙不过来，又请了个厨师，两个厨师都能炒一样的菜，这两个厨师的关系是集群。

为了让厨师专心炒菜，把菜做到极致，又请了个配菜师负责切菜，备菜，备料，厨师和配菜师的关系是分布式，一个配菜师也忙不过来了，又请了个配菜师，两个配菜师关系是集群。

# 4.Linux服务端最大并发数

 **C10K问题和C10M问题**

在2000年初的时候，全球互联网的规模并不大，但是当时就已经提出了C10K问题，所谓**C10K就是单机1w并发问题**，虽然现在不觉得是个难题了，但是这在当初是很有远见和挑战的问题。

**五元组**

这样的话，就可以基本认为：**理论最大并发数 = 服务端唯一五元组数**。

Linux的端口号是2字节大小的short类型，总计2^16个端口，除去一些系统占用的端口，可用端口确实只剩下64000多了

<img src="/img/image-20220605163047586.png" alt="image-20220605163047586" style="zoom: 50%;" />![image-20220605163202340](/img/image-20220605163202340.png)

<img src="/img/image-20220605163232040.png" alt="image-20220605163232040" style="zoom: 67%;" />

